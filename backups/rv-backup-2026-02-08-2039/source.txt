==== src/App.tsx ====
import useThemeMode from "./hooks/useThemeMode";
import SubNavbar from "./components/SubNavbar";


import { Routes, Route, useLocation } from "react-router-dom";
import Navbar from "./components/Navbar";
import ScrollToTop from "./components/ScrollToTop";
import Footer from "./components/Footer";

import Home from "./pages/Home";
import Services from "./pages/Services";
import Schedule from "./pages/Schedule";
import StayLit from "./pages/StayLit";
import Contact from "./pages/Contact";
import Requests from "./pages/Requests";
import ServiceDetail from "./pages/ServiceDetail";

import Policies from "./pages/Policies";
import ServiceArea from "./pages/ServiceArea";
import FAQ from "./pages/FAQ";
import Reviews from "./pages/Reviews";
import Portfolio from "./pages/Portfolio";
import About from "./pages/About";

import CustomerPortal from "./pages/CustomerPortal";
import CustomerRequestDetail from "./pages/CustomerRequestDetail";


import Builds from "./pages/Builds";
import BuildDesigner from "./pages/BuildDesigner";
import BuildPreview from "./pages/BuildPreview";
import BuildPortal from "./pages/BuildPortal";

import AdminBuilds from "./pages/admin/AdminBuilds";
import AdminBuildDetail from "./pages/admin/AdminBuildDetail";
import AdminLogin from "./pages/admin/AdminLogin";
import AdminDashboard from "./pages/admin/AdminDashboard";
import AdminGuard from "./components/admin/AdminGuard";

import RequestConfirmed from "./pages/RequestConfirmed";

import bg from "./assets/handyman-bg.png";
import staylitBg from "./assets/staylit-bg.png";
import ToastHost from "./components/ToastHost";

export default function App() {
  const location = useLocation();
  const isStayLit = location.pathname.startsWith("/staylit");
  useThemeMode(isStayLit);


  return (
    <div
      style={{
        minHeight: "100vh",

        // Dark neon-friendly overlay so text stays readable over ANY background image
        backgroundImage: `
          linear-gradient(
            rgba(2,6,23,0.86),
            rgba(2,6,23,0.82)
          ),
          radial-gradient(
            circle at 20% 10%,
            rgba(59,130,246,0.18),
            rgba(0,0,0,0) 55%
          ),
          radial-gradient(
            circle at 80% 15%,
            rgba(168,85,247,0.14),
            rgba(0,0,0,0) 60%
          ),
          url(${isStayLit ? staylitBg : bg})
        `,
        backgroundSize: "cover",
        backgroundPosition: "center",
        backgroundRepeat: "no-repeat",
        backgroundAttachment: "fixed",

        // Global readable text tone (prevents ‚Äúwashed out‚Äù text on image backgrounds)
        color: "#e5e7eb",
      }}
    >
      <Navbar />
      <SubNavbar />

      <ScrollToTop />

      <main
        key={location.pathname}
        className="page-enter"
        style={{
          padding: "24px 16px",
          maxWidth: 1200,
          margin: "0 auto",
          minHeight: "calc(100vh - 80px)",
        }}
      >
        <Routes>
          <Route path="/" element={<Home />} />
          <Route path="/services" element={<Services />} />
          <Route path="/services/:id" element={<ServiceDetail />} />
          <Route path="/schedule" element={<Schedule />} />
          <Route path="/staylit/*" element={<StayLit />} />
          <Route path="/contact" element={<Contact />} />

          <Route path="/about" element={<About />} />
          <Route path="/portfolio" element={<Portfolio />} />
          <Route path="/reviews" element={<Reviews />} />
          <Route path="/faq" element={<FAQ />} />
          <Route path="/service-area" element={<ServiceArea />} />
          <Route path="/policies" element={<Policies />} />
          <Route path="/requests" element={<Requests />} />

          <Route path="/customer" element={<CustomerPortal />} />
          <Route path="/customer/requests/:id" element={<CustomerRequestDetail />} />

          
          {/* Custom Builds (customer) */}
          <Route path="/builds" element={<Builds />} />
          <Route path="/builds/new" element={<BuildDesigner />} />
          <Route path="/builds/portal" element={<BuildPortal />} />
          <Route path="/builds/:id" element={<BuildPreview />} />
<Route path="/admin/login" element={<AdminLogin />} />
          <Route
            path="/admin"
            element={
              <AdminGuard>
                <AdminDashboard />
              </AdminGuard>
            }
          />

          
          <Route
            path="/admin/builds"
            element={
              <AdminGuard>
                <AdminBuilds />
              </AdminGuard>
            }
          />
          <Route
            path="/admin/builds/:id"
            element={
              <AdminGuard>
                <AdminBuildDetail />
              </AdminGuard>
            }
          />
{/* IMPORTANT: keep this ABOVE the catch-all 404 route */}
          <Route path="/request-confirmed/:id" element={<RequestConfirmed />} />

          <Route
            path="*"
            element={
              <div style={{ padding: 24, maxWidth: 900, margin: "0 auto" }}>
                <h1 style={{ fontWeight: 950, margin: 0 }}>Page not found (404)</h1>
                <p style={{ marginTop: 10, fontWeight: 800, opacity: 0.9 }}>
                  If you expected Admin to load, this can mean the route is missing or the app is not wrapped in
                  BrowserRouter.
                </p>
                <p style={{ marginTop: 10, fontWeight: 900 }}>
                  Try: <code>/admin/login</code> then <code>/admin</code>
                </p>
              </div>
            }
          />
        </Routes>
      </main>

      <Footer />
      <ToastHost />
    </div>
  );
}
==== src/main.tsx ====
import React from "react";
import "./styles/urban.css";

import ReactDOM from "react-dom/client";
import { BrowserRouter } from "react-router-dom";
import App from "./App";
import "./index.css";
import "./styles/staylit-flame.css";
import "./styles/theme-override.css";
import { CartProvider } from "./data/requestCart";
import { emitToast } from "./components/ToastHost";

ReactDOM.createRoot(document.getElementById("root")!).render(
  <React.StrictMode>
    <BrowserRouter>
      <CartProvider>
        <App />
      </CartProvider>
    </BrowserRouter>
  </React.StrictMode>
);


// RV_ALERT_TOAST_OVERRIDE: route all alert() calls through toast UI (non-blocking)
window.alert = (msg?: any) => {
  const message = String(msg ?? "").trim();
  if (!message) return;
  emitToast({ message, variant: "info", durationMs: 3200 });
};
==== src/App.css ====
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}

/* --- Splash fade-in animation (Home) --- */
.page-enter {
  animation: pageEnter 520ms ease-out both;
}

@keyframes pageEnter {
  from {
    opacity: 0;
    transform: translateY(10px);
    filter: blur(2px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
    filter: blur(0);
  }
}

/* Respect accessibility preferences */
@media (prefers-reduced-motion: reduce) {
  .page-enter {
    animation: none;
  }
}


/* RV: Schedule item styles */
.schedList {
  display: grid;
  gap: 12px;
  margin-top: 12px;
}

.schedItem {
  width: 100%;
  border-radius: 16px;
  padding: 14px;
  border: 1px solid rgba(15, 23, 42, 0.10);
  background: rgba(255,255,255,0.72);
  box-shadow: 0 14px 34px rgba(2, 6, 23, 0.10);
  backdrop-filter: blur(8px);
}

.schedItem:hover {
  border-color: rgba(99, 102, 241, 0.25);
  box-shadow: 0 18px 42px rgba(2, 6, 23, 0.14);
}

.schedItemTop {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
  flex-wrap: wrap;
}

.schedItemTitle {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  font-weight: 950;
  color: #0f172a;
}

.schedItemMeta {
  margin-top: 6px;
  font-weight: 850;
  opacity: 0.85;
}

.schedPills {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin-top: 8px;
}

.schedPill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 6px 10px;
  border-radius: 999px;
  font-weight: 950;
  font-size: 12px;
  border: 1px solid rgba(15, 23, 42, 0.10);
  background: rgba(255,255,255,0.75);
}

.schedPillService {
  background: rgba(79, 70, 229, 0.10);
  border-color: rgba(79, 70, 229, 0.22);
  color: #312e81;
}

.schedPillAddOn {
  background: rgba(16, 185, 129, 0.10);
  border-color: rgba(16, 185, 129, 0.22);
  color: #064e3b;
}

.schedEstimate {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 8px 12px;
  border-radius: 12px;
  font-weight: 950;
  border: 1px solid rgba(15, 23, 42, 0.10);
  background: rgba(255,255,255,0.80);
}

.schedQuote {
  background: rgba(245, 158, 11, 0.14);
  border-color: rgba(245, 158, 11, 0.22);
  color: #7c2d12;
}

.schedFrom {
  background: rgba(14, 165, 233, 0.12);
  border-color: rgba(14, 165, 233, 0.22);
  color: #0c4a6e;
}

.schedFixed {
  background: rgba(34, 197, 94, 0.12);
  border-color: rgba(34, 197, 94, 0.20);
  color: #14532d;
}
==== src/index.css ====
/* ================= RESET ================= */

*,
*::before,
*::after { box-sizing: border-box; }

html, body, #root {
  margin: 0;
  padding: 0;
  min-height: 100%;
  height: 100%;
}

/* ================= THEME TOKENS ================= */
/* Default theme = light (your app can toggle by setting html[data-theme="dark"]) */

:root {
  /* Text */
  --text-main:   #050b18;
  --text-strong: #020617;
  --text-soft:   #0f172a;
  --text-muted:  #475569;

  /* Borders + accents */
  --border:  rgba(15, 23, 42, 0.14);
  --accent:  #1d4ed8;
  --accent2: #60a5fa;

  /* Surfaces */
  --panel-bg:   rgba(255,255,255,0.97);
  --field-bg:   rgba(255,255,255,0.98);
  --badge-bg:   rgba(255,255,255,0.96);
  --btn-bg:     rgba(255,255,255,0.98);

  /* Radii + shadows */
  --radius-lg: 16px;
  --radius-md: 12px;
  --shadow-soft:  0 10px 26px rgba(0,0,0,0.10);
  --shadow-hover: 0 16px 42px rgba(29,78,216,0.22);
}

/* Dark theme overrides */
html[data-theme="dark"] {
  --text-main:   #f8fafc;
  --text-strong: #ffffff;
  --text-soft:   rgba(241,245,249,0.92);
  --text-muted:  rgba(226,232,240,0.82);

  --border:  rgba(148,163,184,0.22);
  --accent:  #60a5fa;
  --accent2: #22d3ee;

  --panel-bg: rgba(2,6,23,0.86);
  --field-bg: rgba(2,6,23,0.72);
  --badge-bg: rgba(2,6,23,0.72);
  --btn-bg:   rgba(2,6,23,0.72);

  --shadow-soft:  0 12px 32px rgba(0,0,0,0.45);
  --shadow-hover: 0 18px 52px rgba(34,211,238,0.20);
}

/* ================= BASE ================= */

body {
  font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont,
    "Segoe UI", Roboto, Inter, Arial;
  -webkit-font-smoothing: antialiased;

  color: var(--text-main);
  background-color: #f8fbff;
}

html[data-theme="dark"] body {
  background-color: #020617;
}

/* ================= TEXT ================= */

.h1 {
  font-size: clamp(28px, 3vw, 44px);
  font-weight: 900;
  letter-spacing: -0.03em;
  color: var(--text-strong);
}

.h2 {
  font-size: clamp(20px, 2vw, 28px);
  font-weight: 850;
  color: var(--text-strong);
}

.h3 {
  font-size: 16px;
  font-weight: 900;
  color: var(--text-strong);
}

.h1-accent {
  background: linear-gradient(90deg, var(--accent), var(--accent2));
  -webkit-background-clip: text;
  color: transparent;
}

.lead {
  font-size: 16px;
  line-height: 1.6;
  color: var(--text-soft);
  font-weight: 600;
}

.body {
  font-size: 14.5px;
  line-height: 1.6;
  color: var(--text-soft);
  font-weight: 600;
}

.muted {
  color: var(--text-muted);
  font-weight: 700;
}

/* ================= LAYOUT ================= */

.stack {
  display: grid;
  gap: 14px;
}

.row {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.center {
  text-align: center;
  align-items: center;
  justify-content: center;
}

/* ================= CARDS / PANELS ================= */

.panel {
  color: var(--text-main);
  background: var(--panel-bg);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-soft);
  backdrop-filter: blur(16px);
  transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease;
}

.card { padding: 18px; }

.card-center {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: 8px;
}

/* Glow variant stays (optional class you can add anywhere) */
.panel.glow-panel{
  box-shadow:
    var(--shadow-soft),
    0 0 28px rgba(34,211,238,0.45),
    0 0 72px rgba(59,130,246,0.28),
    0 0 120px rgba(167,139,250,0.18);
  border-color: rgba(34,211,238,0.34);
}
.panel.glow-panel:hover{
  box-shadow:
    var(--shadow-soft),
    0 0 34px rgba(34,211,238,0.55),
    0 0 92px rgba(59,130,246,0.34),
    0 0 150px rgba(167,139,250,0.22);
  transform: translateY(-1px);
}

/* Hover lift for desktop */
@media (hover: hover) and (pointer: fine) {
  .panel:hover {
    transform: translateY(-2px);
    border-color: rgba(96,165,250,0.45);
    box-shadow:
      0 18px 40px rgba(29,78,216,0.18),
      0 0 0 1px rgba(96,165,250,0.18);
  }
}

/* Tap feedback for touch devices */
@media (hover: none) and (pointer: coarse) {
  .panel:active { transform: scale(0.99); }
}

/* ================= BUTTONS ================= */

.btn {
  padding: 10px 14px;
  border-radius: var(--radius-md);
  border: 1px solid var(--border);
  background: var(--btn-bg);
  color: var(--text-main);
  font-weight: 900;
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.18s ease, border-color 0.18s ease, filter 0.18s ease;
}

.btn:hover {
  transform: translateY(-1px);
  border-color: rgba(96,165,250,0.6);
  box-shadow: var(--shadow-hover);
}

.btn:active {
  transform: translateY(1px) scale(0.99);
  filter: brightness(0.98);
}

.btn-primary {
  position: relative;
  overflow: hidden;
  background: linear-gradient(90deg, rgba(29,78,216,.95), rgba(96,165,250,.95));
  color: #fff;
  border-color: rgba(29,78,216,.6);
}

/* Subtle animated shine on primary buttons (desktop hover only) */
.btn-primary::after {
  content: "";
  position: absolute;
  top: -40%;
  left: -60%;
  width: 50%;
  height: 180%;
  transform: rotate(18deg);
  background: linear-gradient(
    to right,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.22) 50%,
    rgba(255,255,255,0) 100%
  );
  transition: left 0.75s ease;
}

@media (hover: hover) and (pointer: fine) {
  .btn-primary:hover::after { left: 120%; }
}

.btn-ghost {
  background: color-mix(in srgb, var(--btn-bg) 82%, transparent);
}

/* ================= INPUTS ================= */

.field {
  width: 100%;
  padding: 10px 12px;
  border-radius: var(--radius-md);
  border: 1px solid var(--border);
  background: var(--field-bg);
  color: var(--text-main);
  font-weight: 600;
}

.field:focus {
  outline: none;
  border-color: rgba(96,165,250,.7);
  box-shadow: 0 0 0 4px rgba(96,165,250,.22);
}

/* ================= BADGE ================= */

.badge {
  padding: 5px 12px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--badge-bg);
  font-size: 12px;
  font-weight: 900;
  color: var(--text-soft);
}

/* ================= PAGE MOTION ================= */

.page {
  animation: pageFade 0.35s ease-out both;
}

@keyframes pageFade {
  from { opacity: 0; transform: translateY(6px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; }
}
==== src/styles/staylit-flame.css ====
@keyframes slFlameFlickerNav {
  0%   { transform: translateY(0px)   rotate(-10deg) scale(1.00) translateZ(0); filter: drop-shadow(0 0 8px rgba(251,191,36,0.8)); opacity: .92; }
  12%  { transform: translateY(-3px)  rotate( 12deg) scale(1.15) translateZ(0); filter: drop-shadow(0 0 14px rgba(245,158,11,0.95)); opacity: 1; }
  28%  { transform: translateY(-5px)  rotate( -8deg) scale(1.22) translateZ(0); filter: drop-shadow(0 0 18px rgba(251,146,60,0.95)); opacity: .98; }
  45%  { transform: translateY(-2px)  rotate( 10deg) scale(1.12) translateZ(0); filter: drop-shadow(0 0 12px rgba(253,186,116,0.9)); opacity: 1; }
  63%  { transform: translateY(-6px)  rotate(-12deg) scale(1.24) translateZ(0); filter: drop-shadow(0 0 20px rgba(251,113,133,0.45)); opacity: .92; }
  78%  { transform: translateY(-4px)  rotate(  8deg) scale(1.18) translateZ(0); filter: drop-shadow(0 0 16px rgba(251,191,36,0.95)); opacity: 1; }
  92%  { transform: translateY(-1px)  rotate( -6deg) scale(1.08) translateZ(0); filter: drop-shadow(0 0 10px rgba(253,186,116,0.85)); opacity: .96; }
  100% { transform: translateY(0px)   rotate(-10deg) scale(1.00) translateZ(0); filter: drop-shadow(0 0 8px rgba(251,191,36,0.8)); opacity: .92; }
}

.slFlameNav {
  display: inline-block;
  transform-origin: 50% 85%;
  animation: slFlameFlickerNav 0.9s infinite;
  will-change: transform, filter, opacity;
  margin-right: 8px;
  color: #fbbf24;
  -webkit-text-fill-color: #fbbf24; /* prevents gradient/transparent inheritance */
}
==== src/styles/theme-override.css ====
/* =========================================================
   THEME OVERRIDE (loaded LAST)
   Purpose: ensure src/index.css theme tokens control the app,
   even when urban.css is present.
   ========================================================= */

/* 1) Let index.css control base colors instead of urban.css */
html, body {
  background: #f8fbff !important;
  color: var(--text-main) !important;
}

/* Dark mode base (when html[data-theme="dark"] is set) */
html[data-theme="dark"] body,
html[data-theme="dark"] {
  background: #020617 !important;
  color: var(--text-main) !important;
}

/* 2) Restore common text classes to theme tokens */
.muted { color: var(--text-muted) !important; }
.body, .lead, p, li, span { color: var(--text-soft) !important; }

/* 3) Restore panels/cards to theme tokens (beats urban.css .panel.card background) */
.panel,
.panel.card {
  background: var(--panel-bg) !important;
  border: 1px solid var(--border) !important;
  color: var(--text-main) !important;
}

/* 4) Keep headings consistent with theme tokens */
.h1, .h2, .h3, h1, h2, h3, h4 {
  color: var(--text-strong) !important;
}

/* 5) Buttons/fields/badges use theme tokens (avoid urban glow forcing colors) */
.btn {
  background: var(--btn-bg) !important;
  color: var(--text-main) !important;
  border-color: var(--border) !important;
}

.field, input, textarea, select {
  background: var(--field-bg) !important;
  color: var(--text-main) !important;
  border-color: var(--border) !important;
}

.badge {
  background: var(--badge-bg) !important;
  color: var(--text-soft) !important;
  border-color: var(--border) !important;
}

/* =========================================================
   CLICK FIX: prevent overlays/pseudo-elements from stealing clicks
   (Common issue with glass cards + .panel::before glow layers)
   ========================================================= */

/* Ensure panels establish a stacking context */
.panel, .panel.card { position: relative !important; }

/* Decorative overlays must NOT capture pointer events */
.panel::before,
.panel::after,
.card::before,
.card::after,
.page::before,
.page::after {
  pointer-events: none !important;
}

/* Force interactive elements above overlays */
.panel a,
.panel button,
.panel .btn,
.panel [role="button"],
.panel input,
.panel select,
.panel textarea {
  position: relative !important;
  z-index: 2 !important;
  pointer-events: auto !important;
}
==== src/styles/urban.css ====
/* =========================================================
   ROBERTS VENTURES ‚Äî DARK NEON URBAN THEME (GLOBAL)
   ========================================================= */

:root{
  --rv-bg-main: #05070f;
  --rv-bg-card: rgba(8,12,24,.82);
  --rv-bg-glass: rgba(15,23,42,.72);

  --rv-text-main: #f8fafc;
  --rv-text-soft: rgba(248,250,252,.78);
  --rv-text-muted: rgba(248,250,252,.55);

  --rv-neon-blue: #38bdf8;
  --rv-neon-violet: #a78bfa;
  --rv-neon-pink: #f472b6;
  --rv-neon-green: #22c55e;

  --rv-radius: 18px;

  --rv-glow-soft: 0 0 18px rgba(56,189,248,.25);
  --rv-glow-med: 0 0 30px rgba(167,139,250,.35);
  --rv-glow-hard: 0 0 45px rgba(56,189,248,.45);
}

/* =========================
   BASE
   ========================= */

html, body{
  background: var(--rv-bg-main);
  color: var(--rv-text-main);
  letter-spacing: .01em;
  text-rendering: geometricPrecision;
  -webkit-font-smoothing: antialiased;
}

body{
  font-weight: 650;
}

/* =========================
   TEXT
   ========================= */

p, li, span{
  color: var(--rv-text-soft);
  line-height: 1.7;
}

.muted{
  color: var(--rv-text-muted) !important;
  font-weight: 700;
}

/* =========================
   HEADINGS
   ========================= */

h1, h2, h3, h4,
.h1, .h2, .h3{
  color: var(--rv-text-main);
  letter-spacing: .06em;
  text-transform: uppercase;
  line-height: 1.1;
}

h1, .h1{
  font-weight: 980;
  text-shadow: var(--rv-glow-med);
}

h2, .h2{
  font-weight: 950;
  text-shadow: var(--rv-glow-soft);
}

h3, .h3{
  font-weight: 900;
}

/* =========================
   NEON TITLES
   ========================= */

.rv-urban-title{
  font-weight: 980;
  letter-spacing: .12em;
  background: linear-gradient(
    90deg,
    var(--rv-neon-blue),
    var(--rv-neon-violet),
    var(--rv-neon-pink)
  );
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  filter: drop-shadow(var(--rv-glow-hard));
}

/* =========================
   CARDS / PANELS
   ========================= */

.panel.card{
  background: var(--rv-bg-card) !important;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(148,163,184,.12);
  border-radius: var(--rv-radius);
  box-shadow:
    0 12px 35px rgba(0,0,0,.6),
    var(--rv-glow-soft);
}

/* =========================
   BADGES
   ========================= */

.badge{
  font-weight: 900;
  letter-spacing: .12em;
  text-transform: uppercase;
  background: linear-gradient(
    90deg,
    rgba(56,189,248,.18),
    rgba(167,139,250,.18)
  );
  border: 1px solid rgba(56,189,248,.35);
  box-shadow: var(--rv-glow-soft);
  color: var(--rv-text-main);
}

/* =========================
   BUTTONS
   ========================= */

.btn{
  font-weight: 900;
  letter-spacing: .04em;
  border-radius: 999px;
}

.btn-primary{
  background: linear-gradient(
    90deg,
    #2563eb,
    #7c3aed
  );
  border: none;
  color: white;
  box-shadow: var(--rv-glow-med);
}

.btn-primary:hover{
  transform: translateY(-1px) scale(1.03);
  box-shadow: var(--rv-glow-hard);
}

.btn-ghost{
  color: var(--rv-neon-blue);
  border: 1px solid rgba(56,189,248,.35);
}

/* =========================
   NAV LINKS
   ========================= */

.nav-link{
  color: var(--rv-text-soft) !important;
  font-weight: 850 !important;
  letter-spacing: .04em;
}

.nav-link:hover{
  color: var(--rv-neon-blue) !important;
  box-shadow: var(--rv-glow-soft);
}

.nav-link.active{
  background: linear-gradient(
    90deg,
    rgba(56,189,248,.25),
    rgba(167,139,250,.25)
  ) !important;

  color: white !important;
  box-shadow: var(--rv-glow-med);
}

/* =========================
   INPUTS / FORMS
   ========================= */

input, select, textarea{
  background: rgba(15,23,42,.9);
  color: var(--rv-text-main);
  border: 1px solid rgba(148,163,184,.25);
}

input:focus, select:focus, textarea:focus{
  outline: none;
  border-color: var(--rv-neon-blue);
  box-shadow: var(--rv-glow-soft);
}

/* =========================
   FOOTER
   ========================= */

footer{
  background: rgba(2,6,23,.9);
  color: var(--rv-text-muted);
}

/* =========================
   ICONS / EMOJIS GLOW
   ========================= */

h1 span, h2 span, .h1 span, .h2 span,
.slFlameNav{
  filter: drop-shadow(0 0 12px rgba(56,189,248,.5));
}
==== src/components/Navbar.tsx ====
import { NavLink, useNavigate } from "react-router-dom";
import { useCart } from "../data/requestCart";
import React from "react";
import rvLogo from "../assets/roberts-ventures-logo.png";
import { getActiveTheme, toggleTheme } from "../lib/theme";

const baseLinkStyle: React.CSSProperties = {
  textDecoration: "none",
  padding: "8px 12px",
  borderRadius: 999,
  fontWeight: 850,
  fontSize: 14,
  transition: "all .2s ease",
  display: "inline-flex",
  alignItems: "center",
  gap: 6,
};

export default function Navbar() {
  const cart = useCart();
  const count = (cart as any)?.count ?? 0;

  const [theme, setTheme] = React.useState(getActiveTheme());
  const navigate = useNavigate();

  return (
    <header
      style={{
        position: "sticky",
        top: 0,
        zIndex: 50,
        backdropFilter: "blur(18px)",
        background: "linear-gradient(90deg, rgba(10,10,15,.78), rgba(6,10,22,.82))",
        borderBottom: "1px solid rgba(148,163,184,.15)",
      }}
    >
      <div
        style={{
          maxWidth: 1200,
          margin: "0 auto",
          padding: "14px 18px",
          display: "flex",
          alignItems: "center",
          justifyContent: "space-between",
          gap: 16,
          flexWrap: "wrap",
        }}
      >
        {/* Brand */}
        <div style={{ lineHeight: 1.15, display: "flex", alignItems: "center", gap: 10 }}>
          <img
            src={rvLogo}
            alt="Roberts Ventures LLC"
            style={{
              width: 30,
              height: 30,
              objectFit: "contain",
              filter: "drop-shadow(0 0 14px rgba(56,189,248,.22))",
            }}
          />

          <div style={{ display: "grid" }}>
            <div
              style={{
                fontSize: 18,
                fontWeight: 950,
                letterSpacing: ".06em",
                textTransform: "uppercase",
                background: "linear-gradient(90deg,#38bdf8,#a78bfa,#f472b6)",
                WebkitBackgroundClip: "text",
                WebkitTextFillColor: "transparent",
                filter: "drop-shadow(0 0 16px rgba(56,189,248,.25))",
              }}
            >
              Roberts Ventures LLC
            </div>

            <div style={{ fontSize: 11, color: "rgba(248,250,252,.62)", fontWeight: 800 }}>
              Services ‚Ä¢ Stay Lit Candle Co.
            </div>
          </div>
        </div>

        {/* Nav */}
        <nav
          style={{
            display: "flex",
            gap: 6,
            flexWrap: "wrap",
            justifyContent: "center",
          }}
        >
          <NavLink to="/" end style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Home
          </NavLink>

          <NavLink to="/services" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Services
          </NavLink>

          <NavLink to="/schedule" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Schedule
          </NavLink>

          <NavLink to="/staylit" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            <span className="slFlameNav">üî•</span>
            <span>Stay Lit</span>
          </NavLink>

          <NavLink to="/contact" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Contact
          </NavLink>

                    <NavLink to="/builds" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Custom Builds
          </NavLink>

<NavLink to="/customer" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Customer Portal
          </NavLink>

          <NavLink to="/admin" style={baseLinkStyle} className={({ isActive }) => `nav-link${isActive ? " active" : ""}`}>
            Admin
          </NavLink>
        </nav>

        {/* Right controls (keeps toggle + cart together and always visible) */}
        <div
          style={{
            display: "inline-flex",
            alignItems: "center",
            gap: 10,
            flexShrink: 0,
          }}
        >
          {/* Theme toggle */}
          <button
            type="button"
            className="btn btn-ghost"
            onClick={() => setTheme(toggleTheme())}
            aria-label="Toggle dark/light theme"
            title="Toggle theme"
            style={{
              padding: "8px 12px",
              borderRadius: 999,
              fontSize: 12,
              fontWeight: 900,
              letterSpacing: ".08em",
              textTransform: "uppercase",
              display: "inline-flex",
              alignItems: "center",
              gap: 8,
              background: "rgba(255,255,255,0.06)",
              border: "1px solid rgba(148,163,184,0.18)",
              color: "rgba(248,250,252,.92)",
              boxShadow: "0 0 18px rgba(56,189,248,.10)",
              cursor: "pointer",
              whiteSpace: "nowrap",
            }}
          >
            {theme === "dark" ? "üåô Dark" : "‚òÄÔ∏è Light"}
          </button>

          {/* Cart (clickable + cannot ‚Äúblend in‚Äù) */}
          <button
            type="button"
            onClick={() => navigate("/requests")}
            aria-label="Open requests cart"
            title="Open Requests"
            style={{
              padding: "8px 12px",
              borderRadius: 999,
              fontSize: 12,
              fontWeight: 900,
              letterSpacing: ".08em",
              textTransform: "uppercase",
              background: "linear-gradient(90deg, rgba(56,189,248,.14), rgba(167,139,250,.14))",
              color: "rgba(248,250,252,.92)",
              border: "1px solid rgba(56,189,248,.32)",
              boxShadow: "0 0 18px rgba(56,189,248,.15)",
              cursor: "pointer",
              whiteSpace: "nowrap",
              display: "inline-flex",
              alignItems: "center",
              gap: 8,
            }}
          >
            üõí Cart
            <span className="cart-count-badge" aria-label={`Cart items: ${count}`}>
              {count}
            </span>
          </button>
        </div>
      </div>
    </header>
  );
}
==== src/components/ScrollToTop.tsx ====
import { useEffect } from "react";
import { useLocation } from "react-router-dom";

export default function ScrollToTop() {
  const { pathname } = useLocation();

  useEffect(() => {
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: "smooth",
    });
  }, [pathname]);

  return null;
}
==== src/components/admin/AdminGuard.tsx ====
import { Navigate } from "react-router-dom";

const KEY = "rv_admin_authed";

export function isAdminAuthed() {
  return localStorage.getItem(KEY) === "true";
}

export function setAdminAuthed(v: boolean) {
  localStorage.setItem(KEY, v ? "true" : "false");
}

export default function AdminGuard({ children }: { children: React.ReactNode }) {
  if (!isAdminAuthed()) return <Navigate to="/admin/login" replace />;
  return <>{children}</>;
}
==== src/components/EstimatePreview.tsx ====
import { useMemo } from "react";
import { useCart } from "../data/requestCart";
import { SERVICES } from "../data/services";
import { ADD_ONS } from "../data/addOns";

type PriceType = "fixed" | "starting_at" | "quote";

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

function getCartItems(cart: any): Array<any> {
  // Try common shapes without assuming your internal structure
  if (Array.isArray(cart?.items)) return cart.items;
  if (Array.isArray(cart?.lines)) return cart.lines;
  if (Array.isArray(cart?.cart)) return cart.cart;
  if (Array.isArray(cart?.state?.items)) return cart.state.items;
  if (typeof cart?.getItems === "function") {
    const v = cart.getItems();
    if (Array.isArray(v)) return v;
  }
  // If cart stores by id map: { [id]: {qty,note,addOns} }
  if (cart && typeof cart === "object" && cart.byId && typeof cart.byId === "object") {
    return Object.entries(cart.byId).map(([id, v]: any) => ({ serviceId: id, ...(v || {}) }));
  }
  return [];
}

function getQty(it: any): number {
  const q = it?.qty ?? it?.quantity ?? 1;
  const n = Number(q);
  return Number.isFinite(n) && n > 0 ? n : 1;
}

function getServiceId(it: any): string {
  return String(it?.serviceId ?? it?.id ?? it?.service?.id ?? "");
}

function getAddOnIds(cart: any, it: any): string[] {
  // Normalize any add-on representation to a string id
  const norm = (x: any) => String(x ?? "").trim();

  // Common item-level shapes
  if (Array.isArray(it?.addOns)) {
    return it.addOns.map((x: any) => norm(x?.id ?? x?.addOnId ?? x?.serviceId ?? x)).filter(Boolean);
  }
  if (Array.isArray(it?.addOnIds)) {
    return it.addOnIds.map((x: any) => norm(x)).filter(Boolean);
  }

  const sid = norm(it?.serviceId ?? it?.id ?? it?.service?.id);

  // Common cart-level shapes
  if (sid && Array.isArray(cart?.addOnsByService?.[sid])) {
    return cart.addOnsByService[sid].map((x: any) => norm(x?.id ?? x?.addOnId ?? x?.serviceId ?? x)).filter(Boolean);
  }
  if (sid && typeof cart?.getAddOns === "function") {
    const v = cart.getAddOns(sid);
    if (Array.isArray(v)) return v.map((x: any) => norm(x?.id ?? x?.addOnId ?? x?.serviceId ?? x)).filter(Boolean);
  }

  // Fallback: some stores keep an addOns map keyed by serviceId
  if (sid && typeof cart?.addOns === "object" && cart?.addOns) {
    const v = cart.addOns[sid];
    if (Array.isArray(v)) return v.map((x: any) => norm(x?.id ?? x?.addOnId ?? x?.serviceId ?? x)).filter(Boolean);
  }

  return [];
}

function resolveAddOn(addById: Map<string, any>, rawId: string) {
  const ridRaw = String(rawId || "");
  if (!ridRaw) return undefined;

  const rid = normalizeId(ridRaw);

  // Exact + normalized matches
  return (
    addById.get(ridRaw) ||
    addById.get(rid) ||
    addById.get(ridRaw.trim()) ||
    addById.get(ridRaw.toLowerCase().trim()) ||
    undefined
  );
}

function normalizeId(x: any) {
  return String(x ?? "")
    .trim()
    .toLowerCase()
    .replace(/^id:\s*/i, "")
    .replace(/^addon\s*:\s*/i, "")
    .replace(/\s+/g, "");
}

function buildAddOnIndex(addOns: any[]) {
  const idx = new Map<string, any>();

  for (const a of addOns) {
    const raw = String(a?.id ?? "");
    const norm = normalizeId(raw);
    if (!raw) continue;

    // store the original id and normalized id
    idx.set(raw, a);
    idx.set(norm, a);

    // store common variants so cart can use different formats
    const variants = [
      raw.replace(/^addon[-_]/i, ""),
      raw.replace(/^add[-_]?on[-_]/i, ""),
      raw.replace(/^rv[-_]/i, ""),
      norm.replace(/^addon[-_]/i, ""),
      norm.replace(/^add[-_]?on[-_]/i, ""),
      norm.replace(/^rv[-_]/i, ""),
    ].filter(v => v && v != raw && v != norm);

    for (const v of variants) {
      idx.set(v, a);
      idx.set(normalizeId(v), a);
    }
  }

  return idx;
}

export default function EstimatePreview() {
  const cart = useCart();

  const items = useMemo(() => getCartItems(cart), [cart]);

  const calc = useMemo(() => {
    let minTotal = 0;
    const quotes: string[] = [];
    const lines: Array<{ label: string; note: string; amount?: number }> = [];

    const svcById = new Map([...SERVICES, ...ADD_ONS].map((s: any) => [String(s.id), s]));
    const addById = buildAddOnIndex(ADD_ONS as any[]);

    for (const it of items) {
      const sid = getServiceId(it);
      if (!sid) continue;

      const svc: any = svcById.get(sid);
      const qty = getQty(it);

      if (svc) {
        const isAddOn = Boolean((svc as any).isAddOn);
        const labelName = isAddOn ? `Add-on: ${svc.name}` : svc.name;

        const pt: PriceType = svc.priceType;
        if (pt === "quote") {
          quotes.push(`${labelName}`);
          lines.push({ label: labelName, note: "Quote required" });
        } else {
          const price = Number(svc.price ?? 0);
          const amt = (Number.isFinite(price) ? price : 0) * qty;
          minTotal += amt;
          lines.push({
            label: labelName,
            note: pt === "starting_at" ? `Starting at ${money(price)} √ó ${qty}` : `${money(price)} √ó ${qty}`,
            amount: amt,
          });
        }
      } else {
        // Unknown service id (still show it)
        lines.push({ label: sid, note: "Service", amount: undefined });
      }

      // Add-ons for this service (if present)
      const addOnIds = getAddOnIds(cart, it);
      for (const aid of addOnIds) {
        const add: any = resolveAddOn(addById, String(aid));
        if (!add) {
          lines.push({ label: `Add-on: ${aid}`, note: "Add-on", amount: undefined });
          continue;
        }
        const pt: PriceType = add.priceType;
        if (pt === "quote") {
          quotes.push(`${add.name} (add-on)`);
          lines.push({ label: `Add-on: ${add.name}`, note: "Quote required" });
        } else {
          const price = Number(add.price ?? 0);
          const amt = (Number.isFinite(price) ? price : 0);
          minTotal += amt;
          lines.push({
            label: `Add-on: ${add.name}`,
            note: pt === "starting_at" ? `Starting at ${money(price)}` : `${money(price)}`,
            amount: amt,
          });
        }
      }
    }

    return { minTotal, quotes, lines };
  }, [items, cart]);

  if (!items || items.length === 0) return null;

  return (
    <section className="panel card" style={{ width: "100%", margin: 0, padding: 16, borderRadius: 18 }}>
      <div style={{ display: "flex", flexDirection: "column", alignItems: "center", textAlign: "center", gap: 12 }}>
        <div style={{ display: "grid", gap: 6, justifyItems: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Estimate Preview</div>
          <div className="rate-bright" style={{ fontWeight: 950, fontSize: 18 }}>
            Estimated minimum: {money(calc.minTotal)}
          </div>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 820 }}>
            This is an estimate based on fixed/starting prices. Final cost may change after inspection,
            measurements, materials, access, or any quote-required items.
          </div>
        </div>

        {calc.quotes.length > 0 ? (
          <div
            className="panel"
            style={{
              padding: 12,
              borderRadius: 14,
              margin: "0 auto",
              maxWidth: 420,
              textAlign: "center",
              width: "100%",
            }}
          >
            <div className="rate-bright" style={{ fontWeight: 950 }}>Quote required</div>
            <div className="muted" style={{ marginTop: 6, fontWeight: 850 }}>
              {calc.quotes.slice(0, 6).join(", ")}
              {calc.quotes.length > 6 ? "‚Ä¶" : ""}
            </div>
          </div>
        ) : (
          <div
            className="panel"
            style={{
              padding: 12,
              borderRadius: 14,
              margin: "0 auto",
              maxWidth: 420,
              textAlign: "center",
              width: "100%",
              alignSelf: "center",
            }}
          >
            <div className="rate-bright" style={{ fontWeight: 950 }}>No quotes needed</div>
            <div className="muted" style={{ marginTop: 6, fontWeight: 850 }}>
              All selected items have listed pricing.
            </div>
          </div>
        )}
      </div>

      <div style={{ marginTop: 12, display: "grid", gap: 8 }}>
        {calc.lines.map((ln, i) => (
          <div key={i} className="panel" style={{ padding: 10, borderRadius: 14 }}>
            <div style={{ display: "flex", justifyContent: "center", gap: 14, flexWrap: "wrap", textAlign: "center" }}>
              <div style={{ fontWeight: 950 }}>{ln.label}</div>
              <div className="badge rate-bright" style={{ width: "fit-content" }}>
                {ln.amount === undefined ? ln.note : money(ln.amount)}
              </div>
            </div>
            {ln.amount !== undefined ? (
              <div className="muted" style={{ marginTop: 6, fontWeight: 850 }}>{ln.note}</div>
            ) : null}
          </div>
        ))}
      </div>
    </section>
  );
}
==== src/components/ToastHost.tsx ====
import { useEffect, useMemo, useRef, useState } from "react";

type ToastVariant = "info" | "success" | "warning" | "error";

type ToastItem = {
  id: string;
  message: string;
  variant: ToastVariant;
  createdAt: number;
  durationMs: number;
};

function makeId() {
  return (crypto as any).randomUUID?.() ?? (Math.random().toString(16).slice(2) + Date.now().toString(16));
}

export type ToastEventDetail = {
  message: string;
  variant?: ToastVariant;
  durationMs?: number;
};

const EVENT_NAME = "rv_toast";

export function emitToast(detail: ToastEventDetail) {
  window.dispatchEvent(new CustomEvent(EVENT_NAME, { detail }));
}

function iconFor(v: ToastVariant) {
  if (v === "success") return "‚úÖ";
  if (v === "warning") return "‚ö†Ô∏è";
  if (v === "error") return "‚õî";
  return "‚ú®"; // info: no "Info" text, just a vibe
}

// Dark neon accents
function accentFor(v: ToastVariant) {
  if (v === "success") return "rgba(34,197,94,0.95)";   // neon green
  if (v === "warning") return "rgba(250,204,21,0.95)";  // neon yellow
  if (v === "error") return "rgba(248,113,113,0.95)";   // neon red
  return "rgba(59,130,246,0.95)";                       // neon blue
}

export default function ToastHost() {
  const [toasts, setToasts] = useState<ToastItem[]>([]);
  const rafRef = useRef<number | null>(null);

  const styles = useMemo(() => {
    const wrapper: React.CSSProperties = {
      position: "fixed",
      top: 14,
      right: 14,
      zIndex: 9999,
      display: "grid",
      gap: 10,
      pointerEvents: "none",
    };

    const cardBase: React.CSSProperties = {
      width: "min(520px, calc(100vw - 24px))",
      borderRadius: 18,
      padding: "12px 12px",
      pointerEvents: "auto",
      cursor: "default",
      userSelect: "none",
      // Dark glass background
      background:
        "linear-gradient(180deg, rgba(2,6,23,0.90) 0%, rgba(2,6,23,0.78) 100%)",
      border: "1px solid rgba(148,163,184,0.16)",
      boxShadow: "0 22px 55px rgba(0,0,0,0.55)",
      backdropFilter: "blur(12px)",
      WebkitBackdropFilter: "blur(12px)",
      overflow: "hidden",
      transform: "translateY(-8px)",
      opacity: 0,
      animation: "rvToastIn 220ms ease-out forwards",
      position: "relative",
    };

    const headerRow: React.CSSProperties = {
      display: "flex",
      alignItems: "center",
      justifyContent: "center", // center header contents
      gap: 10,
      position: "relative",
      paddingTop: 2,
    };

    const iconBadge: React.CSSProperties = {
      display: "inline-flex",
      alignItems: "center",
      justifyContent: "center",
      width: 36,
      height: 36,
      borderRadius: 999,
      border: "1px solid rgba(148,163,184,0.18)",
      background: "rgba(15,23,42,0.55)",
      boxShadow: "0 0 0 1px rgba(148,163,184,0.10) inset",
      fontSize: 16,
      color: "rgba(226,232,240,0.95)",
    };

    const closeBtn: React.CSSProperties = {
      position: "absolute",
      right: 0,
      top: 0,
      padding: "7px 10px",
      borderRadius: 12,
      fontWeight: 950,
      border: "1px solid rgba(148,163,184,0.18)",
      background: "rgba(15,23,42,0.50)",
      color: "rgba(226,232,240,0.92)",
      cursor: "pointer",
    };

    const msg: React.CSSProperties = {
      marginTop: 10,
      padding: "0 6px 12px 6px",
      fontWeight: 900,
      color: "rgba(226,232,240,0.95)",
      lineHeight: 1.25,
      wordBreak: "break-word",
      textAlign: "center", // center message
    };

    const sub: React.CSSProperties = {
      marginTop: 2,
      marginBottom: 2,
      fontWeight: 850,
      fontSize: 12,
      color: "rgba(148,163,184,0.85)",
      textAlign: "center",
    };

    const progressWrap: React.CSSProperties = {
      height: 3,
      width: "100%",
      background: "rgba(148,163,184,0.12)",
    };

    const progressBar: React.CSSProperties = {
      height: "100%",
      width: "100%",
      transformOrigin: "left center",
      transform: "scaleX(1)",
      transition: "transform 100ms linear",
    };

    return { wrapper, cardBase, headerRow, iconBadge, closeBtn, msg, sub, progressWrap, progressBar };
  }, []);

  useEffect(() => {
    const onToast = (ev: Event) => {
      const e = ev as CustomEvent<ToastEventDetail>;
      const message = String(e.detail?.message ?? "").trim();
      if (!message) return;

      const variant = (e.detail?.variant ?? "info") as ToastVariant;
      const durationMs = Number.isFinite(Number(e.detail?.durationMs)) ? Number(e.detail?.durationMs) : 3200;

      const id = makeId();
      const createdAt = Date.now();

      setToasts((prev) => [{ id, message, variant, createdAt, durationMs }, ...prev].slice(0, 4));
    };

    window.addEventListener(EVENT_NAME, onToast);
    return () => window.removeEventListener(EVENT_NAME, onToast);
  }, []);

  // Timer loop to remove expired toasts + update progress smoothly
  useEffect(() => {
    const tick = () => {
      const now = Date.now();
      setToasts((prev) => prev.filter((t) => now - t.createdAt < t.durationMs));
      rafRef.current = window.requestAnimationFrame(tick);
    };

    rafRef.current = window.requestAnimationFrame(tick);
    return () => {
      if (rafRef.current) window.cancelAnimationFrame(rafRef.current);
      rafRef.current = null;
    };
  }, []);

  if (toasts.length === 0) return null;

  const dismiss = (id: string) => setToasts((prev) => prev.filter((t) => t.id !== id));

  return (
    <>
      <style>{`
        @keyframes rvToastIn {
          from { transform: translateY(-10px); opacity: 0; }
          to   { transform: translateY(0px); opacity: 1; }
        }
        @media (prefers-reduced-motion: reduce) {
          * { animation: none !important; transition: none !important; }
        }
      `}</style>

      <div style={styles.wrapper} aria-live="polite" aria-relevant="additions">
        {toasts.map((t) => {
          const elapsed = Date.now() - t.createdAt;
          const pct = Math.min(1, Math.max(0, elapsed / t.durationMs));
          const scale = 1 - pct;
          const accent = accentFor(t.variant);

          return (
            <div
              key={t.id}
              style={styles.cardBase}
              onClick={() => dismiss(t.id)}
              title="Click to dismiss"
              role="status"
            >
              {/* Neon border glow */}
              <div
                style={{
                  position: "absolute",
                  inset: -1,
                  borderRadius: 18,
                  pointerEvents: "none",
                  boxShadow: `0 0 0 1px rgba(148,163,184,0.12) inset, 0 0 26px ${accent}`,
                  opacity: 0.55,
                }}
              />

              {/* Neon top strip */}
              <div
                style={{
                  position: "absolute",
                  top: 0,
                  left: 0,
                  right: 0,
                  height: 2,
                  background: accent,
                  boxShadow: `0 0 18px ${accent}`,
                  opacity: 0.9,
                }}
              />

              <div style={styles.headerRow}>
                <div style={styles.iconBadge}>
                  {iconFor(t.variant)}
                </div>

                <button
                  type="button"
                  onClick={(e) => {
                    e.stopPropagation();
                    dismiss(t.id);
                  }}
                  style={styles.closeBtn}
                  aria-label="Dismiss toast"
                  title="Dismiss"
                >
                  ‚úï
                </button>
              </div>

              {/* No "Info" / "Success" text ‚Äî just centered content */}
              <div style={styles.msg}>{t.message}</div>

              <div style={styles.progressWrap}>
                <div
                  style={{
                    ...styles.progressBar,
                    background: accent,
                    boxShadow: `0 0 14px ${accent}`,
                    transform: `scaleX(${scale})`,
                  }}
                />
              </div>
            </div>
          );
        })}
      </div>
    </>
  );
}
==== src/components/Footer.tsx ====
import { NavLink } from "react-router-dom";
import rvLogo from "../assets/roberts-ventures-logo.png";

const linkStyle = ({ isActive }: { isActive: boolean }) => ({
  textDecoration: "none",
  fontWeight: 900,
  color: isActive ? "#ffffff" : "#cbd5e1",
  opacity: isActive ? 1 : 0.95,
});

export default function Footer() {
  return (
    <footer
      style={{
        marginTop: 28,
        padding: "22px 16px",
        borderTop: "1px solid rgba(148,163,184,0.18)",
        background: "rgba(2,6,23,0.42)",
        backdropFilter: "blur(6px)",
      }}
    >
      <div style={{ maxWidth: 1200, margin: "0 auto", display: "grid", gap: 14 }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 12, flexWrap: "wrap" }}>
          <div style={{ display: "grid", gap: 4 }}>
            <div style={{ display: "inline-flex", alignItems: "center", gap: 10 }}>
              <img
                src={rvLogo}
                alt="Roberts Ventures LLC"
                style={{
                  width: 22,
                  height: 22,
                  objectFit: "contain",
                  filter: "drop-shadow(0 0 12px rgba(56,189,248,.18))",
                }}
              />
              <div style={{ fontWeight: 950, letterSpacing: "0.06em", color: "#e2e8f0" }}>
                Roberts Ventures LLC
              </div>
            </div>

            <div className="muted" style={{ fontWeight: 850 }}>
              Home Services ‚Ä¢ Woodworking ‚Ä¢ Outdoor ‚Ä¢ Project Consultation
            </div>
          </div>

          <div className="row" style={{ gap: 12, flexWrap: "wrap" }}>
            <NavLink to="/about" style={linkStyle}>About</NavLink>
            <NavLink to="/portfolio" style={linkStyle}>Portfolio</NavLink>
            <NavLink to="/reviews" style={linkStyle}>Reviews</NavLink>
            <NavLink to="/faq" style={linkStyle}>FAQ</NavLink>
            <NavLink to="/service-area" style={linkStyle}>Service Area</NavLink>
            <NavLink to="/policies" style={linkStyle}>Policies</NavLink>
          </div>
        </div>

        <div
          className="panel"
          style={{
            padding: 14,
            borderRadius: 16,
            display: "grid",
            gap: 10,
            background: "rgba(15,23,42,0.55)",
            border: "1px solid rgba(148,163,184,0.16)",
          }}
        >
          <div className="row" style={{ justifyContent: "space-between", gap: 12, flexWrap: "wrap" }}>
            <div style={{ display: "grid", gap: 4 }}>
              <div style={{ fontWeight: 950, color: "#e5e7eb" }}>Stay Lit Candle Co.</div>
              <div className="muted" style={{ fontWeight: 850 }}>
                Pre-made candles ‚Ä¢ Build-your-own scent + jar + wick
              </div>
            </div>
            <div className="row" style={{ gap: 12, flexWrap: "wrap" }}>
              <NavLink to="/staylit" style={linkStyle}>Stay Lit Home</NavLink>
              <NavLink to="/staylit/about" style={linkStyle}>Stay Lit About</NavLink>
              <NavLink to="/staylit/policies" style={linkStyle}>Stay Lit Policies</NavLink>
            </div>
          </div>

          <div className="muted" style={{ fontWeight: 850 }}>
            ¬© {new Date().getFullYear()} Roberts Ventures LLC. All rights reserved.
          </div>
        </div>
      </div>
    </footer>
  );
}
==== src/components/SubNavbar.tsx ====
import { NavLink } from "react-router-dom";

const subLinkStyle = ({ isActive }: { isActive: boolean }) => ({
  textDecoration: "none",
  padding: "6px 10px",
  borderRadius: 999,
  fontWeight: 700,
  fontSize: 12,
  color: "var(--card-subtext)",
  background: isActive ? "rgba(14,165,233,0.12)" : "transparent",
  transition: "all .2s ease",
});

export default function SubNavbar() {
  return (
    <div
      className="staylit-subnav"
      style={{
        width: "100%",
        borderBottom: "1px solid rgba(148,163,184,0.15)",
        backdropFilter: "blur(12px)",
        background: "rgba(2,6,23,0.55)",
      }}
    >
      <div
        style={{
          maxWidth: 1200,
          margin: "0 auto",
          padding: "6px 16px",
          display: "flex",
          gap: 6,
          alignItems: "center",
          justifyContent: "center",
          flexWrap: "wrap",
        }}
      >
        <NavLink to="/about" style={subLinkStyle}>About</NavLink>
        <NavLink to="/portfolio" style={subLinkStyle}>Portfolio</NavLink>
        <NavLink to="/reviews" style={subLinkStyle}>Reviews</NavLink>
        <NavLink to="/faq" style={subLinkStyle}>FAQ</NavLink>
        <NavLink to="/service-area" style={subLinkStyle}>Service Area</NavLink>
        <NavLink to="/policies" style={subLinkStyle}>Policies</NavLink>
      </div>
    </div>
  );
}
==== src/hooks/useThemeMode.ts ====
import { useEffect } from "react";

/**
 * Auto theme mode:
 * - Stay Lit routes => dark theme
 * - Everything else => light theme
 *
 * Applies:
 *   <html data-theme="dark|light">
 * so we can style text/background consistently across the entire site.
 */
export default function useThemeMode(isDark: boolean) {
  useEffect(() => {
    const el = document.documentElement; // <html>
    el.setAttribute("data-theme", isDark ? "dark" : "light");
    return () => {
      // keep whatever last mode was; no cleanup needed
    };
  }, [isDark]);
}
==== src/lib/confirm.ts ====
export function goToRequestConfirmed() {
  // Ensure the last saved request has a stable id, then redirect.
  try {
    const raw = JSON.parse(localStorage.getItem("rv_requests") ?? "[]");
    const arr = Array.isArray(raw) ? raw : [];
    const lastIndex = arr.length - 1;

    if (lastIndex >= 0) {
      const last: any = arr[lastIndex];

      if (!last.id) {
        last.id =
          (crypto as any).randomUUID?.() ??
          (Math.random().toString(16).slice(2) + Date.now().toString(16));
        arr[lastIndex] = last;
        localStorage.setItem("rv_requests", JSON.stringify(arr));
      }

      window.location.href = `/request-confirmed/${last.id}`;
      return;
    }
  } catch (e) {
    // ignore
  }

  // fallback (rare)
  window.location.href =
    `/request-confirmed/${Math.random().toString(16).slice(2) + Date.now().toString(16)}`;
}
==== src/lib/buildPricing.ts ====
import type { BuildDims, BuildOptions } from "./buildsStore";

/**
 * Very first-pass estimator (upgradeable):
 * - Materials ~ board feet proxy or sheet proxy
 * - Labor ~ complexity + size scaling
 * - Finish ~ depends on type
 * - Overhead/profit baked in
 *
 * Customer sees ONLY: a single total + optional range.
 * Admin later can see breakdown + editable factors.
 */

function clamp(n: number, min: number, max: number) {
  return Math.max(min, Math.min(max, n));
}

function money(n: number) {
  return Math.round(n * 100) / 100;
}

function areaSqFt(d: BuildDims) {
  const topSqIn = clamp(d.lengthIn, 1, 10000) * clamp(d.widthIn, 1, 10000);
  return topSqIn / 144;
}

function volumeProxy(d: BuildDims) {
  // simple ‚Äúsize‚Äù proxy for labor scaling
  return (clamp(d.lengthIn, 1, 10000) * clamp(d.widthIn, 1, 10000) * clamp(d.heightIn, 1, 10000)) / 1728;
}

function speciesMultiplier(s: BuildOptions["woodSpecies"]) {
  if (s === "Pine") return 1.0;
  if (s === "Poplar") return 1.05;
  if (s === "Plywood") return 1.1;
  if (s === "Oak") return 1.35;
  if (s === "Maple") return 1.45;
  if (s === "Walnut") return 1.9;
  return 1.2;
}

function finishCostPerSqFt(f: BuildOptions["finish"]) {
  if (f === "Natural") return 3;
  if (f === "Stain") return 6;
  if (f === "Paint") return 8;
  if (f === "Poly") return 7;
  return 5;
}

function joineryComplexity(j: BuildOptions["joinery"]) {
  if (j === "Screws") return 1.0;
  if (j === "Pocket Holes") return 1.15;
  if (j === "Dowels") return 1.35;
  if (j === "Mortise & Tenon") return 1.7;
  return 1.2;
}

export function estimateBuild(dims: BuildDims, options: BuildOptions) {
  const a = areaSqFt(dims);
  const v = volumeProxy(dims);

  // Materials base: $45 per sqft (very rough) scaled by species
  const materials = money(45 * a * speciesMultiplier(options.woodSpecies));

  // Labor base hours: 4 + size + joinery complexity
  const laborHours = clamp(4 + v * 0.35, 4, 60) * joineryComplexity(options.joinery);

  // Labor rate (customer-facing baked into total)
  const labor = money(laborHours * 85); // $85/hr placeholder (admin can change later)

  // Finish
  const finish = money(a * finishCostPerSqFt(options.finish));

  // Overhead + profit
  const overhead = money((materials + labor + finish) * 0.18);

  const subtotal = materials + labor + finish + overhead;

  // Uncertainty band
  const rangeLow = money(subtotal * 0.88);
  const rangeHigh = money(subtotal * 1.18);

  return {
    materials,
    labor,
    finish,
    overhead,
    total: money(subtotal),
    rangeLow,
    rangeHigh,
  };
}
==== src/lib/requestsStore.ts ====
export type RVRequestStatus = "new" | "in_progress" | "complete";

export type RVPhoto = { name: string; type: string; dataUrl: string };

export type RVRequest = {
  id: string;
  createdAt: string;
  appointmentStart: string;
  accessCode?: string;
  customer: {
    name: string;
    phone: string;
    address: string;
    notes: string;
  };
  items: Array<{ serviceId: string; qty: number; note: string }>;
  photos: RVPhoto[];
  status: RVRequestStatus;
};

const KEY = "rv_requests";

function safeParse<T>(raw: string | null, fallback: T): T {
  try {
    if (!raw) return fallback;
    const v = JSON.parse(raw);
    return (v ?? fallback) as T;
  } catch {
    return fallback;
  }
}

export function readAllRequests(): RVRequest[] {
  const arr = safeParse<any[]>(localStorage.getItem(KEY), []);
  return Array.isArray(arr) ? (arr as RVRequest[]).filter(Boolean) : [];
}

export function findRequestById(id: string): RVRequest | undefined {
  const all = readAllRequests();
  return all.find((r) => String((r as any)?.id ?? "") === String(id));
}

function normalizePhone(p: string) {
  return String(p || "").replace(/\D+/g, "");
}

function normalizeName(name: string) {
  return String(name || "")
    .trim()
    .toLowerCase()
    .replace(/\s+/g, " ");
}

export function findRequestsByNameAndPhone(name: string, phone: string): RVRequest[] {
  const n = normalizeName(name);
  const p = normalizePhone(phone);
  if (!n || !p) return [];
  return readAllRequests().filter((r) => {
    const rn = normalizeName(r?.customer?.name || "");
    const rp = normalizePhone(r?.customer?.phone || "");
    return rn === n && rp === p;
  });
}

export function findRequestsByPhone(phone: string): RVRequest[] {
  const target = normalizePhone(phone);
  if (!target) return [];
  return readAllRequests().filter((r) => normalizePhone(r?.customer?.phone || "") === target);
}

function normalizeCode(c: string) {
  return String(c || "").trim().toLowerCase();
}

export function findRequestsByPhoneAndCode(phone: string, code: string): RVRequest[] {
  const targetPhone = normalizePhone(phone);
  const targetCode = normalizeCode(code);
  if (!targetPhone || !targetCode) return [];
  return readAllRequests().filter((r) => {
    const rp = normalizePhone(r?.customer?.phone || "");
    const rc = normalizeCode((r as any)?.accessCode || "");
    return rp === targetPhone && rc === targetCode;
  });
}
==== src/lib/toast.ts ====
export type ToastType = "success" | "info" | "warning" | "error";

export type ToastPayload = {
  message: string;
  type?: ToastType;
  title?: string;
  durationMs?: number;

  // Optional action button
  actionLabel?: string;
  actionHref?: string;
};

export function toast(
  message: string,
  type: ToastType = "success",
  title?: string,
  durationMs: number = 2400,
  actionLabel?: string,
  actionHref?: string
) {
  const payload: ToastPayload = { message, type, title, durationMs, actionLabel, actionHref };
  window.dispatchEvent(new CustomEvent("rv_toast", { detail: payload }));
}
==== src/lib/theme.ts ====
export type ThemeMode = "light" | "dark";

const KEY = "rv_theme";

export function applyTheme(mode: ThemeMode) {
  // Put theme on <html data-theme="..."> since your CSS uses html[data-theme="dark"]
  document.documentElement.setAttribute("data-theme", mode);
}

export function getActiveTheme(): ThemeMode {
  const v = (localStorage.getItem(KEY) || "").toLowerCase();
  if (v === "dark" || v === "light") return v as ThemeMode;

  // Default: follow system preference
  const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
  return prefersDark ? "dark" : "light";
}

export function setTheme(mode: ThemeMode): ThemeMode {
  localStorage.setItem(KEY, mode);
  applyTheme(mode);
  return mode;
}

export function toggleTheme(): ThemeMode {
  const next: ThemeMode = getActiveTheme() === "dark" ? "light" : "dark";
  return setTheme(next);
}

// Call once on startup (main.tsx) so the page loads in correct mode immediately
export function initTheme() {
  applyTheme(getActiveTheme());
}
==== src/lib/buildsStore.ts ====
export type BuildStatus = "draft" | "submitted" | "reviewing" | "quote_sent" | "approved" | "in_build" | "complete";

export type BuildCustomer = {
  name: string;
  phone: string;
  email: string;
  address?: string;
};

export type BuildDims = {
  lengthIn: number;
  widthIn: number;
  heightIn: number;
  topThicknessIn?: number;
};

export type BuildOptions = {
  woodSpecies: "Pine" | "Oak" | "Walnut" | "Maple" | "Poplar" | "Plywood";
  finish: "Natural" | "Stain" | "Paint" | "Poly";
  joinery: "Screws" | "Pocket Holes" | "Mortise & Tenon" | "Dowels";
};

export type RenderStatus = "queued" | "rendering" | "complete" | "failed";

export type RenderJob = {
  renderId: string;
  view: "iso" | "front" | "top" | "detail";
  status: RenderStatus;
  imageDataUrl?: string;
  startedAt?: string;
  finishedAt?: string;
  estimatePublic?: {
    total: number;
    rangeLow?: number;
    rangeHigh?: number;
    label?: string;
  };
};

export type NoteAuthor = "customer" | "admin";
export type NoteKind = "initial" | "change" | "refinement" | "note";

export type NoteItem = {
  noteId: string;
  createdAt: string;
  author: NoteAuthor;
  kind: NoteKind;
  text: string;
};

export type BuildVersion = {
  versionId: string;
  createdAt: string;
  customerChangeRequest?: string;
  inputsSnapshot: {
    type: string;
    dims: BuildDims;
    options: BuildOptions;

    // Legacy field kept for backwards compatibility ONLY.
    // Going forward: we keep this EMPTY to prevent duplicate/phantom notes.
    notes?: string;

    // Canonical notes source of truth
    notesLog?: NoteItem[];
  };
  renders: RenderJob[];

  estimatePublic?: {
    total: number;
    rangeLow?: number;
    rangeHigh?: number;
    materials: number;
    labor: number;
    overhead: number;
    finish: number;
  };

  estimateInternal?: any;
  generatedPackage?: any;
};

export type BuildSubmission = {
  id: string;
  createdAt: string;
  updatedAt: string;

  status: BuildStatus;
  accessCode?: string;

  customer: BuildCustomer;

  project: {
    type: string;
    dims: BuildDims;
    options: BuildOptions;

    // Legacy compiled string (we keep it EMPTY going forward)
    notes?: string;

    // Canonical structured notes
    notesLog?: NoteItem[];

    refPhotos?: { name: string; type: string; dataUrl: string }[];
  };

  versions: BuildVersion[];
};

const KEY = "rv_build_submissions";

function safeParse<T>(raw: string | null, fallback: T): T {
  try {
    if (!raw) return fallback;
    return JSON.parse(raw) as T;
  } catch {
    return fallback;
  }
}

function uid() {
  return (crypto as any).randomUUID?.() ?? (Math.random().toString(16).slice(2) + Date.now().toString(16));
}

/**
 * If an old build exists with only legacy `notes` and no `notesLog`,
 * migrate it into a single structured "initial" note.
 */
function ensureNotesLog(legacyNotes?: string, existing?: NoteItem[], createdAtHint?: string): NoteItem[] {
  const log = Array.isArray(existing) ? existing.filter(Boolean) : [];
  if (log.length) return log;

  const text = String(legacyNotes || "").trim();
  if (!text) return [];

  return [
    {
      noteId: uid(),
      createdAt: createdAtHint || new Date().toISOString(),
      author: "customer",
      kind: "initial",
      text,
    },
  ];
}

function normalizeBuild(b: any): BuildSubmission | null {
  if (!b || typeof b !== "object") return null;

  const createdAt = String(b.createdAt || new Date().toISOString());
  const project = b.project || {};

  const legacyProjectNotes = String(project.notes || "").trim();
  const projectNotesLog = ensureNotesLog(legacyProjectNotes, project.notesLog, createdAt);

  const versions = Array.isArray(b.versions) ? b.versions : [];
  const nextVersions: BuildVersion[] = versions.map((v: any) => {
    const inputs = v?.inputsSnapshot || {};
    const vCreatedAt = String(v?.createdAt || createdAt);

    // Old builds may have inputsSnapshot.notes (compiled blob) but no notesLog.
    const legacyVNotes = String(inputs.notes ?? legacyProjectNotes ?? "").trim();
    const vNotesLog = ensureNotesLog(legacyVNotes, inputs.notesLog ?? projectNotesLog, vCreatedAt);

    return {
      ...v,
      createdAt: vCreatedAt,
      inputsSnapshot: {
        type: String(inputs.type || project.type || ""),
        dims: inputs.dims || project.dims,
        options: inputs.options || project.options,

        // IMPORTANT: going forward we keep legacy notes empty to avoid duplication.
        // We only keep it for old builds that still have it.
        notes: String(inputs.notes || "").includes("\n---\n") ? "" : "",

        notesLog: vNotesLog,
      },
      renders: Array.isArray(v?.renders) ? v.renders : [],
    } as BuildVersion;
  });

  const out: BuildSubmission = {
    ...b,
    createdAt,
    updatedAt: String(b.updatedAt || createdAt),
    status: (b.status || "draft") as BuildStatus,
    customer: b.customer || { name: "", phone: "", email: "" },
    project: {
      ...project,
      type: String(project.type || ""),
      dims: project.dims,
      options: project.options,

      // IMPORTANT: going forward we keep legacy notes empty (canonical is notesLog)
      notes: "",

      notesLog: projectNotesLog,
      refPhotos: Array.isArray(project.refPhotos) ? project.refPhotos : [],
    },
    versions: nextVersions,
  };

  return out;
}

/**
 * Compile notes for display + renderer.
 * We do NOT prepend legacy notes anymore (we keep legacy notes empty going forward).
 * This prevents "remove last note" from appearing to do nothing.
 */
export function compileNotes(notesLog?: NoteItem[], _legacyNotes?: string) {
  const items = Array.isArray(notesLog) ? notesLog : [];
  return items
    .map((n) => String(n?.text || "").trim())
    .filter(Boolean)
    .join("\n\n---\n\n");
}

export function normalizePhone(p: string) {
  return String(p || "").replace(/\D+/g, "");
}

export function makeAccessCode() {
  return String(Math.floor(100000 + Math.random() * 900000));
}

export function readBuilds(): BuildSubmission[] {
  const arr = safeParse<any[]>(localStorage.getItem(KEY), []);
  const raw = (Array.isArray(arr) ? arr : []).filter(Boolean);
  return raw.map(normalizeBuild).filter(Boolean) as BuildSubmission[];
}

export function writeBuilds(items: BuildSubmission[]) {
  localStorage.setItem(KEY, JSON.stringify(items));
}

export function getBuild(id: string): BuildSubmission | null {
  const all = readBuilds();
  const found = all.find((b) => String(b.id) === String(id));
  return found || null;
}

export function upsertBuild(next: BuildSubmission) {
  const all = readBuilds();
  const idx = all.findIndex((b) => String(b.id) === String(next.id));
  if (idx >= 0) all[idx] = next;
  else all.unshift(next);
  writeBuilds(all);
}

export function deleteBuild(id: string) {
  const all = readBuilds().filter((b) => String(b.id) !== String(id));
  writeBuilds(all);
}

export function createDraftBuild(args: {
  customer: BuildCustomer;
  type: string;
  dims: BuildDims;
  options: BuildOptions;
  notes?: string;
}): BuildSubmission {
  const now = new Date().toISOString();
  const id = uid();

  const baseNotes = String(args.notes || "").trim();

  // canonical notesLog (and legacy notes stays empty)
  const notesLog: NoteItem[] = baseNotes
    ? [
        {
          noteId: uid(),
          createdAt: now,
          author: "customer",
          kind: "initial",
          text: baseNotes,
        },
      ]
    : [];

  const version: BuildVersion = {
    versionId: uid(),
    createdAt: now,
    inputsSnapshot: {
      type: args.type,
      dims: args.dims,
      options: args.options,
      notes: "",
      notesLog,
    },
    renders: [
      { renderId: uid(), view: "iso", status: "queued" },
      { renderId: uid(), view: "front", status: "queued" },
      { renderId: uid(), view: "top", status: "queued" },
    ],
  };

  const build: BuildSubmission = {
    id,
    createdAt: now,
    updatedAt: now,
    status: "draft",
    customer: args.customer,
    project: {
      type: args.type,
      dims: args.dims,
      options: args.options,
      notes: "",
      notesLog,
      refPhotos: [],
    },
    versions: [version],
  };

  upsertBuild(build);
  return build;
}

export function addRevision(
  id: string,
  customerChangeRequest: string,
  patch?: Partial<BuildSubmission["project"]>
) {
  const b0 = getBuild(id);
  if (!b0) return null;

  const b = normalizeBuild(b0);
  if (!b) return null;

  const now = new Date().toISOString();
  const mergedProject: BuildSubmission["project"] = { ...b.project, ...(patch || {}) };

  const mergedNotesLog = ensureNotesLog("", mergedProject.notesLog, b.createdAt);

  const version: BuildVersion = {
    versionId: uid(),
    createdAt: now,
    customerChangeRequest,
    inputsSnapshot: {
      type: mergedProject.type,
      dims: mergedProject.dims,
      options: mergedProject.options,
      notes: "",
      notesLog: mergedNotesLog,
    },
    renders: [
      { renderId: uid(), view: "iso", status: "queued" },
      { renderId: uid(), view: "front", status: "queued" },
      { renderId: uid(), view: "top", status: "queued" },
      { renderId: uid(), view: "detail", status: "queued" },
    ],
  };

  const next: BuildSubmission = {
    ...b,
    updatedAt: now,
    project: { ...mergedProject, notes: "", notesLog: mergedNotesLog },
    versions: [version, ...b.versions],
  };

  upsertBuild(next);
  return next;
}

export function addCustomerNote(id: string, changeRequest?: string, extraNotes?: string) {
  const b0 = getBuild(id);
  if (!b0) return null;

  const b = normalizeBuild(b0);
  if (!b) return null;

  const now = new Date().toISOString();
  const prevLog = ensureNotesLog("", b.project.notesLog, b.createdAt);

  const nextLog: NoteItem[] = [...prevLog];

  const req = String(changeRequest || "").trim();
  const add = String(extraNotes || "").trim();

  if (req) {
    nextLog.push({
      noteId: uid(),
      createdAt: now,
      author: "customer",
      kind: "change",
      text: req,
    });
  }

  if (add) {
    nextLog.push({
      noteId: uid(),
      createdAt: now,
      author: "customer",
      kind: "refinement",
      text: add,
    });
  }

  return addRevision(id, "Customer provided additional details", {
    notesLog: nextLog,
    notes: "",
  });
}

export function removeLastCustomerNote(id: string) {
  const b0 = getBuild(id);
  if (!b0) return null;

  const b = normalizeBuild(b0);
  if (!b) return null;

  const prevLog = ensureNotesLog("", b.project.notesLog, b.createdAt);
  if (!prevLog.length) return b;

  let idx = -1;
  for (let i = prevLog.length - 1; i >= 0; i--) {
    if (prevLog[i]?.author === "customer") {
      idx = i;
      break;
    }
  }
  if (idx < 0) return b;

  const nextLog = prevLog.slice(0, idx).concat(prevLog.slice(idx + 1));

  return addRevision(id, "Customer removed last note", {
    notesLog: nextLog,
    notes: "",
  });
}

export function markSubmitted(id: string) {
  const b = getBuild(id);
  if (!b) return null;

  const now = new Date().toISOString();
  const accessCode = b.accessCode && String(b.accessCode).trim().length >= 6 ? b.accessCode : makeAccessCode();

  const next: BuildSubmission = {
    ...b,
    updatedAt: now,
    status: b.status === "draft" ? "submitted" : b.status,
    accessCode,
  };

  upsertBuild(next);
  return next;
}

export function findBuildsByPhoneAndCode(phone: string, code: string) {
  const p = normalizePhone(phone);
  const c = String(code || "").replace(/\D+/g, "");
  if (!p || c.length < 6) return [];
  return readBuilds().filter((b) => normalizePhone(b.customer?.phone || "") === p && String(b.accessCode || "") === c);
}

export function findBuildsByNameAndPhone(name: string, phone: string) {
  const n = String(name || "").trim().toLowerCase();
  const p = normalizePhone(phone);
  if (!n || p.length < 7) return [];
  return readBuilds().filter((b) => {
    const bn = String(b.customer?.name || "").trim().toLowerCase();
    const bp = normalizePhone(b.customer?.phone || "");
    return bn.includes(n) && bp.endsWith(p.slice(-7));
  });
}
==== src/lib/render3d.ts ====
import * as THREE from "three";
import type { BuildDims, BuildOptions } from "./buildsStore";

type View = "iso" | "front" | "top" | "detail";

function clamp(n: number, min: number, max: number) {
  return Math.max(min, Math.min(max, n));
}

function safeIn(n: number, fallback: number) {
  const v = Number(n);
  return Number.isFinite(v) && v > 0 ? v : fallback;
}

function woodColor(species: BuildOptions["woodSpecies"]) {
  // Simple readable tones (non-photoreal). Upgrade later with textures.
  switch (species) {
    case "Pine": return 0xE6D2A6;
    case "Poplar": return 0xD8E0A8;
    case "Plywood": return 0xD9C7A3;
    case "Oak": return 0xC8A06C;
    case "Maple": return 0xEAD9B6;
    case "Walnut": return 0x6B4A2E;
    default: return 0xC8A06C;
  }
}

function finishSheen(finish: BuildOptions["finish"]) {
  if (finish === "Natural") return { roughness: 0.65, metalness: 0.02 };
  if (finish === "Stain") return { roughness: 0.55, metalness: 0.03 };
  if (finish === "Paint") return { roughness: 0.35, metalness: 0.01 };
  if (finish === "Poly") return { roughness: 0.25, metalness: 0.04 };
  return { roughness: 0.55, metalness: 0.03 };
}

function fitToView(length: number, depth: number, height: number) {
  const maxDim = Math.max(length, depth, height);
  return clamp(maxDim * 0.95, 40, 320);
}

function makeCamera(view: View, frustumSize: number) {
  const cam = new THREE.OrthographicCamera(
    -frustumSize, frustumSize, frustumSize, -frustumSize,
    0.1, 4000
  );

  if (view === "top") {
    cam.position.set(0, 600, 0.001);
  } else if (view === "front") {
    cam.position.set(0, 220, 600);
  } else if (view === "detail") {
    cam.position.set(420, 280, 420);
  } else {
    cam.position.set(520, 360, 520); // iso
  }

  cam.lookAt(0, 0, 0);
  cam.updateProjectionMatrix();
  return cam;
}

function normType(t: string) {
  return String(t || "").trim().toLowerCase();
}

function normNotes(n: string | undefined) {
  return String(n || "").trim().toLowerCase();
}

function has(notes: string, ...phrases: string[]) {
  return phrases.some((p) => notes.includes(p));
}

function addBox(
  group: THREE.Group,
  w: number,
  h: number,
  d: number,
  x: number,
  y: number,
  z: number,
  mat: THREE.Material
) {
  const geom = new THREE.BoxGeometry(w, h, d);
  const mesh = new THREE.Mesh(geom, mat);
  mesh.position.set(x, y, z);
  group.add(mesh);
  return geom;
}

/**
 * Notes-driven features (simple heuristics, safe defaults):
 * - "lower shelf", "bottom shelf", "shelf" -> adds a shelf panel for table/bench/workbench
 * - "apron" -> adds apron rails (unless notes include "no apron")
 * - "drawer" -> adds a simple drawer box under top (front-facing)
 * - "taper" / "tapered legs" -> visually tapers legs using mesh scaling
 * - "feet" -> adds small feet blocks for planter/cabinet
 *
 * This is NOT photoreal; it's an improving proxy model based on customer intent.
 */
function buildModel(args: {
  projectType: string;
  dims: BuildDims;
  options: BuildOptions;
  notes?: string;
}) {
  const group = new THREE.Group();
  const notes = normNotes(args.notes);

  // Interpret dims consistently:
  // lengthIn => X (long)
  // widthIn  => Z (depth)
  // heightIn => Y (overall height)
  const length = clamp(safeIn(args.dims.lengthIn, 60), 12, 240);
  const depth  = clamp(safeIn(args.dims.widthIn, 30), 10, 240);
  const height = clamp(safeIn(args.dims.heightIn, 30), 10, 240);

  const topThickness = clamp(safeIn(args.dims.topThicknessIn ?? 1.5, 1.5), 0.5, 6);

  const sheen = finishSheen(args.options.finish);
  const woodMat = new THREE.MeshStandardMaterial({
    color: woodColor(args.options.woodSpecies),
    roughness: sheen.roughness,
    metalness: sheen.metalness,
  });

  const darkMat = new THREE.MeshStandardMaterial({
    color: 0x0f172a,
    roughness: 0.85,
    metalness: 0.05,
  });

  const t = normType(args.projectType);

  // Shared thickness defaults (inches-as-units)
  const boardT = clamp(Math.min(depth, length) * 0.035, 0.6, 1.25); // panel/board thickness
  const legSize = clamp(Math.min(depth, length) * 0.06, 1.5, 4.0);

  // Helpers
  const xMin = -length / 2;
  const xMax =  length / 2;
  const zMin = -depth  / 2;
  const zMax =  depth  / 2;

  const geoms: THREE.BufferGeometry[] = [];

  const isTable = t.includes("table");
  const isBench = t.includes("bench");
  const isWorkbench = t.includes("workbench");

  // --- TABLE / BENCH / WORKBENCH (top + 4 legs) ---
  if (isTable || isBench || isWorkbench) {
    const topY = height - topThickness / 2;

    // Top
    geoms.push(addBox(group, length, topThickness, depth, 0, topY, 0, woodMat));

    // Legs
    const legH = Math.max(2, height - topThickness);
    const inset = clamp(legSize * 0.65, 1.25, 4.5);

    const lx1 = xMin + inset + legSize / 2;
    const lx2 = xMax - inset - legSize / 2;
    const lz1 = zMin + inset + legSize / 2;
    const lz2 = zMax - inset - legSize / 2;

    const legY = legH / 2;

    const legGeom = new THREE.BoxGeometry(legSize, legH, legSize);

    function addLeg(x: number, z: number) {
      const mesh = new THREE.Mesh(legGeom, darkMat);
      mesh.position.set(x, legY, z);

      // Notes: tapered legs (visual taper using non-uniform scale)
      if (has(notes, "taper", "tapered leg", "tapered legs")) {
        // slightly narrower at the top by scaling X/Z a bit (simple proxy)
        // Using scale affects the whole mesh uniformly; we fake taper by scaling and adding a small "cap"
        mesh.scale.set(0.88, 1, 0.88);
        const cap = new THREE.Mesh(new THREE.BoxGeometry(legSize * 0.92, legSize * 0.18, legSize * 0.92), darkMat);
        cap.position.set(x, legH - (legSize * 0.09), z);
        group.add(cap);
        geoms.push(cap.geometry as THREE.BufferGeometry);
      }

      group.add(mesh);
    }

    addLeg(lx1, lz1);
    addLeg(lx2, lz1);
    addLeg(lx1, lz2);
    addLeg(lx2, lz2);

    geoms.push(legGeom);

    // Notes: apron rails (default on workbench, optional on table/bench)
    const wantsApron = isWorkbench || (has(notes, "apron") && !has(notes, "no apron", "noapron"));
    if (wantsApron) {
      const apronH = clamp(height * 0.12, 2, 6);
      const apronY = height - topThickness - apronH / 2;

      // Front/back rails (along X)
      geoms.push(addBox(group, length - inset * 2, apronH, boardT, 0, apronY, zMax - inset - boardT / 2, darkMat));
      geoms.push(addBox(group, length - inset * 2, apronH, boardT, 0, apronY, zMin + inset + boardT / 2, darkMat));

      // Left/right rails (along Z)
      geoms.push(addBox(group, boardT, apronH, depth - inset * 2, xMin + inset + boardT / 2, apronY, 0, darkMat));
      geoms.push(addBox(group, boardT, apronH, depth - inset * 2, xMax - inset - boardT / 2, apronY, 0, darkMat));
    }

    // Notes: lower shelf / bottom shelf
    const wantsShelf = isWorkbench || has(notes, "lower shelf", "bottom shelf") || (has(notes, "shelf") && !has(notes, "no shelf"));
    if (wantsShelf) {
      const shelfY = clamp(legH * 0.28, 6, legH - 8);
      const shelfT = clamp(boardT, 0.6, 1.5);
      geoms.push(addBox(group, length - inset * 2 - legSize * 0.2, shelfT, depth - inset * 2 - legSize * 0.2, 0, shelfY, 0, woodMat));
    }

    // Notes: drawer (simple centered drawer under top, front-facing)
    if (has(notes, "drawer", "drawers")) {
      const drawerH = clamp(height * 0.18, 3, 8);
      const drawerW = clamp(length * 0.35, 10, length - 10);
      const drawerD = clamp(depth * 0.45, 8, depth - 6);
      const drawerY = height - topThickness - drawerH / 2 - 1.2;
      const drawerZ = zMax - drawerD / 2 - 1.2;

      geoms.push(addBox(group, drawerW, drawerH, drawerD, 0, drawerY, drawerZ, darkMat));

      // drawer face
      const faceT = clamp(boardT * 0.8, 0.4, 1.1);
      geoms.push(addBox(group, drawerW * 0.96, drawerH * 0.92, faceT, 0, drawerY, zMax - 0.6, woodMat));
    }

    // Simple stretcher for workbench feel
    if (isWorkbench) {
      const stretcherH = clamp(legSize * 0.45, 0.8, 2.0);
      const stretcherY = clamp(legH * 0.35, 6, legH - 4);
      geoms.push(addBox(group, length - inset * 2 - legSize, stretcherH, legSize * 0.6, 0, stretcherY, 0, darkMat));
    }
  }

  // --- SHELF (two uprights + shelves) ---
  else if (t.includes("shelf")) {
    const sideT = boardT;
    const shelfT = boardT;

    // Uprights (left/right)
    const upH = height;
    const upY = upH / 2;
    const upX = length / 2 - sideT / 2;

    geoms.push(addBox(group, sideT, upH, depth, -upX, upY, 0, woodMat));
    geoms.push(addBox(group, sideT, upH, depth,  upX, upY, 0, woodMat));

    // Shelves: bottom, mid, top
    const insideL = Math.max(8, length - sideT * 2);
    const shelfCount = has(notes, "5 shelf", "five shelf") ? 5 : has(notes, "4 shelf", "four shelf") ? 4 : 3;

    for (let i = 0; i < shelfCount; i++) {
      const frac = (i + 1) / (shelfCount + 1);
      const y = clamp(frac * (height - shelfT) + shelfT / 2, shelfT / 2, height - shelfT / 2);
      geoms.push(addBox(group, insideL, shelfT, depth, 0, y, 0, woodMat));
    }
  }

  // --- CABINET (box with shelf + back) ---
  else if (t.includes("cabinet")) {
    const wallT = clamp(boardT, 0.6, 1.25);
    const shelfT = wallT;
    const insideL = Math.max(10, length - wallT * 2);
    const insideD = Math.max(8, depth - wallT * 2);

    geoms.push(addBox(group, length, wallT, depth, 0, wallT / 2, 0, woodMat));                        // bottom
    geoms.push(addBox(group, length, wallT, depth, 0, height - wallT / 2, 0, woodMat));               // top
    geoms.push(addBox(group, wallT, height, depth, -length / 2 + wallT / 2, height / 2, 0, woodMat)); // left
    geoms.push(addBox(group, wallT, height, depth,  length / 2 - wallT / 2, height / 2, 0, woodMat)); // right
    geoms.push(addBox(group, length, height, wallT, 0, height / 2, -depth / 2 + wallT / 2, woodMat)); // back

    // Shelf count from notes
    const shelves = has(notes, "2 shelf", "two shelf") ? 2 : has(notes, "3 shelf", "three shelf") ? 3 : 1;
    for (let i = 0; i < shelves; i++) {
      const frac = (i + 1) / (shelves + 1);
      const y = clamp(frac * (height - shelfT) + shelfT / 2, shelfT / 2, height - shelfT / 2);
      geoms.push(addBox(group, insideL, shelfT, insideD, 0, y, wallT / 2, woodMat));
    }

    // Notes: feet
    if (has(notes, "feet", "legs")) {
      const foot = clamp(wallT * 1.2, 0.8, 2.2);
      const fy = foot / 2;
      geoms.push(addBox(group, foot, foot, foot, xMin + foot, fy, zMin + foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMax - foot, fy, zMin + foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMin + foot, fy, zMax - foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMax - foot, fy, zMax - foot, darkMat));
    }
  }

  // --- PLANTER BOX (open top, 4 walls + bottom) ---
  else if (t.includes("planter")) {
    const wallT = clamp(boardT, 0.6, 1.5);
    const bottomT = wallT;

    geoms.push(addBox(group, length, bottomT, depth, 0, bottomT / 2, 0, woodMat)); // bottom

    const wallH = Math.max(8, height - bottomT);
    const wallY = bottomT + wallH / 2;

    // front/back
    geoms.push(addBox(group, length, wallH, wallT, 0, wallY,  depth / 2 - wallT / 2, woodMat));
    geoms.push(addBox(group, length, wallH, wallT, 0, wallY, -depth / 2 + wallT / 2, woodMat));

    // left/right
    geoms.push(addBox(group, wallT, wallH, depth - wallT * 2, -length / 2 + wallT / 2, wallY, 0, woodMat));
    geoms.push(addBox(group, wallT, wallH, depth - wallT * 2,  length / 2 - wallT / 2, wallY, 0, woodMat));

    // Notes: feet
    if (has(notes, "feet", "legs", "stand")) {
      const foot = clamp(wallT * 1.25, 0.8, 2.4);
      const fy = foot / 2;
      geoms.push(addBox(group, foot, foot, foot, xMin + foot, fy, zMin + foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMax - foot, fy, zMin + foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMin + foot, fy, zMax - foot, darkMat));
      geoms.push(addBox(group, foot, foot, foot, xMax - foot, fy, zMax - foot, darkMat));
    }
  }

  // --- DEFAULT (fallback block) ---
  else {
    geoms.push(addBox(group, length, height, depth, 0, height / 2, 0, woodMat));
  }

  return { group, length, depth, height, geoms };
}

export async function renderBuildPreviewPng(args: {
  view: View;
  projectType: string;
  title?: string;
  notes?: string;
  dims: BuildDims;
  options: BuildOptions;
  width?: number;
  height?: number;
}) {
  const W = args.width ?? 1200;
  const H = args.height ?? 800;

  // Scene
  const scene = new THREE.Scene();
  scene.background = new THREE.Color(0x0b1220);

  // Lights
  const hemi = new THREE.HemisphereLight(0xBBD7FF, 0x101827, 0.95);
  scene.add(hemi);

  const key = new THREE.DirectionalLight(0xFFFFFF, 1.05);
  key.position.set(240, 280, 200);
  scene.add(key);

  const rim = new THREE.DirectionalLight(0xA78BFA, 0.55);
  rim.position.set(-260, 160, -200);
  scene.add(rim);

  // Model (now notes-aware)
  const model = buildModel({
    projectType: args.projectType,
    dims: args.dims,
    options: args.options,
    notes: args.notes,
  });
  scene.add(model.group);

  // Ground
  const ground = new THREE.Mesh(
    new THREE.PlaneGeometry(1200, 1200),
    new THREE.MeshStandardMaterial({ color: 0x0f1a2f, roughness: 1, metalness: 0 })
  );
  ground.rotation.x = -Math.PI / 2;
  ground.position.y = 0;
  scene.add(ground);

  const grid = new THREE.GridHelper(1000, 32, 0x334155, 0x1f2a44);
  (grid.material as THREE.Material).transparent = true;
  (grid.material as THREE.Material).opacity = 0.25;
  scene.add(grid);

  // Camera
  const frustumSize = fitToView(model.length, model.depth, model.height);
  const camera = makeCamera(args.view, frustumSize);

  // Renderer (offscreen)
  const canvas = document.createElement("canvas");
  const renderer = new THREE.WebGLRenderer({
    canvas,
    antialias: true,
    alpha: false,
    preserveDrawingBuffer: true,
  });

  renderer.setPixelRatio(Math.min(window.devicePixelRatio || 1, 2));
  renderer.setSize(W, H, false);

  // Ortho aspect correction
  const aspect = W / H;
  const ortho = camera as THREE.OrthographicCamera;
  const s = frustumSize;
  ortho.left = -s * aspect;
  ortho.right = s * aspect;
  ortho.top = s;
  ortho.bottom = -s;
  ortho.updateProjectionMatrix();

  renderer.render(scene, camera);

  // Cleanup
  model.geoms.forEach((g) => g.dispose());
  (ground.geometry as THREE.BufferGeometry).dispose();
  (ground.material as THREE.Material).dispose();
  (grid.geometry as THREE.BufferGeometry).dispose();
  (grid.material as THREE.Material).dispose();
  renderer.dispose();

  return canvas.toDataURL("image/png");
}
==== src/data/availability.ts ====
export type AvailabilityConfig = {
  // 0=Sun, 1=Mon, ... 6=Sat
  openDays: number[];
  startHour: number;      // 24h format, e.g. 9
  endHour: number;        // 24h format, e.g. 17 (5pm)
  slotMinutes: number;    // e.g. 60
  bufferMinutes: number;  // time between jobs
  maxDaysAhead: number;   // how far into future customers can book
};

export const AVAILABILITY: AvailabilityConfig = {
  openDays: [1,2,3,4,5,6],  // Mon‚ÄìSat (change anytime)
  startHour: 9,             // 9:00 AM
  endHour: 18,              // 6:00 PM
  slotMinutes: 60,          // 60-min slots
  bufferMinutes: 0,         // add buffer later if desired
  maxDaysAhead: 21,         // 3 weeks ahead
};
==== src/data/firebase.ts ====
import { initializeApp } from "firebase/app";
import { getFirestore } from "firebase/firestore";

const firebaseConfig = {
  apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
  authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
  projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
  storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
  messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
  appId: import.meta.env.VITE_FIREBASE_APP_ID,
};

const app = initializeApp(firebaseConfig);

export const db = getFirestore(app);
==== src/data/staylitCatalog.ts ====
export type CandleProduct = {
  id: string;
  name: string;
  scent: string;
  price: number;
  size: string;
  burnTime: string;
  image?: string;
  description: string;
};

export type CandleOption = {
  id: string;
  name: string;
  priceDelta?: number; // add-on price adjustment
  note?: string;
};

export const STAY_LIT_PRODUCTS: CandleProduct[] = [
  {
    id: "lavender-calm",
    name: "Lavender Calm",
    scent: "Lavender + Vanilla",
    price: 18,
    size: "8 oz",
    burnTime: "40+ hrs",
    description: "Relaxing blend for stress relief and sleep.",
  },
  {
    id: "midnight-woods",
    name: "Midnight Woods",
    scent: "Cedarwood + Musk",
    price: 22,
    size: "10 oz",
    burnTime: "55+ hrs",
    description: "Deep, bold scent inspired by nighttime forests.",
  },
  {
    id: "vanilla-luxe",
    name: "Vanilla Luxe",
    scent: "French Vanilla",
    price: 16,
    size: "7 oz",
    burnTime: "35+ hrs",
    description: "Smooth luxury vanilla for everyday comfort.",
  },
];

// ---- Build Your Own Options ----
export const STAY_LIT_SCENTS: CandleOption[] = [
  { id: "lavender-vanilla", name: "Lavender + Vanilla", priceDelta: 0 },
  { id: "mahogany-teakwood", name: "Mahogany + Teakwood", priceDelta: 2 },
  { id: "clean-linen", name: "Clean Linen", priceDelta: 0 },
  { id: "island-citrus", name: "Island Citrus", priceDelta: 1 },
  { id: "midnight-musk", name: "Midnight Musk", priceDelta: 2 },
];

export const STAY_LIT_JARS: CandleOption[] = [
  { id: "classic-amber", name: "Classic Amber Jar (8 oz)", priceDelta: 0, note: "Best seller" },
  { id: "matte-black", name: "Matte Black Jar (10 oz)", priceDelta: 4, note: "Premium look" },
  { id: "clear-glass", name: "Clear Glass Jar (7 oz)", priceDelta: -1, note: "Light + clean" },
  { id: "tin-travel", name: "Travel Tin (6 oz)", priceDelta: -2, note: "Great for gifts" },
];

export const STAY_LIT_WICKS: CandleOption[] = [
  { id: "cotton", name: "Cotton Wick", priceDelta: 0, note: "Classic clean burn" },
  { id: "wood", name: "Wood Wick", priceDelta: 3, note: "Soft crackle sound" },
  { id: "hemp", name: "Hemp Wick", priceDelta: 1, note: "Even burn" },
];

// Base price for a custom candle BEFORE option deltas
export const STAY_LIT_CUSTOM_BASE_PRICE = 18;
==== src/data/timeSlots.ts ====
import { AVAILABILITY } from "./availability";

export function isOpenDay(date: Date) {
  return AVAILABILITY.openDays.includes(date.getDay());
}

export function clampToMidnight(d: Date) {
  const x = new Date(d);
  x.setHours(0, 0, 0, 0);
  return x;
}

export function addDays(d: Date, days: number) {
  const x = new Date(d);
  x.setDate(x.getDate() + days);
  return x;
}

export function formatDateInput(d: Date) {
  // YYYY-MM-DD for <input type="date">
  const y = d.getFullYear();
  const m = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${y}-${m}-${day}`;
}

export function formatTimeLabel(date: Date) {
  return date.toLocaleTimeString([], { hour: "numeric", minute: "2-digit" });
}

export function buildSlotsForDate(date: Date) {
  const d = clampToMidnight(date);

  if (!isOpenDay(d)) return [];

  const start = new Date(d);
  start.setHours(AVAILABILITY.startHour, 0, 0, 0);

  const end = new Date(d);
  end.setHours(AVAILABILITY.endHour, 0, 0, 0);

  const slots: Date[] = [];

  let cursor = new Date(start);
  const step = AVAILABILITY.slotMinutes + AVAILABILITY.bufferMinutes;

  while (cursor.getTime() + AVAILABILITY.slotMinutes * 60_000 <= end.getTime()) {
    slots.push(new Date(cursor));
    cursor = new Date(cursor.getTime() + step * 60_000);
  }

  return slots;
}
==== src/data/addOns.ts ====
import type { Service } from "./services";

import soundbarImg from "../assets/addons/soundbar-mount.png";
import haulImg from "../assets/addons/haul-away.png";
import deckWashImg from "../assets/addons/deck-wash.png";
import summaryImg from "../assets/addons/written-summary.png";
import highCeilingImg from "../assets/addons/high-ceiling.png";
import cableImg from "../assets/addons/cable-concealment.png";
import stainImg from "../assets/addons/stain-finish.png";
import heavyImg from "../assets/addons/heavy-items.png";

export type AddOn = Service & {
  parentServiceIds: string[];
  isAddOn: true;
  image?: string;
};

export const ADD_ONS: AddOn[] = [
  // TV Mounting add-ons
  {
    id: "addon-cable-concealment",
    parentServiceIds: ["tv-mount"],
    isAddOn: true,
    image: cableImg,
    category: "Add-Ons",
    name: "Cable Concealment (Surface Raceway)",
    shortDesc: "Hide TV cables using paintable surface raceway (in-wall not included).",
    priceType: "starting_at",
    price: 65,
    unitLabel: "starting at",
    durationMins: 30,
  },
  {
    id: "addon-soundbar-mount",
    parentServiceIds: ["tv-mount"],
    isAddOn: true,
    image: soundbarImg,
    category: "Add-Ons",
    name: "Soundbar Mount",
    shortDesc: "Mount soundbar beneath TV (bracket required).",
    priceType: "fixed",
    price: 55,
    unitLabel: "flat rate",
    durationMins: 25,
  },

  // Ceiling Fan add-ons
  {
    id: "addon-high-ceiling",
    parentServiceIds: ["ceiling-fan"],
    isAddOn: true,
    image: highCeilingImg,
    category: "Add-Ons",
    name: "High Ceiling / Tall Ladder Setup",
    shortDesc: "For ceilings above standard height (quote may apply).",
    priceType: "quote",
    durationMins: 20,
  },

  // Custom Shelving add-ons
  {
    id: "addon-stain-finish",
    parentServiceIds: ["custom-shelves"],
    isAddOn: true,
    image: stainImg,
    category: "Add-Ons",
    name: "Stain + Seal Finish",
    shortDesc: "Finish shelves with stain and protective sealant (pricing varies).",
    priceType: "quote",
    durationMins: 30,
  },

  // Junk Removal add-ons
  {
    id: "addon-haul-away",
    parentServiceIds: ["junk-removal"],
    isAddOn: true,
    image: haulImg,
    category: "Add-Ons",
    name: "Haul Away Old Furniture",
    shortDesc: "Remove and dispose of old furniture or bulky items.",
    priceType: "starting_at",
    price: 25,
    unitLabel: "starting at",
    durationMins: 15,
  },
  {
    id: "addon-heavy-items",
    parentServiceIds: ["junk-removal"],
    isAddOn: true,
    image: heavyImg,
    category: "Add-Ons",
    name: "Heavy Items / Stairs Handling",
    shortDesc: "For safes, appliances, pianos, or multi-floor carry-outs.",
    priceType: "quote",
    durationMins: 25,
  },

  // Deck Repair add-ons
  {
    id: "addon-deck-wash",
    parentServiceIds: ["deck-repair"],
    isAddOn: true,
    image: deckWashImg,
    category: "Add-Ons",
    name: "Deck Wash Prep",
    shortDesc: "Light cleaning to prep deck before repairs.",
    priceType: "starting_at",
    price: 45,
    unitLabel: "starting at",
    durationMins: 30,
  },

  // Consultation add-ons
  {
    id: "addon-written-summary",
    parentServiceIds: ["project-consult"],
    isAddOn: true,
    image: summaryImg,
    category: "Add-Ons",
    name: "Written Summary",
    shortDesc: "Written project plan with materials and timeline outline.",
    priceType: "starting_at",
    price: 40,
    unitLabel: "starting at",
    durationMins: 20,
  },
];

export function addOnsFor(serviceId: string) {
  return ADD_ONS.filter((a) => a.parentServiceIds.includes(serviceId));
}
==== src/data/services.ts ====
import consultImg from "../assets/services/consultation.png";
import tvMountImg from "../assets/services/tv-mount.png";
import ceilingFanImg from "../assets/services/ceiling-fan.png";
import shelvesImg from "../assets/services/custom-shelves.png";
import deckRepairImg from "../assets/services/deck-repair.png";
import junkImg from "../assets/services/junk-removal.png";

export type PriceType = "fixed" | "starting_at" | "quote";

export type Service = {
  id: string;
  category: string;
  name: string;
  shortDesc: string;
  priceType: PriceType;
  price?: number;        // used for fixed or starting_at
  unitLabel?: string;    // e.g. "per visit", "per hour", "starting at"
  durationMins?: number; // for scheduling defaults
  image?: string;

};

export const CATEGORIES = [
  "Home Services",
  "Woodworking",
  "Outdoor",
  "Hauling & Cleanup",
  "Consulting / Other",
] as const;

export const SERVICES: Service[] = [
  {
    id: "tv-mount",
    category: "Home Services",
    name: "TV Mounting",
    shortDesc: "Mount TV on drywall/wood studs with basic setup.",
    priceType: "fixed",
    price: 150,
    unitLabel: "flat rate",
    durationMins: 90,
    image: tvMountImg,
  },
  {
    id: "ceiling-fan",
    category: "Home Services",
    name: "Ceiling Fan Install",
    shortDesc: "Replace existing fan/light fixture (standard ceiling height).",
    priceType: "starting_at",
    price: 175,
    unitLabel: "starting at",
    durationMins: 120,
    image: ceilingFanImg,
  },
  {
    id: "custom-shelves",
    category: "Woodworking",
    name: "Custom Shelving (Built-In / Floating)",
    shortDesc: "Design + build shelving to fit your space.",
    priceType: "quote",
    durationMins: 60,
    image: shelvesImg,
  },
  {
    id: "deck-repair",
    category: "Outdoor",
    name: "Deck Repair",
    shortDesc: "Replace boards, tighten structure, improve safety.",
    priceType: "quote",
    durationMins: 120,
    image: deckRepairImg,
  },
  {
    id: "junk-removal",
    category: "Hauling & Cleanup",
    name: "Junk Removal / Haul Away",
    shortDesc: "Pickup + disposal (pricing depends on volume and materials).",
    priceType: "starting_at",
    price: 125,
    unitLabel: "starting at",
    durationMins: 90,
    image: junkImg,
  },
  {
    id: "project-consult",
    category: "Consulting / Other",
    name: "Project Consultation",
    shortDesc: "On-site or virtual planning, measurements, and recommendations.",
    priceType: "fixed",
    price: 75,
    unitLabel: "per 30 min",
    durationMins: 30,
    image: consultImg,
  },
];
==== src/data/requestCart.tsx ====
import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

/**
 * Customer-scoped cart:
 * - Each "customer session" gets its own cart key in localStorage.
 * - That prevents the navbar cart count from showing items from other customers.
 *
 * How we scope:
 * - If customer phone exists, we use it (digits only).
 * - Optionally also include access code if you want stronger separation.
 */

export type CartLine = {
  serviceId: string;
  qty: number;
  note?: string;
};

export type CartState = {
  customerKey: string;          // computed key (phone / access)
  items: CartLine[];
  count: number;                  has: (serviceId: string) => boolean;
// total quantity
  add: (svc: { id: string }, qty?: number, note?: string) => void;
  remove: (serviceId: string) => void;
  setQty: (serviceId: string, qty: number) => void;
  setNote: (serviceId: string, note: string) => void;
  clear: () => void;

  // Customer session controls
  setCustomer: (args: { phone?: string; accessCode?: string }) => void;
};

const CartCtx = createContext<CartState | null>(null);

/** Where we store the "current customer" identity */
const ACTIVE_CUSTOMER_KEY = "rv_active_customer";

/** Prefix for cart storage */
const CART_PREFIX = "rv_cart:";

function normalizePhone(p?: string) {
  return String(p || "").replace(/\D+/g, "");
}

function normalizeCode(c?: string) {
  return String(c || "").replace(/\D+/g, "").slice(0, 12);
}

/**
 * Build a stable customerKey.
 * Choose ONE of these styles:
 *  A) phone only  -> rv_cart:<phone>
 *  B) phone+code  -> rv_cart:<phone>:<code>
 *
 * I‚Äôm using phone+code when code exists, otherwise phone only.
 */
function buildCustomerKey(phone?: string, accessCode?: string) {
  const p = normalizePhone(phone);
  const c = normalizeCode(accessCode);
  if (p && c) return `${p}:${c}`;
  if (p) return `${p}`;
  return "guest"; // fallback if no phone set yet
}

function cartStorageKey(customerKey: string) {
  return `${CART_PREFIX}${customerKey}`;
}

function readActiveCustomer(): { phone?: string; accessCode?: string } {
  try {
    const raw = localStorage.getItem(ACTIVE_CUSTOMER_KEY);
    if (!raw) return {};
    const parsed = JSON.parse(raw);
    return {
      phone: typeof parsed?.phone === "string" ? parsed.phone : "",
      accessCode: typeof parsed?.accessCode === "string" ? parsed.accessCode : "",
    };
  } catch {
    return {};
  }
}

function writeActiveCustomer(v: { phone?: string; accessCode?: string }) {
  localStorage.setItem(
    ACTIVE_CUSTOMER_KEY,
    JSON.stringify({
      phone: v.phone || "",
      accessCode: v.accessCode || "",
      updatedAt: new Date().toISOString(),
    })
  );
}

function readCartItems(customerKey: string): CartLine[] {
  try {
    const raw = JSON.parse(localStorage.getItem(cartStorageKey(customerKey)) ?? "[]");
    if (!Array.isArray(raw)) return [];
    return raw
      .map((x: any) => ({
        serviceId: String(x?.serviceId || ""),
        qty: Number(x?.qty || 0),
        note: typeof x?.note === "string" ? x.note : "",
      }))
      .filter((x) => x.serviceId && x.qty > 0);
  } catch {
    return [];
  }
}

function writeCartItems(customerKey: string, items: CartLine[]) {
  localStorage.setItem(cartStorageKey(customerKey), JSON.stringify(items));
}

export function CartProvider({ children }: { children: React.ReactNode }) {
  // load last active customer
  const active = readActiveCustomer();
  const [customerKey, setCustomerKey] = useState(() => buildCustomerKey(active.phone, active.accessCode));
  const [items, setItems] = useState<CartLine[]>(() => readCartItems(customerKey));

  // whenever customerKey changes, load that cart
  useEffect(() => {
    setItems(readCartItems(customerKey));
  }, [customerKey]);

  // persist cart changes
  useEffect(() => {
    writeCartItems(customerKey, items);
  }, [customerKey, items]);

  const count = useMemo(() => items.reduce((sum, it) => sum + (Number(it.qty) || 0), 0), [items]);

  const api: CartState = useMemo(
    () => ({
      customerKey,
      items,
      count,
      has: (serviceId: string) => {
        const id = String(serviceId || "");
        if (!id) return false;
        return items.some((x) => x.serviceId === id);
      },

      add: (svc, qty = 1, note) => {
        const id = String((svc as any)?.id || "");
        if (!id) return;

        setItems((prev) => {
          const existing = prev.find((x) => x.serviceId === id);
          if (existing) {
            const next = prev.map((x) =>
              x.serviceId === id
                ? { ...x, qty: Math.max(1, (Number(x.qty) || 0) + Math.max(1, Number(qty) || 1)), note: note ?? x.note }
                : x
            );
            return next;
          }
          return [...prev, { serviceId: id, qty: Math.max(1, Number(qty) || 1), note: note || "" }];
        });
      },

      remove: (serviceId) => {
        const id = String(serviceId || "");
        if (!id) return;
        setItems((prev) => prev.filter((x) => x.serviceId !== id));
      },

      setQty: (serviceId, qty) => {
        const id = String(serviceId || "");
        const q = Math.max(0, Number(qty) || 0);
        setItems((prev) => {
          if (q <= 0) return prev.filter((x) => x.serviceId !== id);
          return prev.map((x) => (x.serviceId === id ? { ...x, qty: q } : x));
        });
      },

      setNote: (serviceId, note) => {
        const id = String(serviceId || "");
        setItems((prev) => prev.map((x) => (x.serviceId === id ? { ...x, note: String(note || "") } : x)));
      },

      clear: () => setItems([]),

      /**
       * Set the current customer identity.
       * Call this when a customer enters phone/accessCode (Schedule or CustomerPortal).
       * This automatically switches the cart to that customer‚Äôs cart.
       */
      setCustomer: ({ phone, accessCode }) => {
        writeActiveCustomer({ phone, accessCode });
        setCustomerKey(buildCustomerKey(phone, accessCode));
      },
    }),
    [customerKey, items, count]
  );

  return <CartCtx.Provider value={api}>{children}</CartCtx.Provider>;
}

export function useCart() {
  const v = useContext(CartCtx);
  if (!v) throw new Error("useCart must be used inside <CartProvider>");
  return v;
}
==== src/pages/Policies.tsx ====

export default function Policies() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>Policies</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            Clear expectations: cancellations, deposits, materials, and safety.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          {[
            ["Scheduling & Arrival", "Arrival windows may vary based on job length and traffic. We confirm before arrival."],
            ["Cancellations", "If you need to reschedule, please do so as early as possible so we can offer that slot to someone else."],
            ["Quotes & Materials", "Quote items depend on measurements, material choice, access, and project scope."],
            ["Safety & Work Area", "Please keep pets secured and the work area accessible for faster completion."],
          ].map(([h, d], idx) => (
            <div key={idx} className="panel" style={{ padding: 14, borderRadius: 14 }}>
              <div style={{ fontWeight: 950 }}>{h}</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
                {d}
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>
  );
}
==== src/pages/CustomerRequestDetail.tsx ====
import { useMemo } from "react";
import { Link, useParams } from "react-router-dom";
import { findRequestById } from "../lib/requestsStore";
import { SERVICES } from "../data/services";
import { ADD_ONS } from "../data/addOns";

function prettyDate(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

function statusLabel(s: string) {
  const low = String(s || "").toLowerCase();
  if (low === "complete") return "Complete";
  if (low === "in_progress") return "In Progress";
  return "New";
}

export default function CustomerRequestDetail() {
  const { id } = useParams();
  const req = useMemo(() => (id ? findRequestById(id) : undefined), [id]);

  const byId = useMemo(() => {
    const all = [...SERVICES, ...ADD_ONS] as any[];
    return new Map(all.map((s) => [String(s.id), s]));
  }, []);

  if (!req) {
    return (
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>Request not found</h2>
        <p className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 720 }}>
          This can happen if the request was cleared from this browser/device.
        </p>
        <Link className="btn btn-primary" to="/customer">Back to Customer Portal</Link>
      </section>
    );
  }

  return (
    <div className="stack" style={{ maxWidth: 1100, margin: "0 auto" }}>
      <section className="panel card" style={{ display: "grid", gap: 10 }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 10, flexWrap: "wrap" }}>
          <div style={{ display: "grid", gap: 4 }}>
            <div className="h2" style={{ margin: 0 }}>Request Details</div>
            <div className="muted" style={{ fontWeight: 850 }}>
              Request #{String(req.id).slice(-8).toUpperCase()} ‚Ä¢ Status: {statusLabel(req.status)}
            </div>
          </div>
          <Link className="btn btn-ghost" to="/customer">Back</Link>
        </div>

        <div
          style={{
            display: "grid",
            gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
            gap: 10,
            marginTop: 6,
          }}
        >
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Customer</div>
            <div style={{ fontWeight: 950, marginTop: 6 }}>{req.customer?.name || "‚Äî"}</div>
            <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>{req.customer?.phone || "‚Äî"}</div>
          </div>

          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Appointment</div>
            <div style={{ fontWeight: 950, marginTop: 6 }}>{prettyDate(req.appointmentStart)}</div>
            <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>Created: {prettyDate(req.createdAt)}</div>
          </div>

          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Address</div>
            <div style={{ fontWeight: 950, marginTop: 6 }}>{req.customer?.address || "‚Äî"}</div>
          </div>
        </div>

        {req.customer?.notes ? (
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Notes</div>
            <div className="body" style={{ marginTop: 6 }}>{req.customer.notes}</div>
          </div>
        ) : null}
      </section>

      <section className="panel card" style={{ display: "grid", gap: 10 }}>
        <div className="h3" style={{ margin: 0 }}>Selected Items</div>

        <div style={{ display: "grid", gap: 10 }}>
          {(req.items || []).map((it, idx) => {
            const svc: any = byId.get(String(it.serviceId));
            const name = svc?.name ?? it.serviceId;
            const isAddOn = Boolean(svc?.isAddOn);
            return (
              <article key={idx} className="panel" style={{ padding: 12, borderRadius: 14 }}>
                <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
                  <div style={{ display: "grid", gap: 4 }}>
                    <div style={{ fontWeight: 950, color: "#0f172a" }}>
                      {isAddOn ? `Add-on: ${name}` : name}
                    </div>
                    <div className="muted" style={{ fontWeight: 850 }}>
                      {svc?.category ?? (isAddOn ? "Add-Ons" : "Service")}
                    </div>
                  </div>
                  <div className="row" style={{ gap: 10 }}>
                    <span className="badge">Qty: {it.qty ?? 1}</span>
                  </div>
                </div>

                {it.note ? (
                  <div className="muted" style={{ marginTop: 8, fontWeight: 850 }}>
                    Note: {it.note}
                  </div>
                ) : null}
              </article>
            );
          })}
        </div>
      </section>

      {(req.photos || []).length > 0 ? (
        <section className="panel card" style={{ display: "grid", gap: 10 }}>
          <div className="h3" style={{ margin: 0 }}>Photos</div>
          <div
            style={{
              display: "grid",
              gridTemplateColumns: "repeat(auto-fit, minmax(180px, 1fr))",
              gap: 10,
            }}
          >
            {req.photos.map((ph, i) => (
              <div key={i} className="panel" style={{ padding: 10, borderRadius: 14 }}>
                <div style={{ borderRadius: 12, overflow: "hidden" }}>
                  <img src={ph.dataUrl} alt={ph.name} style={{ width: "100%", height: 160, objectFit: "cover", display: "block" }} />
                </div>
                <div className="muted" style={{ fontWeight: 850, marginTop: 8, fontSize: 12, wordBreak: "break-word" }}>
                  {ph.name}
                </div>
              </div>
            ))}
          </div>
        </section>
      ) : null}
    </div>
  );
}
==== src/pages/CustomerPortal.tsx ====
import { useMemo, useState } from "react";
import { Link } from "react-router-dom";
import { findRequestsByNameAndPhone, findRequestsByPhoneAndCode, type RVRequest } from "../lib/requestsStore";
import { useCart } from "../data/requestCart";

function normalizePhone(p: string) {
  return String(p || "").replace(/\D+/g, "");
}

function prettyDate(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

function statusLabel(s: string) {
  const low = String(s || "").toLowerCase();
  if (low === "complete") return "Complete";
  if (low === "in_progress") return "In Progress";
  return "New";
}

export default function CustomerPortal() {
  const cart = useCart();

  async function copyText(text: string) {
    const v = String(text || "").trim();
    if (!v) return;
    try {
      await navigator.clipboard.writeText(v);
      alert(`Copied: ${v}`);
    } catch {
      // Fallback for older browsers
      const ta = document.createElement("textarea");
      ta.value = v;
      ta.style.position = "fixed";
      ta.style.left = "-9999px";
      document.body.appendChild(ta);
      ta.focus();
      ta.select();
      try {
        document.execCommand("copy");
        alert(`Copied: ${v}`);
      } finally {
        document.body.removeChild(ta);
      }
    }
  }

  const [phone, setPhone] = useState("");
  const [showRetrieve, setShowRetrieve] = useState(false);
  const [retrieveName, setRetrieveName] = useState("");
  const [retrievePhone, setRetrievePhone] = useState("");
  const [code, setCode] = useState("");

  const retrieveMatches = useMemo(() => {
    const n = String(retrieveName || "").trim();
    const p = String(retrievePhone || "").trim();
    if (!n || p.length < 7) return [];
    return findRequestsByNameAndPhone(n, p).sort((a, b) => (b.createdAt || "").localeCompare(a.createdAt || ""));
  }, [retrieveName, retrievePhone]);
  const [searched, setSearched] = useState(false);

  const matches: RVRequest[] = useMemo(() => {
    const p = normalizePhone(phone);
    if (!p) return [];
    return findRequestsByPhoneAndCode(p, code)
      .sort((a, b) => (b.createdAt || "").localeCompare(a.createdAt || ""));
  }, [phone, code]);

  return (
    <div className="stack">
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>Customer Portal</h2>
        <p className="muted" style={{ fontWeight: 850, maxWidth: 720, textAlign: "center" }}>
          Enter the phone number used on your request and your Access Code (shown after submitting) to view your requests on this device/browser.
        </p>

        <div style={{ width: "100%", maxWidth: 520, display: "grid", gap: 10 }}>
          <label style={{ display: "grid", gap: 6 }}>
            <span className="label">Phone Number</span>
            <input
              className="input"
              value={phone}
              onChange={(e) => setPhone(e.target.value)}
              placeholder="(555) 123-4567"
              inputMode="tel"
            />
          </label>

          <label style={{ display: "grid", gap: 6 }}>
            <span className="label">Access Code</span>
            <input
              className="input"
              value={code}
              onChange={(e) => setCode(e.target.value)}
              placeholder="6-digit code"
              inputMode="numeric"
            />
          </label>

          <button
            className="btn btn-primary"
            onClick={() => {
              cart.setCustomer({ phone, accessCode: code });
              setSearched(true);
            }}
            disabled={normalizePhone(phone).length < 10 || String(code).trim().length < 6}
          >
            Find My Requests
          </button>
          <div style={{ display: "grid", gap: 10, marginTop: 12 }}>
            <button
              type="button"
              className="btn btn-ghost"
              onClick={() => setShowRetrieve((v) => !v)}
              style={{ width: "fit-content" }}
            >
              {showRetrieve ? "Hide" : "Forgot Access Code?"}
            </button>

            {showRetrieve && (
              <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
                <div style={{ fontWeight: 950, color: "#0f172a" }}>Retrieve Access Code</div>
                <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                  Enter the same name + phone used on the request. (Works on this device/browser until Firebase is connected.)
                </div>

                <div style={{ display: "grid", gap: 10, marginTop: 12 }}>
                  <label style={{ display: "grid", gap: 6 }}>
                    <span className="label">Full Name</span>
                    <input
                      className="input"
                      value={retrieveName}
                      onChange={(e) => setRetrieveName(e.target.value)}
                      placeholder="First Last"
                      autoComplete="name"
                    />
                  </label>

                  <label style={{ display: "grid", gap: 6 }}>
                    <span className="label">Phone Number</span>
                    <input
                      className="input"
                      value={retrievePhone}
                      onChange={(e) => setRetrievePhone(e.target.value)}
                      placeholder="(555) 555-5555"
                      inputMode="tel"
                      autoComplete="tel"
                    />
                  </label>

                  {retrieveMatches.length === 0 ? (
                    <div className="muted" style={{ fontWeight: 850 }}>
                      No matching requests found yet.
                    </div>
                  ) : (
                    <div style={{ display: "grid", gap: 10 }}>
                      {retrieveMatches.slice(0, 6).map((r) => (
                        <div key={String(r.id)} className="panel" style={{ padding: 12, borderRadius: 14 }}>
                          <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
                            <div style={{ fontWeight: 950, color: "#0f172a" }}>
                              Request: {String(r.id)}
                            </div>
                            <button
                              type="button"
                              className="badge"
                              onClick={() => copyText(String((r as any).accessCode || ""))}
                              title="Click to copy"
                              style={{
                                cursor: "pointer",
                                justifyContent: "center",
                                border: "1px solid rgba(2,6,23,0.14)",
                              }}
                            >
                              Code: {String((r as any).accessCode || "‚Äî")}
                            </button>
                          </div>
                          <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                            Created: {String(r.createdAt || "‚Äî")}
                          </div>
                        </div>
                      ))}
                      <div className="muted" style={{ fontWeight: 850 }}>
                        Tip: Copy the code above and use it in the main search (Phone + Access Code).
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}
          </div>


          <div className="muted" style={{ fontWeight: 850, textAlign: "center" }}>
            Tip: Your Access Code appears on the confirmation screen after you submit a request‚Äîsave it. This portal works on the same device/browser until Firebase is connected.
          </div>
        </div>
      </section>

      {searched && (
        <section className="stack" style={{ maxWidth: 1100, margin: "0 auto", width: "100%" }}>
          {matches.length === 0 ? (
            <div className="panel card card-center">
              <div className="h3" style={{ margin: 0 }}>No requests found</div>
              <div className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 700 }}>
                If you submitted a request on a different device/browser, it won't appear here yet.
              </div>
              <Link className="btn btn-ghost" to="/services">Browse Services</Link>
            </div>
          ) : (
            <div className="stack">
              <div className="row" style={{ justifyContent: "space-between", flexWrap: "wrap", gap: 10 }}>
                <div>
                  <div className="h3" style={{ margin: 0 }}>Your Requests</div>
                  <div className="muted" style={{ fontWeight: 850 }}>
                    Found {matches.length} request{matches.length === 1 ? "" : "s"} for {phone}
                  </div>
                </div>
              </div>

              <div className="stack">
                {matches.map((r) => (
                  <article key={r.id} className="panel card" style={{ display: "grid", gap: 10 }}>
                    <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 10, flexWrap: "wrap" }}>
                      <div style={{ display: "grid", gap: 4 }}>
                        <div style={{ fontWeight: 950, color: "#0f172a" }}>
                          Request #{String(r.id).slice(-8).toUpperCase()}
                        </div>
                        <div className="muted" style={{ fontWeight: 850 }}>
                          Created: {prettyDate(r.createdAt)} ‚Ä¢ Appointment: {prettyDate(r.appointmentStart)}
                        </div>
                      </div>

                      <div className="row" style={{ gap: 10, alignItems: "center" }}>
                        <span className="badge" style={{ fontWeight: 950 }}>Status: {statusLabel(r.status)}</span>
                        <Link className="btn btn-primary" to={`/customer/requests/${r.id}`}>
                          View Details
                        </Link>
                      </div>
                    </div>

                    <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
                      <span className="badge">Items: {r.items?.length ?? 0}</span>
                      {r.customer?.address ? <span className="badge">Address: {r.customer.address}</span> : null}
                    </div>
                  </article>
                ))}
              </div>
            </div>
          )}
        </section>
      )}
    </div>
  );
}
==== src/pages/BuildDesigner.tsx ====
import { useMemo, useState } from "react";
import { createDraftBuild, type BuildOptions, type BuildDims } from "../lib/buildsStore";

function num(v: any, fallback: number) {
  const n = Number(v);
  return Number.isFinite(n) ? n : fallback;
}

export default function BuildDesigner() {
  const [customerName, setCustomerName] = useState("");
  const [customerPhone, setCustomerPhone] = useState("");
  const [customerEmail, setCustomerEmail] = useState("");
  const [customerAddress, setCustomerAddress] = useState("");

  const [type, setType] = useState("Table");
  const [lengthIn, setLengthIn] = useState(60);
  const [widthIn, setWidthIn] = useState(30);
  const [heightIn, setHeightIn] = useState(30);
  const [topThicknessIn, setTopThicknessIn] = useState(1.5);

  const [woodSpecies, setWoodSpecies] = useState<BuildOptions["woodSpecies"]>("Pine");
  const [finish, setFinish] = useState<BuildOptions["finish"]>("Natural");
  const [joinery, setJoinery] = useState<BuildOptions["joinery"]>("Pocket Holes");

  const [notes, setNotes] = useState("");

  const dims: BuildDims = useMemo(
    () => ({
      lengthIn: Math.max(12, num(lengthIn, 60)),
      widthIn: Math.max(10, num(widthIn, 30)),
      heightIn: Math.max(10, num(heightIn, 30)),
      topThicknessIn: Math.max(0.5, num(topThicknessIn, 1.5)),
    }),
    [lengthIn, widthIn, heightIn, topThicknessIn]
  );

  const options: BuildOptions = useMemo(
    () => ({ woodSpecies, finish, joinery }),
    [woodSpecies, finish, joinery]
  );

  function onStart() {
    if (!customerName.trim() || !customerPhone.trim() || !customerEmail.trim()) {
      alert("Please enter name, phone, and email.");
      return;
    }

    const draft = createDraftBuild({
      customer: {
        name: customerName.trim(),
        phone: customerPhone.trim(),
        email: customerEmail.trim(),
        address: customerAddress.trim() || "",
      },
      type,
      dims,
      options,
      notes,
    });

    window.location.href = `/builds/${draft.id}`;
  }

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 980, margin: "0 auto", padding: 18 }}>
        <h1 className="h2" style={{ margin: 0, fontWeight: 950 }}>Start a Custom Build</h1>
        <p className="lead" style={{ maxWidth: 820 }}>
          Fill in your project details. On the next screen you‚Äôll see 3D render previews + estimate boxes update as each view completes.
        </p>

        <div className="panel" style={{ padding: 14, borderRadius: 14, width: "100%", maxWidth: 860 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Contact Info (required)</div>
          <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
            <input className="field" placeholder="Full Name" value={customerName} onChange={(e) => setCustomerName(e.target.value)} />
            <input className="field" placeholder="Phone Number" value={customerPhone} onChange={(e) => setCustomerPhone(e.target.value)} />
            <input className="field" placeholder="Email" value={customerEmail} onChange={(e) => setCustomerEmail(e.target.value)} />
            <input className="field" placeholder="Address (optional)" value={customerAddress} onChange={(e) => setCustomerAddress(e.target.value)} />
          </div>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, width: "100%", maxWidth: 860 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Project Basics</div>

          <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
            <label style={{ display: "grid", gap: 6 }}>
              <span className="label">Project Type</span>
              <select className="field" value={type} onChange={(e) => setType(e.target.value)}>
                <option>Table</option>
                <option>Bench</option>
                <option>Shelf</option>
                <option>Cabinet</option>
                <option>Planter Box</option>
                <option>Workbench</option>
              </select>
            </label>

            <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 160 }}>
                <span className="label">Length (in)</span>
                <input className="field" inputMode="numeric" value={lengthIn} onChange={(e) => setLengthIn(Number(e.target.value))} />
              </label>
              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 160 }}>
                <span className="label">Width (in)</span>
                <input className="field" inputMode="numeric" value={widthIn} onChange={(e) => setWidthIn(Number(e.target.value))} />
              </label>
              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 160 }}>
                <span className="label">Height (in)</span>
                <input className="field" inputMode="numeric" value={heightIn} onChange={(e) => setHeightIn(Number(e.target.value))} />
              </label>
              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 160 }}>
                <span className="label">Top thickness (in)</span>
                <input className="field" inputMode="decimal" value={topThicknessIn} onChange={(e) => setTopThicknessIn(Number(e.target.value))} />
              </label>
            </div>

            <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 220 }}>
                <span className="label">Wood Species</span>
                <select className="field" value={woodSpecies} onChange={(e) => setWoodSpecies(e.target.value as any)}>
                  <option value="Pine">Pine</option>
                  <option value="Poplar">Poplar</option>
                  <option value="Plywood">Plywood</option>
                  <option value="Oak">Oak</option>
                  <option value="Maple">Maple</option>
                  <option value="Walnut">Walnut</option>
                </select>
              </label>

              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 220 }}>
                <span className="label">Finish</span>
                <select className="field" value={finish} onChange={(e) => setFinish(e.target.value as any)}>
                  <option value="Natural">Natural</option>
                  <option value="Stain">Stain</option>
                  <option value="Paint">Paint</option>
                  <option value="Poly">Poly</option>
                </select>
              </label>

              <label style={{ display: "grid", gap: 6, flex: 1, minWidth: 220 }}>
                <span className="label">Joinery Preference</span>
                <select className="field" value={joinery} onChange={(e) => setJoinery(e.target.value as any)}>
                  <option value="Screws">Screws</option>
                  <option value="Pocket Holes">Pocket Holes</option>
                  <option value="Dowels">Dowels</option>
                  <option value="Mortise & Tenon">Mortise & Tenon</option>
                </select>
              </label>
            </div>

            <label style={{ display: "grid", gap: 6 }}>
              <span className="label">Notes / Special Requests</span>
              <textarea className="field" rows={4} value={notes} onChange={(e) => setNotes(e.target.value)} placeholder="Example: tapered legs, lower shelf, rounded corners, hidden fasteners, etc." />
            </label>

            <button className="btn btn-primary" onClick={onStart} style={{ fontWeight: 950 }}>
              Generate Render Previews ‚Üí
            </button>

            <div className="muted" style={{ fontWeight: 850 }}>
              You‚Äôll receive an Access Code after submission to view your build in the Build Portal.
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/Requests.tsx ====
import { useEffect, useMemo, useState } from "react";
import { Link } from "react-router-dom";

type CartItem = { serviceId: string; qty: number; note: string };

type RequestRecord = {
  id?: string;
  createdAt: string;
  appointmentStart: string;
  customer: { name: string; phone: string; address?: string; notes?: string };
  items: CartItem[];
  status?: "new" | "in_progress" | "complete";
};

const KEY = "rv_requests";

function safeStatus(s: any): "new" | "in_progress" | "complete" {
  if (s === "in_progress" || s === "complete" || s === "new") return s;
  return "new";
}

function badgeStyle(status: string) {
  if (status === "complete")
    return { background: "rgba(34,197,94,0.12)", color: "#14532d", border: "1px solid rgba(34,197,94,0.20)" };
  if (status === "in_progress")
    return { background: "rgba(14,165,233,0.12)", color: "#0c4a6e", border: "1px solid rgba(14,165,233,0.20)" };
  return { background: "rgba(245,158,11,0.14)", color: "#7c2d12", border: "1px solid rgba(245,158,11,0.22)" };
}

function fmt(dtIso: string) {
  const d = new Date(dtIso);
  if (Number.isNaN(d.getTime())) return dtIso;
  return d.toLocaleString();
}

function readRequests(): RequestRecord[] {
  try {
    const raw = JSON.parse(localStorage.getItem(KEY) ?? "[]");
    return (Array.isArray(raw) ? raw : []).map((r: any) => ({ ...r, status: safeStatus(r?.status) }));
  } catch (e) {
    return [];
  }
}

export default function Requests() {
  const [reqs, setReqs] = useState<RequestRecord[]>([]);
  const [q, setQ] = useState("");

  function refresh() {
    setReqs(readRequests());
  }

  useEffect(() => {
    refresh();
  }, []);

  const filtered = useMemo(() => {
    const term = q.trim().toLowerCase();
    if (!term) return reqs;

    return reqs.filter((r) => {
      const hay = [
        r.id,
        r.createdAt,
        r.appointmentStart,
        r.customer?.name,
        r.customer?.phone,
        r.customer?.address,
        r.customer?.notes,
        safeStatus(r.status),
        ...(r.items ?? []).map((i) => i.serviceId),
      ]
        .filter(Boolean)
        .join(" ")
        .toLowerCase();

      return hay.includes(term);
    });
  }, [reqs, q]);

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto", padding: 18 }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 10, flexWrap: "wrap" }}>
          <div style={{ display: "grid", gap: 6 }}>
            <h1 className="h2" style={{ margin: 0, fontWeight: 950 }}>My Requests</h1>
            <div className="muted" style={{ fontWeight: 850 }}>
              Track your request status: <strong>New</strong> ‚Üí <strong>In Progress</strong> ‚Üí <strong>Complete</strong>
            </div>
          </div>

          <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
            <button className="btn btn-ghost" onClick={refresh} style={{ fontWeight: 900 }}>Refresh</button>
            <Link className="btn btn-primary" to="/schedule" style={{ fontWeight: 950 }}>New Request</Link>
          </div>
        </div>

        <div className="row" style={{ gap: 10, flexWrap: "wrap", marginTop: 12 }}>
          <input
            className="field"
            style={{ flex: 1, minWidth: 240 }}
            value={q}
            onChange={(e) => setQ(e.target.value)}
            placeholder="Search name, phone, service‚Ä¶"
          />
          <span className="badge" style={{ justifyContent: "center" }}>Total: {filtered.length}</span>
        </div>
      </section>

      <section className="stack" style={{ maxWidth: 1100, margin: "0 auto" }}>
        {filtered.length === 0 ? (
          <div className="panel card card-center" style={{ padding: 18 }}>
            <h3 className="h3">No requests yet</h3>
            <p className="body" style={{ maxWidth: 760 }}>
              Submit a request from the Schedule page and it will show up here.
            </p>
            <Link className="btn btn-primary" to="/services" style={{ fontWeight: 950 }}>Browse Services</Link>
          </div>
        ) : (
          filtered
            .slice()
            .sort((a, b) => String(b?.createdAt || "").localeCompare(String(a?.createdAt || "")))
            .map((r, idx) => {
              const st = safeStatus(r.status);
              const rid = r.id ?? r.createdAt ?? `req-${idx}`;
              const items = r.items ?? [];

              return (
                <article key={rid} className="panel card" style={{ padding: 16 }}>
                  <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start", gap: 10, flexWrap: "wrap" }}>
                    <div style={{ display: "grid", gap: 6 }}>
                      <div style={{ fontWeight: 950, color: "#0f172a" }}>
                        Request <span className="badge" style={{ marginLeft: 8, fontSize: 12 }}>{rid}</span>
                        <span className="badge" style={{ marginLeft: 8, ...badgeStyle(st) }}>
                          {st.replace("_", " ").toUpperCase()}
                        </span>
                      </div>

                      <div className="muted" style={{ fontWeight: 850 }}>
                        Requested: {fmt(r.appointmentStart)} ¬∑ Submitted: {fmt(r.createdAt)}
                      </div>

                      <div className="muted" style={{ fontWeight: 850 }}>
                        Customer: <strong>{r.customer?.name || "‚Äî"}</strong> ¬∑ {r.customer?.phone || "‚Äî"}
                      </div>
                    </div>

                    <Link
                      to={`/request-confirmed/${rid}`}
                      className="btn btn-primary"
                      style={{ fontWeight: 950 }}
                    >
                      View Details ‚Üí
                    </Link>
                  </div>

                  <div style={{ marginTop: 10, display: "grid", gap: 6 }}>
                    {items.map((it, j) => (
                      <div key={j} className="muted" style={{ fontWeight: 900 }}>
                        ‚Ä¢ {it.serviceId} {it.qty ? `√ó ${it.qty}` : ""}{it.note ? ` ‚Äî ${it.note}` : ""}
                      </div>
                    ))}
                  </div>
                </article>
              );
            })
        )}
      </section>
    </div>
  );
}
==== src/pages/staylit/StayLitCreate.tsx ====
import { useMemo, useState } from "react";
import {
  STAY_LIT_CUSTOM_BASE_PRICE,
  STAY_LIT_JARS,
  STAY_LIT_SCENTS,
  STAY_LIT_WICKS,
} from "../../data/staylitCatalog";

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

export default function StayLitCreate() {
  const [scentId, setScentId] = useState(STAY_LIT_SCENTS[0]?.id ?? "");
  const [jarId, setJarId] = useState(STAY_LIT_JARS[0]?.id ?? "");
  const [wickId, setWickId] = useState(STAY_LIT_WICKS[0]?.id ?? "");

  const selected = useMemo(() => {
    const scent = STAY_LIT_SCENTS.find((x) => x.id === scentId);
    const jar = STAY_LIT_JARS.find((x) => x.id === jarId);
    const wick = STAY_LIT_WICKS.find((x) => x.id === wickId);

    const price =
      STAY_LIT_CUSTOM_BASE_PRICE +
      (scent?.priceDelta ?? 0) +
      (jar?.priceDelta ?? 0) +
      (wick?.priceDelta ?? 0);

    return { scent, jar, wick, price };
  }, [scentId, jarId, wickId]);

  const summary = useMemo(() => {
    const s = selected.scent?.name ?? "‚Äî";
    const j = selected.jar?.name ?? "‚Äî";
    const w = selected.wick?.name ?? "‚Äî";
    return `Custom Candle: ${s} ‚Ä¢ ${j} ‚Ä¢ ${w}`;
  }, [selected.scent?.name, selected.jar?.name, selected.wick?.name]);

  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section className="panel card card-center" style={{ textAlign: "center" }}>
        <div className="badge" style={{ width: "fit-content" }}>Stay Lit Candle Co.</div>
        <h1 className="h2" style={{ margin: 0 }}>Create Your Own Candle</h1>
        <div className="muted" style={{ fontWeight: 850, maxWidth: 860 }}>
          Select a Scent, Jar Type, and Wick Type. Pricing updates automatically.
        </div>
        <div className="row" style={{ justifyContent: "center", gap: 10, flexWrap: "wrap" }}>
          <a className="btn btn-ghost" href="/staylit">‚Üê Back to Stay Lit</a>
          <a className="btn btn-ghost" href="/staylit/shop">Shop Pre-Made</a>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          maxWidth: 980,
          margin: "0 auto",
          width: "100%",
          display: "grid",
          gap: 14,
}}
      >
        <div className="card-center" style={{ textAlign: "center", gap: 8 }}>
          <div className="badge" style={{ width: "fit-content" }}>Custom Builder</div>
          <div style={{ fontWeight: 950, fontSize: 18 }}>{summary}</div>
          <div className="badge rate-bright" style={{ width: "fit-content", fontWeight: 950 }}>
            Estimated Price: {money(selected.price)}
          </div>
          <div className="muted" style={{ fontWeight: 850 }}>
            Final price may vary for special requests, bulk orders, or custom labeling.
          </div>
        </div>

        <div
          style={{
            display: "grid",
            gridTemplateColumns: "repeat(auto-fit, minmax(240px, 1fr))",
            gap: 12,
            alignItems: "start",
          }}
        >
          {/* Scent */}
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Scent</div>
            <select
              value={scentId}
              onChange={(e) => setScentId(e.target.value)}
              style={{ width: "100%", marginTop: 8, padding: 10, borderRadius: 12 }}
            >
              {STAY_LIT_SCENTS.map((o) => (
                <option key={o.id} value={o.id}>
                  {o.name}{o.priceDelta ? ` (+${money(o.priceDelta)})` : ""}
                </option>
              ))}
            </select>
            <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
              Choose your primary scent profile.
            </div>
          </div>

          {/* Jar */}
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Jar Type</div>
            <select
              value={jarId}
              onChange={(e) => setJarId(e.target.value)}
              style={{ width: "100%", marginTop: 8, padding: 10, borderRadius: 12 }}
            >
              {STAY_LIT_JARS.map((o) => (
                <option key={o.id} value={o.id}>
                  {o.name}{typeof o.priceDelta === "number" && o.priceDelta !== 0 ? ` (${o.priceDelta > 0 ? "+" : ""}${money(o.priceDelta)})` : ""}
                </option>
              ))}
            </select>
            <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
              {selected.jar?.note ?? "Pick the style you want."}
            </div>
          </div>

          {/* Wick */}
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="label">Wick Type</div>
            <select
              value={wickId}
              onChange={(e) => setWickId(e.target.value)}
              style={{ width: "100%", marginTop: 8, padding: 10, borderRadius: 12 }}
            >
              {STAY_LIT_WICKS.map((o) => (
                <option key={o.id} value={o.id}>
                  {o.name}{o.priceDelta ? ` (+${money(o.priceDelta)})` : ""}
                </option>
              ))}
            </select>
            <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
              {selected.wick?.note ?? "Select your burn style."}
            </div>
          </div>
        </div>

        <div className="row" style={{ justifyContent: "center", gap: 10, flexWrap: "wrap" }}>
          <a
            className="btn btn-primary"
            href={`/contact?staylit=custom&scent=${encodeURIComponent(scentId)}&jar=${encodeURIComponent(jarId)}&wick=${encodeURIComponent(wickId)}`}
          >
            Request This Custom Candle
          </a>
        </div>
      </section>
    </div>
  );
}
==== src/pages/staylit/StayLitPolicies.tsx ====

export default function StayLitPolicies() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          textAlign: "center",
          background: "rgba(10,10,15,0.78)",
          border: "1px solid rgba(148,163,184,0.15)",
          boxShadow: "0 0 24px rgba(59,130,246,0.25)",
        }}
      >
        <div className="card-center" style={{ gap: 10 }}>
          <div className="badge" style={{ width: "fit-content" }}>Stay Lit Candle Co.</div>
          <h1 className="h2" style={{ margin: 0, color: "#f8fafc" }}>Policies</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 900, color: "#cbd5f5" }}>
            Shipping, returns, and custom order expectations.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(15,23,42,0.70)",
          border: "1px solid rgba(148,163,184,0.15)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          {[
            ["Processing time", "Pre-made candles typically ship quickly. Custom builds may take longer depending on volume."],
            ["Returns", "If an item arrives damaged, contact us with photos and we‚Äôll make it right."],
            ["Custom items", "Custom candles are made to order. Scent/jar/wick selections should be reviewed carefully."],
            ["Safety", "Never leave a candle unattended. Keep away from children/pets and flammable materials."],
          ].map(([h, d], idx) => (
            <div key={idx} className="panel" style={{ padding: 14, borderRadius: 14 }}>
              <div style={{ fontWeight: 950, color: "#f8fafc" }}>{h}</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, color: "#c7d2fe", lineHeight: 1.6 }}>
                {d}
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>
  );
}
==== src/pages/staylit/StayLitShop.tsx ====
import { STAY_LIT_PRODUCTS } from "../../data/staylitCatalog";

export default function StayLitShop() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section className="panel card card-center" style={{ textAlign: "center" }}>
        <div className="badge" style={{ width: "fit-content" }}>Stay Lit Candle Co.</div>
        <h1 className="h2" style={{ margin: 0 }}>Shop Pre-Made Candles</h1>
        <div className="muted" style={{ fontWeight: 850, maxWidth: 820 }}>
          Pick a candle below. You can request it from Contact, or we can wire it into checkout later.
        </div>
        <div className="row" style={{ justifyContent: "center", gap: 10, flexWrap: "wrap" }}>
          <a className="btn btn-ghost" href="/staylit">‚Üê Back to Stay Lit</a>
          <a className="btn btn-primary" href="/staylit/create">Create Your Own</a>
        </div>
      </section>

      <section
        style={{
          maxWidth: 1100,
          margin: "0 auto",
          width: "100%",
          display: "grid",
          gridTemplateColumns: "repeat(auto-fit, minmax(260px, 1fr))",
          gap: 16,
        }}
      >
        {STAY_LIT_PRODUCTS.map((c) => (
          <article
            key={c.id}
            className="panel card"
            style={{ display: "grid", gap: 10, textAlign: "center" }}
          >
            <div
              style={{
                height: 180,
                borderRadius: 14,
                background: "rgba(15,23,42,0.55)",
                display: "flex",
                alignItems: "center",
                justifyContent: "center",
                fontWeight: 950,
              }}
            >
              üïØÔ∏è {c.name}
            </div>

            <h3 className="h3" style={{ margin: 0 }}>{c.name}</h3>
            <div className="muted" style={{ fontWeight: 850 }}>{c.scent}</div>
            <div style={{ fontWeight: 950 }}>${c.price} ¬∑ {c.size}</div>
            <div className="muted" style={{ fontWeight: 850 }}>Burn Time: {c.burnTime}</div>
            <div style={{ fontWeight: 850 }}>{c.description}</div>

            <a className="btn btn-primary" href={`/contact?staylit=premade&product=${c.id}`}>
              Request This Candle
            </a>
          </article>
        ))}
      </section>
    </div>
  );
}
==== src/pages/staylit/StayLitAbout.tsx ====

export default function StayLitAbout() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          textAlign: "center",
          background: "rgba(10,10,15,0.78)",
          border: "1px solid rgba(148,163,184,0.15)",
          boxShadow: "0 0 24px rgba(59,130,246,0.25)",
        }}
      >
        <div className="card-center" style={{ gap: 10 }}>
          <div className="badge" style={{ width: "fit-content" }}>Stay Lit Candle Co.</div>
          <h1 className="h2" style={{ margin: 0, color: "#f8fafc" }}>About Stay Lit</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 900, color: "#cbd5f5" }}>
            Urban energy + smooth atmosphere. Hand-poured candles designed for vibe, focus, and relaxation.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(15,23,42,0.70)",
          border: "1px solid rgba(148,163,184,0.15)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950, color: "#f8fafc" }}>Our promise</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850, color: "#c7d2fe", lineHeight: 1.6 }}>
              Clean burn, premium wax, and a solid scent throw. We keep it simple: quality materials and consistent pours.
            </div>
          </div>

          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950, color: "#f8fafc" }}>Create your own</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850, color: "#c7d2fe", lineHeight: 1.6 }}>
              Choose your scent, jar, and wick ‚Äî and you‚Äôll see pricing as you build. Great for gifts and brand scents.
            </div>
          </div>

          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950, color: "#f8fafc" }}>Bulk / events</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850, color: "#c7d2fe", lineHeight: 1.6 }}>
              We can support bulk orders for weddings, events, corporate gifts, and custom label concepts (later upgrade).
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/staylit/StayLitSplash.tsx ====
import logo from "../../assets/staylit-logo.gif";

export default function StayLitSplash() {
  return (
    <div
      style={{
        minHeight: "calc(100vh - 80px)",
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        padding: "24px 16px",
        textAlign: "center",
      }}
    >
      {/* Flicker CSS (inline + guaranteed to load) */}
      <style>{`
        @keyframes slFlameFlicker {
          0%   { transform: translateY(0px)   rotate(-10deg) scale(1.00) translateZ(0); filter: drop-shadow(0 0 10px rgba(251,191,36,0.85)); opacity: .92; }
          12%  { transform: translateY(-4px)  rotate( 12deg) scale(1.18) translateZ(0); filter: drop-shadow(0 0 18px rgba(245,158,11,0.95)); opacity: 1; }
          28%  { transform: translateY(-7px)  rotate( -8deg) scale(1.26) translateZ(0); filter: drop-shadow(0 0 24px rgba(251,146,60,0.95)); opacity: .98; }
          45%  { transform: translateY(-3px)  rotate( 10deg) scale(1.16) translateZ(0); filter: drop-shadow(0 0 16px rgba(253,186,116,0.90)); opacity: 1; }
          63%  { transform: translateY(-9px)  rotate(-12deg) scale(1.30) translateZ(0); filter: drop-shadow(0 0 26px rgba(251,113,133,0.45)); opacity: .92; }
          78%  { transform: translateY(-5px)  rotate(  8deg) scale(1.22) translateZ(0); filter: drop-shadow(0 0 20px rgba(251,191,36,0.95)); opacity: 1; }
          92%  { transform: translateY(-2px)  rotate( -6deg) scale(1.10) translateZ(0); filter: drop-shadow(0 0 14px rgba(253,186,116,0.85)); opacity: .96; }
          100% { transform: translateY(0px)   rotate(-10deg) scale(1.00) translateZ(0); filter: drop-shadow(0 0 10px rgba(251,191,36,0.85)); opacity: .92; }
        }
        .slFlame {
          display: inline-block;
          transform-origin: 50% 85%;
          animation: slFlameFlicker 0.75s infinite;
          will-change: transform, filter, opacity;
        }
        /* A subtle second aura that pulses behind the title */
        @keyframes slAuraPulse {
          0% { opacity: .25; transform: scale(1); }
          50% { opacity: .45; transform: scale(1.06); }
          100% { opacity: .25; transform: scale(1); }
        }
        .slAura {
          position: absolute;
          inset: -10px -18px;
          background: radial-gradient(circle at 50% 40%, rgba(59,130,246,.30), rgba(0,0,0,0) 65%);
          filter: blur(10px);
          animation: slAuraPulse 2.2s ease-in-out infinite;
          pointer-events: none;
        }
      `}</style>

      <div
        className="stack"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          gap: 26,
          justifyItems: "center",
        }}
      >
        {/* HERO */}
        <section
          className="panel card"
          style={{
            width: "100%",
            padding: 32,
            textAlign: "center",
            justifyContent: "center",
            alignItems: "center",
            flexDirection: "column",
            display: "flex",
            background: "rgba(10,10,15,0.75)",
            backdropFilter: "blur(6px)",
            border: "1px solid rgba(148,163,184,0.15)",
            boxShadow: "0 0 30px rgba(59,130,246,0.25)",
          }}
        >
          <div className="card-center" style={{ gap: 16, width: "100%", justifyContent: "center", alignItems: "center" }}>
            {/* LOGO */}
            <img
              src={logo}
              alt="Stay Lit Logo"
              style={{
                width: 92,
                height: 92,
                objectFit: "contain",
                marginBottom: 6,
                filter: "drop-shadow(0 0 16px rgba(59,130,246,0.6))",
              }}
            />

            {/* BRAND TAG */}
            <div
              style={{
                fontWeight: 900,
                letterSpacing: "0.22em",
                fontSize: 12,
                color: "#60a5fa",
                textTransform: "uppercase",
              }}
            >
              Stay Lit Candle Co.
            </div>

            {/* MAIN TITLE */}
            <div style={{ position: "relative", display: "inline-block" }}>
              <div className="slAura" />
              <h1
                style={{
                  margin: 0,
                  fontSize: "clamp(2.2rem, 5vw, 3.2rem)",
                  fontWeight: 950,
                  letterSpacing: "0.04em",
                  background: "linear-gradient(90deg,#ffffff,#93c5fd,#ffffff)",
                  WebkitBackgroundClip: "text",
                  WebkitTextFillColor: "transparent",
                  textShadow: "0 0 20px rgba(147,197,253,0.4)",
                  position: "relative",
                }}
              >
                <span className="slFlame" style={{ fontSize: "1.15em", marginRight: 10, color: "#fbbf24", WebkitTextFillColor: "#fbbf24" }}>üî•</span> STAY LIT
              </h1>
            </div>

            {/* SUBTITLE */}
            <div
              style={{
                fontWeight: 900,
                fontSize: 18,
                letterSpacing: "0.08em",
                color: "#e5e7eb",
              }}
            >
              Urban ‚Ä¢ Luxury ‚Ä¢ Hand-Poured
            </div>

            {/* DESCRIPTION */}
            <div
              style={{
                fontWeight: 800,
                maxWidth: 820,
                color: "#cbd5f5",
                lineHeight: 1.6,
                fontSize: 15,
              }}
            >
              Hand-poured candles built for atmosphere, focus, and relaxation. Choose a ready-to-ship candle ‚Äî or
              design your own with custom scent, jar, and wick.
            </div>

            {/* FEATURES */}
            <div
              style={{
                display: "flex",
                flexWrap: "wrap",
                justifyContent: "center",
                gap: 14,
                fontWeight: 850,
                color: "#93c5fd",
                letterSpacing: "0.05em",
                marginTop: 4,
              }}
            >
              <span>Clean Burn</span>
              <span>‚Ä¢</span>
              <span>Premium Wax</span>
              <span>‚Ä¢</span>
              <span>Long Lasting</span>
            </div>
          </div>
        </section>

        {/* OPTIONS */}
        <section
          style={{
            width: "100%",
            display: "grid",
            gridTemplateColumns: "repeat(auto-fit, minmax(280px, 1fr))",
            gap: 20,
            justifyItems: "center",
          }}
        >
          {/* PREMADE */}
          <article
            className="panel card"
            style={{
              display: "grid",
              gap: 14,
              textAlign: "center",
              padding: 24,
              width: "100%",
              maxWidth: 520,
              background: "rgba(15,23,42,0.7)",
              border: "1px solid rgba(148,163,184,0.15)",
              boxShadow: "0 0 18px rgba(59,130,246,0.2)",
            }}
          >
            <div style={{ fontSize: 46 }}>üïØÔ∏è</div>

            <h2
              style={{
                margin: 0,
                fontWeight: 900,
                letterSpacing: "0.06em",
                color: "#f8fafc",
              }}
            >
              PRE-MADE CANDLES
            </h2>

            <div
              style={{
                fontWeight: 800,
                color: "#c7d2fe",
                lineHeight: 1.5,
              }}
            >
              Ready now. Pick your scent and we‚Äôll handle the rest.
            </div>

            <a className="btn btn-primary" href="/staylit/shop">
              Browse Collection
            </a>
          </article>

          {/* CUSTOM */}
          <article
            className="panel card"
            style={{
              display: "grid",
              gap: 14,
              textAlign: "center",
              padding: 24,
              width: "100%",
              maxWidth: 520,
              background: "rgba(15,23,42,0.7)",
              border: "1px solid rgba(148,163,184,0.15)",
              boxShadow: "0 0 18px rgba(59,130,246,0.2)",
            }}
          >
            <div style={{ fontSize: 46 }}>üß™</div>

            <h2
              style={{
                margin: 0,
                fontWeight: 900,
                letterSpacing: "0.06em",
                color: "#f8fafc",
              }}
            >
              CUSTOM BUILD
            </h2>

            <div
              style={{
                fontWeight: 800,
                color: "#c7d2fe",
                lineHeight: 1.5,
              }}
            >
              Design your own candle. Scent. Jar. Wick. Your style.
            </div>

            <a className="btn btn-primary" href="/staylit/create">
              Build Yours
            </a>
          </article>
        </section>

        {/* FOOTER */}
        <section className="card-center">
          <div
            style={{
              fontWeight: 850,
              maxWidth: 900,
              color: "#94a3b8",
              letterSpacing: "0.04em",
            }}
          >
            Perfect for gifts, events, and branded scents. Bulk orders available.
          </div>
        </section>
      </div>
    </div>
  );
}
==== src/pages/Home.tsx ====
import { Link } from "react-router-dom";
import rvLogo from "../assets/roberts-ventures-logo.png";

export default function Home() {
  return (
    <div className="stack page page-enter" style={{ gap: 18 }}>
      {/* HERO / SPLASH */}
      <section
        className="panel card glow-panel"
        style={{
          padding: 22,
          borderRadius: 18,
          overflow: "hidden",
          position: "relative",
        }}
      >
        {/* Subtle futuristic accent */}
        <div
          aria-hidden
          style={{
            position: "absolute",
            inset: -80,
            background:
              "radial-gradient(circle at 20% 10%, rgba(29,78,216,0.18), transparent 40%), radial-gradient(circle at 90% 30%, rgba(34,197,94,0.14), transparent 45%), radial-gradient(circle at 50% 110%, rgba(245,158,11,0.12), transparent 55%)",
            filter: "blur(2px)",
            pointerEvents: "none",
          }}
        />

        <div style={{ position: "relative", display: "grid", gap: 14, justifyItems: "center", textAlign: "center" }}>
          {/* Logo */}
          <img
            src={rvLogo}
            alt="Roberts Ventures LLC"
            style={{
              width: 92,
              height: 92,
              objectFit: "contain",
              filter: "drop-shadow(0 0 18px rgba(56,189,248,.22))",
              marginTop: 2,
            }}
          />

          <div className="badge" style={{ width: "fit-content" }}>
            Roberts Ventures LLC
          </div>

          <h1
            className="h1"
            style={{
              margin: 0,
              fontWeight: 950,
              letterSpacing: -0.6,
              lineHeight: 1.05,
              color: "var(--head-accent)",
            }}
          >
            Modern home services,
            <br />
            woodworking & projects ‚Äî done right.
          </h1>

          <p
            className="lead"
            style={{
              margin: 0,
              maxWidth: 860,
              fontWeight: 800,
              color: "var(--head-accent)",
              opacity: 0.82,
              lineHeight: 1.35,
            }}
          >
            Pick a service, customize with add-ons, and send a request in minutes. From TV mounting and ceiling fans to
            custom shelving, deck repair, and haul-away.
          </p>

          {/* CTA buttons */}
          <div
            className="row"
            style={{
              gap: 10,
              flexWrap: "wrap",
              marginTop: 4,
              alignItems: "center",
              justifyContent: "center",
            }}
          >
            <Link
              to="/services"
              className="btn btn-primary"
              style={{
                padding: "10px 16px",
                fontWeight: 950,
                boxShadow: "0 10px 26px rgba(29,78,216,0.22)",
              }}
            >
              Browse Services ‚Üí
            </Link>

            <Link
              to="/schedule"
              className="btn btn-ghost"
              style={{
                padding: "10px 16px",
                fontWeight: 950,
              }}
            >
              Schedule / Request
            </Link>

            <Link
              to="/staylit"
              className="btn btn-ghost"
              style={{
                padding: "10px 16px",
                fontWeight: 950,
              }}
            >
              Stay Lit Candle Co. ‚ú®
            </Link>
          </div>

          {/* Quick trust/feature cards */}
          <div
            style={{
              display: "grid",
              gridTemplateColumns: "repeat(auto-fit, minmax(210px, 1fr))",
              gap: 10,
              marginTop: 10,
              width: "100%",
            }}
          >
            <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
              <div style={{ fontWeight: 950, color: "var(--head-accent)" }}>Clear pricing</div>
              <div className="sub-accent" style={{ fontWeight: 850, marginTop: 6 }}>
                Prices shown when fixed/starting ‚Äî quotes when needed.
              </div>
            </div>

            <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
              <div style={{ fontWeight: 950, color: "var(--head-accent)" }}>Fast scheduling</div>
              <div className="sub-accent" style={{ fontWeight: 850, marginTop: 6 }}>
                Select services + add-ons and send your request quickly.
              </div>
            </div>

            <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
              <div style={{ fontWeight: 950, color: "var(--head-accent)" }}>Quality work</div>
              <div className="sub-accent" style={{ fontWeight: 850, marginTop: 6 }}>
                Clean finish, professional approach, and communication.
              </div>
            </div>

            <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
              <div style={{ fontWeight: 950, color: "var(--head-accent)" }}>Stay Lit inside</div>
              <div className="sub-accent" style={{ fontWeight: 850, marginTop: 6 }}>
                Candle business lives inside the Roberts Ventures site.
              </div>
            </div>
          </div>
        </div>
      </section>

      {/* TWO-PANEL SPLASH: Services vs Stay Lit */}
      <section
        style={{
          display: "grid",
          gridTemplateColumns: "repeat(auto-fit, minmax(320px, 1fr))",
          gap: 14,
        }}
      >
        {/* Left: Roberts Ventures */}
        <div
          className="panel card card-center glow-panel"
          style={{
                        padding: 18,
            borderRadius: 18,
            textAlign: "center",
          }}
        >
          <div className="badge" style={{ width: "fit-content" }}>
            Home Services ‚Ä¢ Outdoor ‚Ä¢ Woodworking
          </div>

          <h2 className="h2" style={{ marginTop: 10, marginBottom: 8, fontWeight: 950 }}>
            Book your next project
          </h2>

          <p className="body" style={{ margin: 0, fontWeight: 800, opacity: 0.82, maxWidth: 700 }}>
            <span className="sub-accent">Browse the catalog, pick add-ons (like cable concealment or haul-away),</span> and
            send details so we can confirm and schedule.
          </p>

          <div className="row" style={{ gap: 10, flexWrap: "wrap", marginTop: 14, justifyContent: "center" }}>
            <Link to="/services" className="btn btn-primary" style={{ fontWeight: 950 }}>
              View Catalog
            </Link>
            <Link to="/schedule" className="btn btn-ghost" style={{ fontWeight: 950 }}>
              Go to Schedule
            </Link>
            <Link to="/contact" className="btn btn-ghost" style={{ fontWeight: 950 }}>
              Contact
            </Link>
          </div>
        </div>

        {/* Right: Stay Lit */}
        <div
          className="panel card card-center glow-panel"
          style={{
                        padding: 18,
            borderRadius: 18,
            textAlign: "center",
          }}
        >
          <div className="badge" style={{ width: "fit-content" }}>
            Stay Lit Candle Co.
          </div>

          <h2 className="h2" style={{ marginTop: 10, marginBottom: 8, fontWeight: 950 }}>
            Candles with a vibe
          </h2>

          <p className="body" style={{ margin: 0, fontWeight: 800, opacity: 0.82, maxWidth: 700 }}>
            A dedicated area inside the Roberts Ventures app ‚Äî perfect for future product listings, bundles, and ordering.
          </p>

          <div className="row" style={{ gap: 10, flexWrap: "wrap", marginTop: 14, justifyContent: "center" }}>
            <Link to="/staylit" className="btn btn-primary" style={{ fontWeight: 950 }}>
              Enter Stay Lit
            </Link>
            <Link to="/services" className="btn btn-ghost" style={{ fontWeight: 950 }}>
              Back to Services
            </Link>
          </div>

          <div className="panel" style={{ marginTop: 14, padding: 12, borderRadius: 14 }}>
            <div style={{ fontWeight: 950, color: "var(--head-accent)" }}>Coming soon</div>
            <div className="sub-accent" style={{ fontWeight: 850, marginTop: 6 }}>
              Product grid, scent filters, bundles, gift notes, and checkout.
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/Contact.tsx ====
export default function Contact() {
  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card" style={{ maxWidth: 980, margin: "0 auto", width: "100%" }}>
        <div className="card-center" style={{ gap: 12 }}>
          <h1 className="h2" style={{ margin: 0 }}>Contact</h1>
          <div className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 780 }}>
            Reach out for scheduling, questions, or to request a quote. For fastest service, include photos and a quick description.
          </div>
        </div>

        {/* Contact Info Panel */}
        <div
          className="panel"
          style={{
            marginTop: 16,
            marginBottom: 16,
            padding: 16,
            borderRadius: 16,
            background: "rgba(15,23,42,0.75)",
            border: "1px solid rgba(148,163,184,0.18)",
            boxShadow: "0 0 20px rgba(59,130,246,0.15)",
            textAlign: "center",
          }}
        >
          <div
            style={{
              fontWeight: 950,
              fontSize: 18,
              marginBottom: 10,
              color: "#e2e8f0",
            }}
          >
            ‚ÑπÔ∏è Contact Information
          </div>

          <div
            style={{
              display: "grid",
              gap: 8,
              fontWeight: 850,
              color: "rgba(226,232,240,0.9)",
              justifyItems: "center",
            }}
          >
            <div>üìç <b>Service Area:</b> Local &amp; Surrounding Cities</div>
            <div>‚è± <b>Hours:</b> Mon‚ÄìSat ¬∑ 8:00 AM ‚Äì 6:00 PM</div>
            <div>üìû <b>Phone/Text:</b> (555) 123-4567</div>
            <div>üìß <b>Email:</b> support@robertsventures.com</div>
            <div>‚ö° <b>Response Time:</b> Within 24 Hours</div>
            <div>üìÖ <b>Booking:</b> Appointments Required</div>
          </div>

          <div className="muted" style={{ fontWeight: 850, marginTop: 12 }}>
            Tip: For quotes, include measurements, photos, and your preferred timeframe.
          </div>
        </div>

        {/* Quick Actions */}
        <div
          style={{
            display: "flex",
            gap: 10,
            justifyContent: "center",
            flexWrap: "wrap",
            marginTop: 8,
          }}
        >
          <a className="btn btn-primary" href="/schedule">Schedule a Service</a>
          <a className="btn btn-ghost" href="/services">View Services</a>
          <a className="btn btn-ghost" href="/customer">Customer Portal</a>
        </div>
      </section>
    </div>
  );
}
==== src/pages/admin/AdminBuildDetail.tsx ====
import { useEffect, useMemo, useState } from "react";
import { Link, useParams } from "react-router-dom";
import { getBuild, upsertBuild, removeLastCustomerNote, compileNotes, type BuildSubmission } from "../../lib/buildsStore";
import { estimateBuild } from "../../lib/buildPricing";
import { toast } from "../../lib/toast";

function fmt(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

export default function AdminBuildDetail() {
  const { id } = useParams();
  const [build, setBuild] = useState<BuildSubmission | null>(null);

  useEffect(() => {
    if (!id) return;
    setBuild(getBuild(id));
  }, [id]);

  const v = useMemo(() => build?.versions?.[0] ?? null, [build]);

  if (!build || !v) {
    return (
      <div className="panel card card-center" style={{ maxWidth: 980, margin: "0 auto" }}>
        <h3 className="h3">Build not found</h3>
        <Link className="btn btn-primary" to="/admin/builds">Back</Link>
      </div>
    );
  }

  const b = build;
  const vv = v;

  function setStatus(status: BuildSubmission["status"]) {
    const next: BuildSubmission = { ...b, status, updatedAt: new Date().toISOString() };
    upsertBuild(next);
    setBuild(next);
    toast("Build status updated.", "success", "Saved", 1600);
  }

  function recalcEstimate() {
    const est = estimateBuild(vv.inputsSnapshot.dims, vv.inputsSnapshot.options);

    const nextV = {
      ...vv,
      estimatePublic: {
        total: est.total,
        rangeLow: est.rangeLow,
        rangeHigh: est.rangeHigh,
        materials: est.materials,
        labor: est.labor,
        overhead: est.overhead,
        finish: est.finish,
      },
    };

    const next: BuildSubmission = { ...b, updatedAt: new Date().toISOString(), versions: [nextV, ...b.versions.slice(1)] };
    upsertBuild(next);
    setBuild(next);
    toast("Estimate recalculated.", "success", "Saved", 1600);
  }

  function removeLastCustomerNoteAdmin() {
    if (!confirm("Remove the most recent customer note and regenerate previews?")) return;
    const next = removeLastCustomerNote(b.id);
    if (!next) {
      toast("Could not remove note.", "error", "Error", 1800);
      return;
    }
    setBuild(next);
    toast("Removed last customer note. Previews re-queued.", "success", "Saved", 1800);
  }

  const notesLog = ((vv.inputsSnapshot as any).notesLog || []) as any[];
  const compiledNotes = compileNotes(notesLog, vv.inputsSnapshot.notes);

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto", padding: 18 }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start", gap: 10, flexWrap: "wrap" }}>
          <div style={{ display: "grid", gap: 6 }}>
            <h1 className="h2" style={{ margin: 0 }}>Admin ‚Äî Build Detail</h1>
            <div className="muted" style={{ fontWeight: 850 }}>
              Build: <span className="badge">{String(build.id).slice(-8).toUpperCase()}</span> ‚Ä¢ Created: {fmt(build.createdAt)} ‚Ä¢ Updated: {fmt(build.updatedAt)}
            </div>
            <div className="muted" style={{ fontWeight: 850 }}>
              Customer: <strong>{build.customer?.name || "‚Äî"}</strong> ‚Ä¢ {build.customer?.phone || "‚Äî"} ‚Ä¢ {build.customer?.email || "‚Äî"}
            </div>
            <div className="muted" style={{ fontWeight: 850 }}>
              Type: {build.project?.type || "‚Äî"} ‚Ä¢ Dims: {build.project?.dims?.lengthIn ?? "‚Äî"}√ó{build.project?.dims?.widthIn ?? "‚Äî"}√ó{build.project?.dims?.heightIn ?? "‚Äî"} in
            </div>
          </div>

          <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
            <Link className="btn btn-ghost" to="/admin/builds">Back</Link>
            <Link className="btn btn-ghost" to={`/builds/${build.id}`}>Open customer preview</Link>
          </div>
        </div>

        <div className="row" style={{ gap: 8, flexWrap: "wrap", marginTop: 12, justifyContent: "center" }}>
          <span className="badge" style={{ fontWeight: 950 }}>Status: {String(build.status).toUpperCase()}</span>
          <button className="btn btn-ghost" onClick={() => setStatus("reviewing")}>Reviewing</button>
          <button className="btn btn-ghost" onClick={() => setStatus("quote_sent")}>Quote Sent</button>
          <button className="btn btn-ghost" onClick={() => setStatus("approved")}>Approved</button>
          <button className="btn btn-ghost" onClick={() => setStatus("in_build")}>In Build</button>
          <button className="btn btn-ghost" onClick={() => setStatus("complete")}>Complete</button>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Notes (compiled)</div>
          {compiledNotes ? (
            <div className="muted" style={{ fontWeight: 850, whiteSpace: "pre-wrap", marginTop: 8 }}>{compiledNotes}</div>
          ) : (
            <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>No notes</div>
          )}

          <div className="row" style={{ gap: 10, flexWrap: "wrap", justifyContent: "center", marginTop: 12 }}>
            <button className="btn btn-ghost" onClick={removeLastCustomerNoteAdmin} style={{ fontWeight: 950 }}>
              Remove last customer note
            </button>
          </div>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Public estimate (what customer sees)</div>
          {!v.estimatePublic ? (
            <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
              No estimate saved yet. Click ‚ÄúRecalculate Estimate‚Äù.
            </div>
          ) : (
            <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
              <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
                <span className="badge rate-bright">Total: {money(v.estimatePublic.total)}</span>
                <span className="badge">Range: {money(v.estimatePublic.rangeLow || v.estimatePublic.total)} ‚Äì {money(v.estimatePublic.rangeHigh || v.estimatePublic.total)}</span>
              </div>
              <div className="muted" style={{ fontWeight: 850 }}>
                Materials {money(v.estimatePublic.materials)} ‚Ä¢ Labor {money(v.estimatePublic.labor)} ‚Ä¢ Finish {money(v.estimatePublic.finish)} ‚Ä¢ Overhead {money(v.estimatePublic.overhead)}
              </div>
            </div>
          )}

          <div className="row" style={{ gap: 10, flexWrap: "wrap", justifyContent: "center", marginTop: 12 }}>
            <button className="btn btn-primary" onClick={recalcEstimate}>Recalculate Estimate</button>
          </div>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Renders (latest version)</div>
          <div style={{ marginTop: 10, display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(220px, 1fr))", gap: 10 }}>
            {(v.renders || []).map((r) => (
              <div key={r.renderId} className="panel" style={{ padding: 10, borderRadius: 12 }}>
                <div style={{ fontWeight: 950 }}>{String(r.view).toUpperCase()} <span className="badge" style={{ marginLeft: 8 }}>{String(r.status).toUpperCase()}</span></div>
                <div style={{ marginTop: 8, width: "100%", height: 140, borderRadius: 12, overflow: "hidden", border: "1px solid rgba(15,23,42,0.16)" }}>
                  {r.imageDataUrl ? (
                    <img src={r.imageDataUrl} alt="render" style={{ width: "100%", height: "100%", objectFit: "cover" }} />
                  ) : (
                    <div className="card-center" style={{ width: "100%", height: "100%" }}>
                      <div className="muted" style={{ fontWeight: 850 }}>No image yet</div>
                    </div>
                  )}
                </div>
                <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
                  {r.estimatePublic ? `Render est: ${money(r.estimatePublic.total)}` : "Render est: ‚Äî"}
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/admin/AdminLogin.tsx ====
import { useState } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "../../lib/toast";
import { setAdminAuthed } from "../../components/admin/AdminGuard";

export default function AdminLogin() {
  const nav = useNavigate();
  const [pin, setPin] = useState("");
  const [err, setErr] = useState<string>("");

  const correct = (import.meta as any).env?.VITE_ADMIN_PIN ?? "1234";

  function submit(e: React.FormEvent) {
    e.preventDefault();
    setErr("");

    if (!pin.trim()) {
      setErr("Enter your admin PIN.");
      return;
    }

    if (pin.trim() !== String(correct)) {
      setErr("Incorrect PIN.");
      toast("Incorrect admin PIN.", "error", "Access Denied", 2600);
      return;
    }

    setAdminAuthed(true);
    toast("Welcome back.", "success", "Admin Access", 2200, "Go to Dashboard", "/admin");
    nav("/admin");
  }

  return (
    <div className="stack page">
      <section className="panel card card-center" style={{ maxWidth: 720, margin: "0 auto" }}>
        <h1 className="h2">Admin Login</h1>
        <p className="lead" style={{ maxWidth: 560 }}>
          Enter your admin PIN to access customer requests and manage statuses.
        </p>

        <form onSubmit={submit} style={{ width: "100%", maxWidth: 420, display: "grid", gap: 10 }}>
          <label style={{ display: "grid", gap: 6 }}>
            <span className="label">Admin PIN</span>
            <input
              className="field"
              value={pin}
              onChange={(e) => setPin(e.target.value)}
              placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
              inputMode="numeric"
              autoFocus
            />
          </label>

          {err ? (
            <div
              className="panel"
              style={{
                padding: 10,
                borderRadius: 12,
                border: "1px solid rgba(220,38,38,0.25)",
                background: "rgba(220,38,38,0.08)",
                color: "#7f1d1d",
                fontWeight: 900,
              }}
            >
              {err}
            </div>
          ) : null}

          <button className="btn btn-primary" type="submit">
            Unlock Admin
          </button>

          <button className="btn btn-ghost" type="button" onClick={() => nav("/")}>
            Back to Home
          </button>

          <div className="muted" style={{ fontWeight: 900, marginTop: 8 }}>
            PIN is stored in <code>.env.local</code> as <code>VITE_ADMIN_PIN</code>.
          </div>
        </form>
      </section>
    </div>
  );
}
==== src/pages/admin/AdminDashboard.tsx ====
import { useEffect, useMemo, useState } from "react";
import { toast } from "../../lib/toast";
import { setAdminAuthed } from "../../components/admin/AdminGuard";

type CartItem = { serviceId: string; qty: number; note: string };

type QuoteLine = {
  id: string;
  label: string;
  qty: number;
  unitPrice: number; // dollars
};

type QuoteDraft = {
  lines: QuoteLine[];
  taxRatePct: number; // 0-100
  notes: string;
  createdAt: string;
  updatedAt: string;
  sentAt?: string;
};

type RequestRecord = {
  createdAt: string;
  appointmentStart: string;
  customer: { name: string; phone: string; address?: string; notes?: string };
  items: CartItem[];
  photos?: { name: string; type: string; dataUrl: string }[];
  status?: "new" | "in_progress" | "complete"; // may be missing on older records
  quote?: QuoteDraft;
};

const KEY = "rv_requests";

function safeStatus(s: any): "new" | "in_progress" | "complete" {
  if (s === "in_progress" || s === "complete" || s === "new") return s;
  return "new";
}

function uid() {
  return Math.random().toString(16).slice(2) + Date.now().toString(16);
}

function readRequests(): RequestRecord[] {
  try {
    const raw = JSON.parse(localStorage.getItem(KEY) ?? "[]");
    const arr = Array.isArray(raw) ? raw : [];
    return arr.map((r: any) => ({ ...r, status: safeStatus(r?.status) }));
  } catch {
    return [];
  }
}

function writeRequests(reqs: RequestRecord[]) {
  localStorage.setItem(KEY, JSON.stringify(reqs));
}

function fmt(dtIso: string) {
  const d = new Date(dtIso);
  if (Number.isNaN(d.getTime())) return dtIso;
  return d.toLocaleString();
}

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

function clampNum(x: any, fallback: number) {
  const n = Number(x);
  return Number.isFinite(n) ? n : fallback;
}

function badgeStyle(status: string) {
  if (status === "complete")
    return { background: "rgba(34,197,94,0.12)", color: "#14532d", border: "1px solid rgba(34,197,94,0.20)" };
  if (status === "in_progress")
    return { background: "rgba(14,165,233,0.12)", color: "#0c4a6e", border: "1px solid rgba(14,165,233,0.20)" };
  return { background: "rgba(245,158,11,0.14)", color: "#7c2d12", border: "1px solid rgba(245,158,11,0.22)" };
}

export default function AdminDashboard() {
  const [reqs, setReqs] = useState<RequestRecord[]>([]);
  const [q, setQ] = useState("");
  const [statusFilter, setStatusFilter] = useState<"all" | "new" | "in_progress" | "complete">("all");

  // which request has the quote panel open
  const [openQuoteKey, setOpenQuoteKey] = useState<string | null>(null);

  function refresh() {
    setReqs(readRequests());
  }

  useEffect(() => {
    refresh();
  }, []);

  const filtered = useMemo(() => {
    const term = q.trim().toLowerCase();
    return reqs.filter((r) => {
      const st = safeStatus(r.status);
      if (statusFilter !== "all" && st !== statusFilter) return false;
      if (!term) return true;

      const hay = [
        r.customer?.name,
        r.customer?.phone,
        r.customer?.address,
        r.customer?.notes,
        st,
        r.createdAt,
        r.appointmentStart,
        ...(r.items ?? []).map((i) => i.serviceId),
      ]
        .filter(Boolean)
        .join(" ")
        .toLowerCase();

      return hay.includes(term);
    });
  }, [reqs, q, statusFilter]);

  function updateRequestByIndex(index: number, updater: (r: RequestRecord) => RequestRecord) {
    const next = [...reqs];
    if (!next[index]) return;
    next[index] = updater(next[index]);
    setReqs(next);
    writeRequests(next);
  }

  function setStatus(index: number, status: "new" | "in_progress" | "complete") {
    updateRequestByIndex(index, (r) => ({ ...r, status }));
    toast("Status updated.", "success", "Saved", 1600);
  }

  function clearAll() {
    if (!confirm("Delete ALL saved requests from this browser? This cannot be undone.")) return;
    localStorage.setItem(KEY, "[]");
    refresh();
    toast("All requests cleared (local only).", "warning", "Cleared", 2400);
  }

  function logout() {
    setAdminAuthed(false);
    toast("Logged out.", "info", "Admin", 1600, "Go Home", "/");
    window.location.href = "/";
  }

  // ------------------------
  // Quote builder functions
  // ------------------------
  function ensureQuote(index: number) {
    updateRequestByIndex(index, (r) => {
      if (r.quote) return r;
      const now = new Date().toISOString();
      const seeded: QuoteLine[] = (r.items ?? []).map((it) => ({
        id: uid(),
        label: it.serviceId, // can be swapped to friendly name later
        qty: clampNum(it.qty, 1),
        unitPrice: 0,
      }));
      return {
        ...r,
        quote: {
          lines: seeded,
          taxRatePct: 0,
          notes: "",
          createdAt: now,
          updatedAt: now,
        },
        status: safeStatus(r.status),
      };
    });
  }

  function setQuoteField(index: number, patch: Partial<QuoteDraft>) {
    updateRequestByIndex(index, (r) => {
      const now = new Date().toISOString();
      const qd: QuoteDraft = r.quote ?? { lines: [], taxRatePct: 0, notes: "", createdAt: now, updatedAt: now };
      return { ...r, quote: { ...qd, ...patch, updatedAt: now } };
    });
  }

  function setQuoteLine(index: number, lineId: string, patch: Partial<QuoteLine>) {
    updateRequestByIndex(index, (r) => {
      if (!r.quote) return r;
      const now = new Date().toISOString();
      return {
        ...r,
        quote: {
          ...r.quote,
          updatedAt: now,
          lines: r.quote.lines.map((ln) => (ln.id === lineId ? { ...ln, ...patch } : ln)),
        },
      };
    });
  }

  function addQuoteLine(index: number) {
    updateRequestByIndex(index, (r) => {
      const now = new Date().toISOString();
      const qd = r.quote ?? { lines: [], taxRatePct: 0, notes: "", createdAt: now, updatedAt: now };
      return {
        ...r,
        quote: {
          ...qd,
          updatedAt: now,
          lines: [...qd.lines, { id: uid(), label: "Custom line item", qty: 1, unitPrice: 0 }],
        },
      };
    });
  }

  function removeQuoteLine(index: number, lineId: string) {
    updateRequestByIndex(index, (r) => {
      if (!r.quote) return r;
      const now = new Date().toISOString();
      return { ...r, quote: { ...r.quote, updatedAt: now, lines: r.quote.lines.filter((ln) => ln.id !== lineId) } };
    });
  }

  function calcTotals(qd?: QuoteDraft) {
    const lines = qd?.lines ?? [];
    const subtotal = lines.reduce((sum, ln) => sum + clampNum(ln.qty, 0) * clampNum(ln.unitPrice, 0), 0);
    const taxRate = Math.max(0, Math.min(100, clampNum(qd?.taxRatePct, 0)));
    const tax = subtotal * (taxRate / 100);
    const total = subtotal + tax;
    return { subtotal, taxRate, tax, total };
  }

  function buildQuoteText(r: RequestRecord) {
    const qd = r.quote;
    const { subtotal, taxRate, tax, total } = calcTotals(qd);

    const lines = (qd?.lines ?? []).map((ln) => {
      const lineTotal = clampNum(ln.qty, 0) * clampNum(ln.unitPrice, 0);
      return `- ${ln.label} ‚Äî ${ln.qty} √ó ${money(ln.unitPrice)} = ${money(lineTotal)}`;
    });

    const appt = r.appointmentStart ? fmt(r.appointmentStart) : "‚Äî";

    return [
      `Roberts Ventures LLC ‚Äî Quote`,
      ``,
      `Customer: ${r.customer?.name || "‚Äî"}`,
      `Phone: ${r.customer?.phone || "‚Äî"}`,
      r.customer?.address ? `Address: ${r.customer.address}` : null,
      `Requested Appointment: ${appt}`,
      ``,
      `Line Items:`,
      ...(lines.length ? lines : [`- (No line items yet)`]),
      ``,
      `Subtotal: ${money(subtotal)}`,
      taxRate > 0 ? `Tax (${taxRate}%): ${money(tax)}` : null,
      `Total: ${money(total)}`,
      ``,
      qd?.notes?.trim() ? `Notes: ${qd.notes.trim()}` : null,
      ``,
      `Reply to confirm and we‚Äôll get you scheduled.`,
    ]
      .filter(Boolean)
      .join("\n");
  }

  async function copyQuote(index: number) {
    const r = reqs[index];
    if (!r?.quote) return toast("Create a quote first.", "warning", "No Quote", 1800);
    const text = buildQuoteText(r);
    try {
      await navigator.clipboard.writeText(text);
      toast("Quote copied to clipboard.", "success", "Copied", 1800);
    } catch {
      toast("Clipboard blocked. Select the preview text and copy.", "warning", "Clipboard", 2400);
    }
  }

  function openEmail(index: number) {
    const r = reqs[index];
    if (!r?.quote) return toast("Create a quote first.", "warning", "No Quote", 1800);
    const subject = encodeURIComponent(`Roberts Ventures LLC Quote ‚Äî ${r.customer?.name || "Customer"}`);
    const body = encodeURIComponent(buildQuoteText(r));
    window.location.href = `mailto:?subject=${subject}&body=${body}`;
  }

  function markQuoteSent(index: number) {
    const now = new Date().toISOString();
    updateRequestByIndex(index, (r) => {
      if (!r.quote) return r;
      const st = safeStatus(r.status);
      return {
        ...r,
        status: st === "new" ? "in_progress" : st,
        quote: { ...r.quote, sentAt: now, updatedAt: now },
      };
    });
    toast("Marked quote as sent.", "success", "Saved", 1600);
  }

  // ------------------------
  // Render
  // ------------------------
  return (
    <div className="stack page">
      <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto" }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "center", width: "100%", flexWrap: "wrap", gap: 10 }}>
          <div style={{ display: "grid", gap: 6 }}>
            <h1 className="h2" style={{ margin: 0 }}>Admin Dashboard</h1>
            <div className="muted" style={{ fontWeight: 900 }}>Requests stored locally in this browser (Firebase later).</div>
          </div>

          <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
            <button className="btn btn-ghost" onClick={refresh}>Refresh</button>
            <button className="btn btn-ghost" onClick={clearAll}>Clear All</button>
            <button className="btn btn-primary admin-quote-btn" style={{ boxShadow: "0 8px 22px rgba(29,78,216,0.28)", border: "1px solid rgba(29,78,216,0.35)", fontWeight: 950 }} onClick={logout}>Logout</button>
          </div>
        </div>

        <div className="row" style={{ width: "100%", marginTop: 12, gap: 10, flexWrap: "wrap" }}>
          <input
            className="field"
            style={{ flex: 1, minWidth: 240 }}
            value={q}
            onChange={(e) => setQ(e.target.value)}
            placeholder="Search name, phone, service id, notes‚Ä¶"
          />

          <select
            className="field"
            style={{ width: 220 }}
            value={statusFilter}
            onChange={(e) => setStatusFilter(e.target.value as any)}
          >
            <option value="all">All statuses</option>
            <option value="new">New</option>
            <option value="in_progress">In progress</option>
            <option value="complete">Complete</option>
          </select>

          <span className="badge" style={{ justifyContent: "center" }}>Total: {filtered.length}</span>
        </div>
      </section>

      {filtered.length === 0 ? (
        <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto" }}>
          <h3 className="h3">No requests found</h3>
          <p className="body" style={{ maxWidth: 720 }}>
            If you submitted a request earlier, it‚Äôs stored in <code>localStorage</code> on the same device/browser.
          </p>
        </section>
      ) : (
        <section className="stack" style={{ maxWidth: 1100, margin: "0 auto" }}>
          {filtered.map((r, idx) => {
            const key = (r.createdAt || "x") + ":" + idx;
            const quoteOpen = openQuoteKey === key;
            const st = safeStatus(r.status);
            const totals = calcTotals(r.quote);

            return (
              <article key={key} className="panel card" style={{ padding: 16 }}>
                <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start", gap: 10, flexWrap: "wrap" }}>
                  <div style={{ display: "grid", gap: 6 }}>
                    <div className="h3" style={{ margin: 0 }}>
                      {r.customer?.name || "Customer"}{" "}
                      <span className="badge" style={{ marginLeft: 8, ...badgeStyle(st) }}>
                        {st.replace("_", " ").toUpperCase()}
                      </span>
                    </div>

                    <div className="muted" style={{ fontWeight: 900 }}>
                      Created: {fmt(r.createdAt)} ¬∑ Appointment: {fmt(r.appointmentStart)}
                    </div>

                    <div className="body" style={{ marginTop: 6 }}>
                      <strong>Phone:</strong> {r.customer?.phone || "‚Äî"}{" "}
                      {r.customer?.address ? (
                        <>
                          ¬∑ <strong>Address:</strong> {r.customer.address}
                        </>
                      ) : null}
                    </div>

                    {r.customer?.notes ? (
                      <div className="body" style={{ marginTop: 6 }}>
                        <strong>Notes:</strong> {r.customer.notes}
                      </div>
                    ) : null}
                  </div>

                  <div className="row" style={{ gap: 8, flexWrap: "wrap" }}>
                    <button className="btn btn-ghost" onClick={() => setStatus(idx, "new")}>New</button>
                    <button className="btn btn-ghost" onClick={() => setStatus(idx, "in_progress")}>In Progress</button>
                    <button className="btn btn-ghost" onClick={() => setStatus(idx, "complete")}>Complete</button>

                    <button
                      className="btn btn-primary"
                      onClick={() => {
                        ensureQuote(idx);
                        setOpenQuoteKey((prev) => (prev === key ? null : key));
                      }}
                    >
                      {quoteOpen ? "Close Quote" : "Edit Price / Send Quote"}
                    </button>
                  </div>
                </div>

                <div style={{ marginTop: 14 }}>
                  <div className="label">Requested items</div>
                  <div className="body" style={{ marginTop: 8, display: "grid", gap: 6 }}>
                    {(r.items ?? []).map((it, j) => (
                      <div key={j} className="panel" style={{ padding: 10, borderRadius: 12 }}>
                        <div style={{ fontWeight: 950 }}>
                          {it.serviceId} <span className="muted">¬∑ qty {it.qty}</span>
                        </div>
                        {it.note ? (
                          <div className="muted" style={{ fontWeight: 800, marginTop: 4 }}>
                            {it.note}
                          </div>
                        ) : null}
                      </div>
                    ))}
                  </div>
                </div>

                {quoteOpen ? (
                  <div style={{ marginTop: 16 }} className="panel card">
                    <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start", gap: 10, flexWrap: "wrap" }}>
                      <div style={{ display: "grid", gap: 6 }}>
                        <div className="h3" style={{ margin: 0 }}>Quote Builder</div>
                        <div className="muted" style={{ fontWeight: 900 }}>
                          Edit unit prices, add custom lines, then copy or email the quote.
                        </div>
                      </div>

                      <div className="row" style={{ gap: 8, flexWrap: "wrap" }}>
                        <span className="badge rate-bright" style={{ justifyContent: "center" }}>Subtotal: {money(totals.subtotal)}</span>
                        <span className="badge rate-bright" style={{ justifyContent: "center" }}>Total: {money(totals.total)}</span>
                      </div>
                    </div>

                    <div style={{ marginTop: 12, display: "grid", gap: 10 }}>
                      {(r.quote?.lines ?? []).map((ln) => (
                        <div key={ln.id} className="panel" style={{ padding: 12, borderRadius: 12, display: "grid", gap: 10 }}>
                          <div style={{ display: "grid", gridTemplateColumns: "1fr 110px 140px 90px", gap: 10, alignItems: "center" }}>
                            <input className="field" value={ln.label} onChange={(e) => setQuoteLine(idx, ln.id, { label: e.target.value })} />
                            <input className="field" inputMode="numeric" value={ln.qty} onChange={(e) => setQuoteLine(idx, ln.id, { qty: clampNum(e.target.value, 1) })} />
                            <input className="field" inputMode="decimal" value={ln.unitPrice} onChange={(e) => setQuoteLine(idx, ln.id, { unitPrice: clampNum(e.target.value, 0) })} />
                            <button className="btn btn-ghost" onClick={() => removeQuoteLine(idx, ln.id)}>Remove</button>
                          </div>

                          <div className="muted" style={{ fontWeight: 900 }}>
                            Line total: {money(clampNum(ln.qty, 0) * clampNum(ln.unitPrice, 0))}
                          </div>
                        </div>
                      ))}

                      <div className="row" style={{ justifyContent: "center", gap: 10, flexWrap: "wrap" }}>
                        <button className="btn btn-ghost" onClick={() => addQuoteLine(idx)}>+ Add Custom Line</button>

                        <div className="row" style={{ gap: 8, alignItems: "center" }}>
                          <span className="label">Tax %</span>
                          <input
                            className="field"
                            style={{ width: 120 }}
                            inputMode="decimal"
                            value={r.quote?.taxRatePct ?? 0}
                            onChange={(e) => setQuoteField(idx, { taxRatePct: Math.max(0, Math.min(100, clampNum(e.target.value, 0))) })}
                          />
                        </div>
                      </div>

                      <label style={{ display: "grid", gap: 6 }}>
                        <span className="label">Quote Notes (optional)</span>
                        <textarea
                          className="field"
                          rows={4}
                          value={r.quote?.notes ?? ""}
                          onChange={(e) => setQuoteField(idx, { notes: e.target.value })}
                          placeholder="Example: Price valid for 7 days. Includes standard hardware. Materials not included unless listed above."
                        />
                      </label>

                      <div className="row" style={{ justifyContent: "center", gap: 10, flexWrap: "wrap" }}>
                        <button className="btn btn-primary" onClick={() => copyQuote(idx)}>Copy Quote</button>
                        <button className="btn btn-primary" onClick={() => openEmail(idx)}>Open Email Draft</button>
                        <button className="btn btn-ghost" onClick={() => markQuoteSent(idx)}>Mark Quote Sent</button>
                      </div>

                      <div className="panel" style={{ padding: 12, borderRadius: 12 }}>
                        <div className="label">Preview</div>
                        <pre style={{ marginTop: 10, whiteSpace: "pre-wrap", fontWeight: 800, color: "#0f172a" }}>
{buildQuoteText(r)}
                        </pre>
                      </div>

                      <div className="muted" style={{ fontWeight: 900 }}>
                        {r.quote?.sentAt ? `Quote marked sent: ${fmt(r.quote.sentAt)}` : "Quote not marked as sent yet."}
                      </div>
                    </div>
                  </div>
                ) : null}

                {(r.photos?.length ?? 0) > 0 ? (
                  <div style={{ marginTop: 14 }}>
                    <div className="label">Photos</div>
                    <div style={{ marginTop: 8, display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(140px, 1fr))", gap: 10 }}>
                      {r.photos!.map((p, k) => (
                        <div key={k} className="panel" style={{ padding: 10, borderRadius: 12 }}>
                          <img
                            src={p.dataUrl}
                            alt={p.name}
                            style={{
                              width: "100%",
                              height: 120,
                              objectFit: "cover",
                              borderRadius: 10,
                              border: "1px solid rgba(15,23,42,0.15)",
                            }}
                          />
                          <div className="muted" style={{ fontSize: 11, fontWeight: 900, marginTop: 6, wordBreak: "break-word" }}>
                            {p.name}
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                ) : null}
              </article>
            );
          })}
        </section>
      )}
    </div>
  );
}
==== src/pages/admin/AdminBuilds.tsx ====
import { useEffect, useMemo, useState } from "react";
import { Link } from "react-router-dom";
import { readBuilds, type BuildSubmission } from "../../lib/buildsStore";
import { toast } from "../../lib/toast";

function safe(s: any) {
  return String(s || "").toLowerCase();
}

function fmt(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

export default function AdminBuilds() {
  const [all, setAll] = useState<BuildSubmission[]>([]);
  const [q, setQ] = useState("");

  function refresh() {
    setAll(readBuilds());
  }

  useEffect(() => refresh(), []);

  const filtered = useMemo(() => {
    const term = q.trim().toLowerCase();
    if (!term) return all;
    return all.filter((b) => {
      const hay = [
        b.id,
        b.status,
        b.createdAt,
        b.updatedAt,
        b.customer?.name,
        b.customer?.phone,
        b.customer?.email,
        b.project?.type,
        b.project?.notes,
      ]
        .filter(Boolean)
        .join(" ")
        .toLowerCase();
      return hay.includes(term);
    });
  }, [all, q]);

  function clearAll() {
    if (!confirm("Delete ALL build submissions stored in this browser? This cannot be undone.")) return;
    localStorage.setItem("rv_build_submissions", "[]");
    refresh();
    toast("All build submissions cleared (local only).", "warning", "Cleared", 2400);
  }

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto", padding: 18 }}>
        <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 10, flexWrap: "wrap" }}>
          <div style={{ display: "grid", gap: 6 }}>
            <h1 className="h2" style={{ margin: 0 }}>Admin ‚Äî Build Submissions</h1>
            <div className="muted" style={{ fontWeight: 900 }}>
              Stored locally in this browser (Firebase later). Customers see renders + public estimate only.
            </div>
          </div>

          <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
            <button className="btn btn-ghost" onClick={refresh}>Refresh</button>
            <button className="btn btn-ghost" onClick={clearAll}>Clear All</button>
            <Link className="btn btn-primary" to="/admin">Back to Admin Dashboard</Link>
          </div>
        </div>

        <div className="row" style={{ width: "100%", marginTop: 12, gap: 10, flexWrap: "wrap" }}>
          <input className="field" style={{ flex: 1, minWidth: 240 }} value={q} onChange={(e) => setQ(e.target.value)} placeholder="Search name, phone, email, status, type‚Ä¶" />
          <span className="badge" style={{ justifyContent: "center" }}>Total: {filtered.length}</span>
        </div>
      </section>

      {filtered.length === 0 ? (
        <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto" }}>
          <h3 className="h3">No build submissions found</h3>
          <p className="body" style={{ maxWidth: 780 }}>
            Builds are stored in <code>localStorage</code> on the same device/browser. Once Firebase is connected, these will sync.
          </p>
          <Link className="btn btn-ghost" to="/builds/new">Create a test build</Link>
        </section>
      ) : (
        <section className="stack" style={{ maxWidth: 1100, margin: "0 auto" }}>
          {filtered
            .slice()
            .sort((a, b) => safe(b.createdAt).localeCompare(safe(a.createdAt)))
            .map((b) => (
              <article key={b.id} className="panel card" style={{ padding: 16 }}>
                <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start", gap: 10, flexWrap: "wrap" }}>
                  <div style={{ display: "grid", gap: 6 }}>
                    <div style={{ fontWeight: 950, color: "#0f172a" }}>
                      Build <span className="badge" style={{ marginLeft: 8, fontSize: 12 }}>{String(b.id).slice(-8).toUpperCase()}</span>
                      <span className="badge" style={{ marginLeft: 8 }}>{String(b.status || "draft").toUpperCase()}</span>
                    </div>

                    <div className="muted" style={{ fontWeight: 850 }}>
                      Created: {fmt(b.createdAt)} ‚Ä¢ Updated: {fmt(b.updatedAt)}
                    </div>

                    <div className="muted" style={{ fontWeight: 850 }}>
                      Customer: <strong>{b.customer?.name || "‚Äî"}</strong> ‚Ä¢ {b.customer?.phone || "‚Äî"} ‚Ä¢ {b.customer?.email || "‚Äî"}
                    </div>

                    <div className="muted" style={{ fontWeight: 850 }}>
                      Type: {b.project?.type || "‚Äî"} ‚Ä¢ Dims: {b.project?.dims?.lengthIn ?? "‚Äî"}√ó{b.project?.dims?.widthIn ?? "‚Äî"}√ó{b.project?.dims?.heightIn ?? "‚Äî"} in
                    </div>
                  </div>

                  <Link className="btn btn-primary" to={`/admin/builds/${b.id}`} style={{ fontWeight: 950 }}>
                    View Details ‚Üí
                  </Link>
                </div>
              </article>
            ))}
        </section>
      )}
    </div>
  );
}
==== src/pages/BuildPreview.tsx ====
import { useEffect, useMemo, useState } from "react";
import { useParams, Link } from "react-router-dom";
import { estimateBuild } from "../lib/buildPricing";
import { renderBuildPreviewPng } from "../lib/render3d";
import {
  addCustomerNote,
  compileNotes,
  getBuild,
  markSubmitted,
  removeLastCustomerNote,
  type BuildSubmission,
  type RenderJob,
  upsertBuild,
} from "../lib/buildsStore";

function fmt(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

export default function BuildPreview() {
  const { id } = useParams();
  const [build, setBuild] = useState<BuildSubmission | null>(null);

  // Customer refinement fields
  const [changeRequest, setChangeRequest] = useState("");
  const [extraNotes, setExtraNotes] = useState("");

  useEffect(() => {
    if (!id) return;
    setBuild(getBuild(id));
  }, [id]);

  const version = useMemo(() => build?.versions?.[0] ?? null, [build]);

  // Render queue: ONE image at a time
  useEffect(() => {
    if (!build || !version) return;

    const latest0 = getBuild(build.id) ?? build;
    const lv0 = latest0.versions?.[0];
    if (!lv0) return;

    const renders0 = lv0.renders || [];

    const currentlyRendering = renders0.find((r) => r.status === "rendering") ?? null;
    let target: RenderJob | null = currentlyRendering;

    if (!target) {
      const firstQueued = renders0.find((r) => r.status === "queued") ?? null;

      if (firstQueued) {
        const startedAt = new Date().toISOString();
        const updatedRenders = renders0.map((r) =>
          r.renderId === firstQueued.renderId ? ({ ...r, status: "rendering" as const, startedAt } as RenderJob) : r
        );

        const nextV = { ...lv0, renders: updatedRenders };
        const nextBuild: BuildSubmission = {
          ...latest0,
          updatedAt: new Date().toISOString(),
          versions: [nextV, ...latest0.versions.slice(1)],
        };

        upsertBuild(nextBuild);
        setBuild(nextBuild);

        target = updatedRenders.find((r) => r.renderId === firstQueued.renderId) as RenderJob;
      }
    }

    if (!target) return;

    let cancelled = false;

    const run = async () => {
      try {
        await new Promise((res) => setTimeout(res, 450));
        if (cancelled) return;

        const latest = getBuild(build.id);
        if (!latest) return;

        const lv = latest.versions[0];
        const est = estimateBuild(lv.inputsSnapshot.dims, lv.inputsSnapshot.options);

        const title = `${lv.inputsSnapshot.type} ‚Ä¢ ${lv.inputsSnapshot.dims.lengthIn}"√ó${lv.inputsSnapshot.dims.widthIn}"√ó${lv.inputsSnapshot.dims.heightIn}"`;

        // Notes used for rendering (structured log + base notes)
        const notesCompiled = compileNotes((lv.inputsSnapshot as any).notesLog, lv.inputsSnapshot.notes);

        const png = await renderBuildPreviewPng({
          projectType: lv.inputsSnapshot.type,
          view: target!.view,
          title,
          notes: notesCompiled,
          dims: lv.inputsSnapshot.dims,
          options: lv.inputsSnapshot.options,
          width: 1200,
          height: 800,
        });

        if (cancelled) return;

        const updatedRenders = (lv.renders || []).map((x) => {
          if (x.renderId !== target!.renderId) return x;
          return {
            ...x,
            status: "complete" as const,
            finishedAt: new Date().toISOString(),
            imageDataUrl: png,
            estimatePublic: {
              total: est.total,
              rangeLow: est.rangeLow,
              rangeHigh: est.rangeHigh,
              label: "Est. total (updates per view)",
            },
          };
        });

        const nextV = {
          ...lv,
          renders: updatedRenders,
          estimatePublic: {
            total: est.total,
            rangeLow: est.rangeLow,
            rangeHigh: est.rangeHigh,
            materials: est.materials,
            labor: est.labor,
            overhead: est.overhead,
            finish: est.finish,
          },
        };

        const nextBuild: BuildSubmission = {
          ...latest,
          updatedAt: new Date().toISOString(),
          versions: [nextV, ...latest.versions.slice(1)],
        };

        upsertBuild(nextBuild);
        setBuild(nextBuild);
      } catch (e) {
        console.error(e);
        if (cancelled) return;

        const latest = getBuild(build.id);
        if (!latest) return;

        const lv = latest.versions[0];
        const updatedRenders = (lv.renders || []).map((x) => {
          if (x.renderId !== target!.renderId) return x;
          return { ...x, status: "failed" as const, finishedAt: new Date().toISOString() };
        });

        const nextV = { ...lv, renders: updatedRenders };
        const nextBuild: BuildSubmission = {
          ...latest,
          updatedAt: new Date().toISOString(),
          versions: [nextV, ...latest.versions.slice(1)],
        };

        upsertBuild(nextBuild);
        setBuild(nextBuild);
      }
    };

    run();

    return () => {
      cancelled = true;
    };
  }, [build?.id, build?.updatedAt, version?.versionId]);

  if (!build || !version) {
    return (
      <div className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h3 className="h3">Build not found</h3>
        <Link className="btn btn-primary" to="/builds/new">
          Start a Build
        </Link>
      </div>
    );
  }

  const v = version;
  const b = build;

  const notesLog = ((v.inputsSnapshot as any).notesLog || []) as any[];
  const compiledNotes = compileNotes(notesLog, v.inputsSnapshot.notes);

  const canRemoveCustomerNote =
    Array.isArray(notesLog) &&
    notesLog.some((n) => String(n?.author || "").toLowerCase() === "customer");

  function submit() {
    const next = markSubmitted(b.id);
    if (!next) return alert("Could not submit. Try again.");
    setBuild(next);
    alert(`Submitted! Your Build Access Code: ${String(next.accessCode || "‚Äî")}`);
  }

  function submitRefinement() {
    const req = changeRequest.trim();
    const add = extraNotes.trim();

    if (!req && !add) {
      alert("Please add a change request and/or extra notes.");
      return;
    }

    const next = addCustomerNote(b.id, req, add);
    if (!next) {
      alert("Could not save changes. Please refresh and try again.");
      return;
    }

    setChangeRequest("");
    setExtraNotes("");
    setBuild(next);
    alert("Saved! We‚Äôre generating updated previews now.");
  }

  function removeLastCustomerNoteClick() {
    if (!confirm("Remove your most recent note and regenerate previews?")) return;

    const next = removeLastCustomerNote(b.id);
    if (!next) {
      alert("Could not remove the last note. Please refresh and try again.");
      return;
    }

    setBuild(next);
    alert("Removed! We‚Äôre generating updated previews now.");
  }

  const est = v.estimatePublic;

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 1100, margin: "0 auto", padding: 18 }}>
        <div style={{ display: "grid", gap: 8 }}>
          <h1 className="h2" style={{ margin: 0, fontWeight: 950 }}>
            Build Preview
          </h1>
          <div className="muted" style={{ fontWeight: 850 }}>
            Created: {fmt(b.createdAt)} ‚Ä¢ Status: <span className="badge">{String(b.status).toUpperCase()}</span>
          </div>
          <div className="muted" style={{ fontWeight: 850 }}>
            Customer: <strong>{b.customer?.name}</strong> ‚Ä¢ {b.customer?.phone} ‚Ä¢ {b.customer?.email}
          </div>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>
            {v.inputsSnapshot.type} ‚Äî {v.inputsSnapshot.dims.lengthIn}" √ó {v.inputsSnapshot.dims.widthIn}" √ó{" "}
            {v.inputsSnapshot.dims.heightIn}"
          </div>
          <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
            Wood: {v.inputsSnapshot.options.woodSpecies} ‚Ä¢ Finish: {v.inputsSnapshot.options.finish} ‚Ä¢ Joinery:{" "}
            {v.inputsSnapshot.options.joinery}
          </div>

          {compiledNotes ? (
            <div className="panel" style={{ padding: 12, borderRadius: 12, marginTop: 10 }}>
              <div className="label">Notes on file (used to improve the model)</div>
              <div className="muted" style={{ fontWeight: 850, whiteSpace: "pre-wrap", marginTop: 6 }}>
                {compiledNotes}
              </div>
            </div>
          ) : null}

          <div className="row" style={{ gap: 10, flexWrap: "wrap", marginTop: 12 }}>
            <Link className="btn btn-ghost" to="/builds/new">
              Start Another
            </Link>
            <Link className="btn btn-ghost" to="/builds/portal">
              Build Portal
            </Link>
            <button className="btn btn-primary" onClick={submit} style={{ fontWeight: 950 }}>
              Submit for Review
            </button>
          </div>

          <div className="muted" style={{ fontWeight: 850, marginTop: 10 }}>
            After submitting you‚Äôll get a 6-digit Access Code to view your build in the Build Portal.
          </div>
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Refine this build (add details)</div>
          <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
            Add specific details and we‚Äôll regenerate previews. Examples: ‚Äútapered legs‚Äù, ‚Äúlower shelf‚Äù, ‚Äúdrawer‚Äù, ‚Äúapron‚Äù, ‚Äúfeet‚Äù, ‚Äú2 shelves‚Äù.
          </div>

          <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
            <label style={{ display: "grid", gap: 6 }}>
              <span className="label">What would you like changed?</span>
              <input
                className="field"
                value={changeRequest}
                onChange={(e) => setChangeRequest(e.target.value)}
                placeholder="Example: Add a lower shelf and tapered legs"
              />
            </label>

            <label style={{ display: "grid", gap: 6 }}>
              <span className="label">Extra notes (used by the renderer)</span>
              <textarea
                className="field"
                rows={4}
                value={extraNotes}
                onChange={(e) => setExtraNotes(e.target.value)}
                placeholder="Example: drawer centered on front, apron on all sides, rounded corners, etc."
              />
            </label>

            <div className="row" style={{ gap: 10, flexWrap: "wrap", justifyContent: "center" }}>
              <button type="button" className="btn btn-primary" onClick={(e) => { e.preventDefault(); e.stopPropagation(); submitRefinement(); }} style={{ fontWeight: 950 }}>
                Save refinement + regenerate previews ‚Üí
              </button>

              {canRemoveCustomerNote ? (
                <button type="button" className="btn btn-ghost" onClick={(e) => { e.preventDefault(); e.stopPropagation(); removeLastCustomerNoteClick(); }} style={{ fontWeight: 950 }}>
                  Remove my last note
                </button>
              ) : null}
            </div>
          </div>

          {Array.isArray(notesLog) && notesLog.length ? (
            <div className="panel" style={{ padding: 12, borderRadius: 12, marginTop: 12 }}>
              <div className="label">Notes timeline</div>
              <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                Notes are saved in separate chunks so Admin can remove any later if needed.
              </div>

              <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
                {notesLog.map((n) => (
                  <div key={String(n.noteId)} className="panel" style={{ padding: 10, borderRadius: 12 }}>
                    <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
                      <div style={{ fontWeight: 950, color: "#0f172a" }}>
                        {String(n.kind || "NOTE").toUpperCase()} ‚Ä¢ {String(n.author || "UNKNOWN").toUpperCase()}
                        <span className="badge" style={{ marginLeft: 8 }}>
                          {fmt(String(n.createdAt))}
                        </span>
                      </div>
                      <div className="muted" style={{ fontWeight: 850 }}>
                        Note ID: <span className="badge">{String(n.noteId).slice(-8).toUpperCase()}</span>
                      </div>
                    </div>
                    <div className="muted" style={{ fontWeight: 850, whiteSpace: "pre-wrap", marginTop: 8 }}>
                      {String(n.text || "")}
                    </div>
                  </div>
                ))}
              </div>
            </div>
          ) : null}
        </div>

        <div className="panel" style={{ padding: 14, borderRadius: 14, marginTop: 12, width: "100%", maxWidth: 1000 }}>
          <div style={{ fontWeight: 950, color: "#0f172a" }}>Estimate (public)</div>
          {!est ? (
            <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>Estimating‚Ä¶ (will populate as render previews complete)</div>
          ) : (
            <div style={{ display: "grid", gap: 10, marginTop: 10 }}>
              <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
                <span className="badge rate-bright">Estimated Total: {money(est.total)}</span>
                {typeof est.rangeLow === "number" && typeof est.rangeHigh === "number" ? (
                  <span className="badge">Range: {money(est.rangeLow)} ‚Äì {money(est.rangeHigh)}</span>
                ) : null}
              </div>

              <div className="muted" style={{ fontWeight: 850 }}>
                Breakdown (customer-safe): Materials {money(est.materials)} ‚Ä¢ Labor {money(est.labor)} ‚Ä¢ Finish {money(est.finish)} ‚Ä¢ Overhead {money(est.overhead)}
              </div>
            </div>
          )}
        </div>
      </section>

      <section className="stack" style={{ maxWidth: 1100, margin: "0 auto", width: "100%" }}>
        <div className="h3" style={{ margin: 0 }}>Render Previews</div>
        <div className="muted" style={{ fontWeight: 850 }}>
          One render runs at a time (queued ‚Üí rendering ‚Üí complete). Each render has its own estimate box.
        </div>

        <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(280px, 1fr))", gap: 12, marginTop: 10 }}>
          {(v.renders || []).map((r) => (
            <article key={r.renderId} className="panel card" style={{ padding: 12, display: "grid", gap: 10 }}>
              <div style={{ fontWeight: 950, color: "#0f172a" }}>
                View: {String(r.view).toUpperCase()}
                <span className="badge" style={{ marginLeft: 8 }}>{String(r.status).toUpperCase()}</span>
              </div>

              <div
                style={{
                  width: "100%",
                  height: 180,
                  borderRadius: 14,
                  overflow: "hidden",
                  border: "1px solid rgba(15,23,42,0.18)",
                  background: "rgba(2,6,23,0.25)",
                }}
              >
                {r.imageDataUrl ? (
                  <img
                    src={r.imageDataUrl}
                    alt={`${r.view} render`}
                    style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }}
                  />
                ) : (
                  <div className="card-center" style={{ width: "100%", height: "100%", padding: 12 }}>
                    <div className="muted" style={{ fontWeight: 900 }}>
                      {r.status === "queued"
                        ? "Queued‚Ä¶"
                        : r.status === "rendering"
                        ? "Rendering‚Ä¶"
                        : r.status === "failed"
                        ? "Render failed (will re-run on refresh later)"
                        : "No image"}
                    </div>
                  </div>
                )}
              </div>

              <div className="panel" style={{ padding: 10, borderRadius: 12 }}>
                <div className="label">Estimate for this render</div>
                {!r.estimatePublic ? (
                  <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                    {r.status === "complete" ? "Finalizing estimate‚Ä¶" : "Waiting for render to complete‚Ä¶"}
                  </div>
                ) : (
                  <div style={{ display: "grid", gap: 8, marginTop: 8 }}>
                    <div className="badge rate-bright" style={{ justifyContent: "center" }}>
                      {r.estimatePublic.label || "Estimated Total"}: {money(r.estimatePublic.total)}
                    </div>
                    {typeof r.estimatePublic.rangeLow === "number" && typeof r.estimatePublic.rangeHigh === "number" ? (
                      <div className="muted" style={{ fontWeight: 850 }}>
                        Range: {money(r.estimatePublic.rangeLow)} ‚Äì {money(r.estimatePublic.rangeHigh)}
                      </div>
                    ) : null}
                  </div>
                )}
              </div>

              <div className="muted" style={{ fontWeight: 850 }}>
                {r.startedAt ? `Started: ${fmt(r.startedAt)}` : "Not started yet"}
                {r.finishedAt ? ` ‚Ä¢ Finished: ${fmt(r.finishedAt)}` : ""}
              </div>
            </article>
          ))}
        </div>
      </section>
    </div>
  );
}
==== src/pages/Services.tsx ====
import { useMemo, useState } from "react";
import { Link } from "react-router-dom";
import { CATEGORIES, SERVICES, type Service } from "../data/services";
import { useCart } from "../data/requestCart";
import { toast } from "../lib/toast";

function formatPrice(s: Service) {
  if (s.priceType === "quote") return "Quote required";

  const money = new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
  }).format(s.price ?? 0);

  if (s.priceType === "fixed") return `${money} ${s.unitLabel ? `(${s.unitLabel})` : ""}`;
  return `Starting at ${money}`;
}

export default function ServicesPage() {
  const cart = useCart();
  const [category, setCategory] = useState("All");
  const [q, setQ] = useState("");

  const filtered = useMemo(() => {
    const query = q.trim().toLowerCase();
    return SERVICES.filter((s) => {
      const matchCategory = category === "All" ? true : s.category === category;
      const matchQuery =
        query.length === 0
          ? true
          : (s.name + " " + s.shortDesc).toLowerCase().includes(query);
      return matchCategory && matchQuery;
    });
  }, [category, q]);

  return (
    <div className="stack page">
      <section className="panel card card-center">
        <h1 className="h2">Services Catalog</h1>
        <p className="lead" style={{ maxWidth: 760 }}>
          Pick a service and add it to your request. For quote-required jobs, add notes and photos in Schedule.
        </p>

        <div className="row">
          <span className="badge">Cart: {cart.count}</span>
          <span className="badge">Showing: {filtered.length}</span>
        </div>

        <div
          className="row"
          style={{
            width: "100%",
            maxWidth: 820,
            marginTop: 10,
          }}
        >
          <select className="field" value={category} onChange={(e) => setCategory(e.target.value)}>
            <option value="All">All</option>
            {CATEGORIES.map((c) => (
              <option key={c} value={c}>
                {c}
              </option>
            ))}
          </select>

          <input
            className="field"
            placeholder="Search services‚Ä¶"
            value={q}
            onChange={(e) => setQ(e.target.value)}
          />
        </div>
      </section>

      <section className="stack">
        {filtered.map((s) => (
          <article
            key={s.id}
            className="panel card"
            style={{
              display: "grid",
              gridTemplateColumns: "140px 1fr",
              gap: 16,
              alignItems: "center",
            }}
          >
            {/* LEFT: Image */}
            <div
              style={{
                width: 140,
                height: 140,
                borderRadius: 14,
                overflow: "hidden",
                border: "1px solid rgba(2,6,23,0.16)",
                boxShadow: "0 10px 26px rgba(29,78,216,0.10)",
                background: "rgba(255,255,255,0.85)",
              }}
            >
              {s.image ? (
                <img
                  src={s.image}
                  alt={s.name}
                  style={{
                    width: "100%",
                    height: "100%",
                    objectFit: "cover",
                    display: "block",
                  }}
                />
              ) : (
                <div
                  className="card-center"
                  style={{
                    width: "100%",
                    height: "100%",
                    padding: 10,
                  }}
                >
                  <div className="label">No Image</div>
                  <div className="muted" style={{ fontWeight: 900, fontSize: 12 }}>
                    {s.id}
                  </div>
                </div>
              )}
            </div>

            {/* RIGHT: Content */}
            <div style={{ display: "grid", gap: 8 }}>
              <div className="row" style={{ justifyContent: "space-between", alignItems: "flex-start" }}>
                <div style={{ display: "grid", gap: 6 }}>
                  <div className="h3">{s.name}</div>
                  <div className="muted" style={{ fontWeight: 900, fontSize: 13 }}>
                    {s.category}
                  </div>
                </div>

                <div style={{ textAlign: "right" }}>
                  <div className="badge" style={{ justifyContent: "center" }}>
                    {s.priceType === "fixed" ? "Fixed" : s.priceType === "starting_at" ? "Starting" : "Quote"}
                  </div>
                  <div className="price-accent" style={{ fontWeight: 950, marginTop: 8 }}>{formatPrice(s)}</div>
                </div>
              </div>

              <div className="body">{s.shortDesc}</div>

              <div className="row">
                <button className="btn btn-primary" onClick={() => { cart.add(s); toast(`${s.name} added`, "success", "Added", 2600, "View Schedule", "/schedule"); }}>
                  Add to Request
                </button>

                <Link
                  to={`/services/${s.id}`}
                  className="btn btn-ghost"
                  style={{ textDecoration: "none" }}
                >
                  View Details
                </Link>

                {cart.has(s.id) && <span className="badge">Added ‚úì</span>}
              </div>
            </div>
          </article>
        ))}
      </section>

      <style>{`
        /* Mobile: stack image on top */
        @media (max-width: 620px) {
          article.panel.card {
            grid-template-columns: 1fr !important;
          }
          article.panel.card > div:first-child {
            width: 100% !important;
            height: 190px !important;
          }
        }
      `}</style>
    </div>
  );
}==== src/pages/Schedule.tsx ====
import { useEffect, useMemo, useState } from "react";
import { useCart } from "../data/requestCart";
import { SERVICES } from "../data/services";
import { ADD_ONS } from "../data/addOns";
import { AVAILABILITY } from "../data/availability";
import {
  addDays,
  buildSlotsForDate,
  clampToMidnight,
  formatDateInput,
  formatTimeLabel,
  isOpenDay,
} from "../data/timeSlots";
import EstimatePreview from "../components/EstimatePreview";

type PhotoAttachment = {
  name: string;
  type: string;
  dataUrl: string;
};

type ContactInfo = {
  name: string;
  phone: string;
  address: string;
  notes: string;
  photos: PhotoAttachment[];
};

const MAX_PHOTOS = 6;
const MAX_BYTES_PER_PHOTO = 1_200_000;

function fileToDataUrl(file: File): Promise<string> {
  return new Promise((resolve, reject) => {
    const r = new FileReader();
    r.onload = () => resolve(String(r.result));
    r.onerror = () => reject(new Error("Failed to read image"));
    r.readAsDataURL(file);
  });
}


function normalizePhone(p?: string) {
  return String(p || "").replace(/\D+/g, "");
}

function money(n: number) {
  return new Intl.NumberFormat("en-US", { style: "currency", currency: "USD" }).format(n);
}

function makeAccessCode() {
  // 6-digit numeric code
  return String(Math.floor(100000 + Math.random() * 900000));
}

function estimateLabel(s: any, qty: number) {
  if (!s) return "";
  const q = Number.isFinite(Number(qty)) && Number(qty) > 0 ? Number(qty) : 1;

  if (s.priceType === "quote") return "Quote";

  const price = typeof s.price === "number" ? s.price : 0;

  if (s.priceType === "starting_at") {
    const min = price * q;
    return `From ${money(min)}`;
  }

  return money(price * q);
}





function QuoteBanner({ quoteNames }: { quoteNames: string[] }) {
  if (quoteNames.length === 0) return null;

  return (
    <div
      style={{
        width: "100%",
        maxWidth: 900,
        borderRadius: 14,
        padding: 14,
        border: "1px solid rgba(220,38,38,0.35)",
        background: "rgba(220,38,38,0.10)",
        color: "#7f1d1d",
        boxShadow: "0 10px 28px rgba(220,38,38,0.10)",
      }}
    >
      <div style={{ fontWeight: 950, fontSize: 14 }}>
        Quote required for {quoteNames.length} item{quoteNames.length === 1 ? "" : "s"}
      </div>
      <div style={{ marginTop: 6, fontWeight: 800, fontSize: 12, opacity: 0.95 }}>
        Please add photos below for fastest response. Quote items are not included in the estimate.
      </div>
      <div style={{ marginTop: 8, fontSize: 12, fontWeight: 800 }}>
        {quoteNames.join(", ")}
      </div>
    </div>
  );
}

export default function Schedule() {
  const cart = useCart();

  const ALL_SERVICES = useMemo(() => [...SERVICES, ...ADD_ONS], []);

  const itemsDetailed = useMemo(() => {
    return cart.items.map((i) => {
      const service = ALL_SERVICES.find((s) => s.id === i.serviceId);
      
      const estLabel = estimateLabel(service as any, Number(i.qty ?? 1));
return { ...i, service, estLabel };
    });
  }, [cart.items, ALL_SERVICES]);

  // ‚úÖ Estimate breakdown (fixed + starting at minimum + quote list)
  const estimate = useMemo(() => {
    let fixedSubtotal = 0;
    let startingSubtotal = 0;

    const quoteNames: string[] = [];
    const missingNames: string[] = [];

    for (const i of itemsDetailed) {
      const s: any = i.service;
      const qty = Number(i.qty ?? 1);

      if (!s) {
        missingNames.push(i.serviceId);
        continue;
      }

      const name = s.name ?? i.serviceId;

      if (s.priceType === "quote") {
        quoteNames.push(name);
        continue;
      }

      const price = typeof s.price === "number" ? s.price : 0;

      if (s.priceType === "fixed") {
        fixedSubtotal += price * qty;
        continue;
      }

      if (s.priceType === "starting_at") {
        startingSubtotal += price * qty;
        continue;
      }

      // unknown price type
      missingNames.push(name);
    }

    const minTotal = fixedSubtotal + startingSubtotal;
    const hasStarting = startingSubtotal > 0;

    return {
      fixedSubtotal,
      startingSubtotal,
      minTotal,
      hasStarting,
      quoteNames,
      missingNames,
    };
  }, [itemsDetailed]);

  const today = clampToMidnight(new Date());
  const maxDate = addDays(today, AVAILABILITY.maxDaysAhead);

  const defaultDate = useMemo(() => {
    let d = new Date(today);
    for (let i = 0; i <= 14; i++) {
      if (isOpenDay(d)) return d;
      d = addDays(d, 1);
    }
    return today;
  }, [today]);

  const [dateStr, setDateStr] = useState(formatDateInput(defaultDate));
  const chosenDate = useMemo(() => new Date(dateStr + "T00:00:00"), [dateStr]);

  const slots = useMemo(() => buildSlotsForDate(chosenDate), [chosenDate]);
  const [selectedSlotISO, setSelectedSlotISO] = useState<string>("");

  const [contact, setContact] = useState<ContactInfo>({
    name: "",
    phone: "",
    address: "",
    notes: "",
    photos: [],
  });

  // Step 2: as soon as the user types a real phone number, scope the cart to that phone
  // (so the navbar cart count reflects THIS customer, not the last active one).
  useEffect(() => {
    const digits = normalizePhone(contact.phone);
    if (digits.length >= 10) {
      cart.setCustomer({ phone: contact.phone });
    }
  }, [contact.phone]);


  async function onAddPhotos(files: FileList | null) {
    if (!files || files.length === 0) return;

    const existing = contact.photos.length;
    const remaining = Math.max(0, MAX_PHOTOS - existing);

    if (remaining === 0) {
      alert(`Photo limit reached (${MAX_PHOTOS}). Remove one to add more.`);
      return;
    }

    const selected = Array.from(files).slice(0, remaining);

    const tooBig = selected.find((f) => f.size > MAX_BYTES_PER_PHOTO);
    if (tooBig) {
      alert(
        `One of your photos is too large (${Math.round(tooBig.size / 1024)} KB). ` +
          `Please choose images under ~${Math.round(MAX_BYTES_PER_PHOTO / 1024)} KB each.`
      );
      return;
    }

    try {
      const attachments: PhotoAttachment[] = [];
      for (const f of selected) {
        const dataUrl = await fileToDataUrl(f);
        attachments.push({ name: f.name, type: f.type, dataUrl });
      }

      setContact((c) => ({
        ...c,
        photos: [...c.photos, ...attachments],
      }));
    } catch (e) {
      console.error(e);
      alert("Could not read one of the images. Please try again.");
    }
  }

  function removePhoto(index: number) {
    setContact((c) => ({
      ...c,
      photos: c.photos.filter((_, i) => i !== index),
    }));
  }

  function onSubmit() {
    if (cart.items.length === 0) {
      alert("Your request cart is empty. Please add services first.");
      return;
    }
    if (!contact.name.trim() || !contact.phone.trim()) {
      alert("Please enter at least your name and phone number.");
      return;
    }
    if (!selectedSlotISO) {
      alert("Please select a time slot.");
      return;
    }

    const accessCode = makeAccessCode();

    // Step 2: lock the active customer to phone+accessCode at submit time
    // so future cart reads are isolated to this customer session.
    cart.setCustomer({ phone: contact.phone, accessCode });


    const request = {
      createdAt: new Date().toISOString(),
      appointmentStart: selectedSlotISO,
      accessCode,
      customer: {
        name: contact.name,
        phone: contact.phone,
        address: contact.address,
        notes: contact.notes,
      },
      items: cart.items,
      photos: contact.photos,
      status: "new" as const,
    };

    const existing = JSON.parse(localStorage.getItem("rv_requests") ?? "[]");

    // ‚úÖ Give this request a stable id (clean + reliable)
    if (!(request as any).id) {
      (request as any).id =
        (crypto as any).randomUUID?.() ??
        (Math.random().toString(16).slice(2) + Date.now().toString(16));
    }

    localStorage.setItem("rv_requests", JSON.stringify([request, ...existing]));

    // ‚úÖ Redirect to confirmation page
    window.location.href = `/request-confirmed/${(request as any).id}`;

    cart.clear();
    setSelectedSlotISO("");
    setContact({ name: "", phone: "", address: "", notes: "", photos: [] });
  }

  function EstimateBox({ compact }: { compact?: boolean }) {
  return (
    <div
      className="panel card"
      style={{
        width: "100%",
        maxWidth: 1100,
        margin: "0 auto",
        padding: compact ? 12 : 16,
        background: "var(--panel-bg)",
        border: "1px solid var(--border)",
        textAlign: "center",
      }}
    >
      {/* Header */}
      <div style={{ display: "grid", gap: 8, justifyItems: "center" }}>
        <div className="h3" style={{ margin: 0 }}>
          Estimate Summary
        </div>
        <div className="muted" style={{ fontWeight: 900, maxWidth: 820 }}>
          Minimum estimate = Fixed + Starting-at items (quote items not included)
        </div>

        <div
          className="badge rate-bright"
          style={{
            justifyContent: "center",
            width: "fit-content",
            marginTop: 6,
            fontWeight: 950,
          }}
        >
          Minimum: {money(estimate.minTotal)}
          {estimate.hasStarting ? "+" : ""}
        </div>
      </div>

      {/* Tiles */}
      <div
        style={{
          marginTop: 12,
          display: "grid",
          gridTemplateColumns: "repeat(auto-fit, minmax(220px, 1fr))",
          gap: 10,
          justifyItems: "center",
        }}
      >
        <div className="panel" style={{ padding: 12, borderRadius: 12, width: "100%", maxWidth: 360 }}>
          <div className="label">Fixed subtotal</div>
          <div className="rate-bright" style={{ fontWeight: 950, marginTop: 6 }}>{money(estimate.fixedSubtotal)}</div>
        </div>

        <div className="panel" style={{ padding: 12, borderRadius: 12, width: "100%", maxWidth: 360 }}>
          <div className="label">Starting-at subtotal</div>
          <div className="rate-bright" style={{ fontWeight: 950, marginTop: 6 }}>
            {money(estimate.startingSubtotal)}
            {estimate.startingSubtotal > 0 ? "+" : ""}
          
          </div>
        </div>

        <div className="panel" style={{ padding: 12, borderRadius: 12, width: "100%", maxWidth: 360 }}>
          <div className="label">Quote-required items</div>
          <div className="rate-bright" style={{ fontWeight: 950, marginTop: 6 }}>{estimate.quoteNames.length}</div>
        </div>
      </div>

      {/* Missing items */}
      {estimate.missingNames.length > 0 && (
        <div style={{ marginTop: 12 }}>
          <div className="label">Unpriced / missing items</div>
          <div className="body" style={{ marginTop: 6 }}>
            {estimate.missingNames.join(", ")}
          </div>
        </div>
      )}

      {/* Disclaimer */}
      {!compact && (
        <div className="muted" style={{ fontWeight: 900, marginTop: 12, maxWidth: 900, marginLeft: "auto", marginRight: "auto" }}>
          ‚ÄúStarting at‚Äù prices are minimums and may change based on site conditions, access, materials, or complexity.
        </div>
      )}
    </div>
  );
}

  return (
    <div className="stack page">
      <section className="panel card card-center">
        <h1 className="h2">Schedule Your Service</h1>
        <p className="lead" style={{ maxWidth: 720 }}>
          Review your request, pick a date & time, attach photos (optional), and submit.
        </p>

        <div className="row" style={{ flexWrap: "wrap" }}>
          <span className="badge">Cart items: {cart.count}</span>
          <span className="badge">
            Hours: {AVAILABILITY.startHour}:00‚Äì{AVAILABILITY.endHour}:00
          </span>
          <span className="badge">Slots: {AVAILABILITY.slotMinutes} min</span>
          <span className="badge">Request photos: {contact.photos.length}/{MAX_PHOTOS}</span>
        </div>

        {cart.items.length > 0 && (
          <div style={{ width: "100%", marginTop: 14, display: "grid", gap: 12 }}>
            {/* ‚úÖ Red warning at top */}
            <QuoteBanner quoteNames={estimate.quoteNames} />

            
      <EstimatePreview />
<EstimateBox />
          </div>
        )}
      </section>

      {cart.items.length === 0 ? (
        <section className="panel card card-center">
          <h3 className="h3">Your request cart is empty</h3>
          <p className="body" style={{ maxWidth: 560 }}>
            Go to Services, add what you need, then come back here to schedule.
          </p>
          <button className="btn btn-primary" onClick={() => (window.location.href = "/services")}>
            Go to Services
          </button>
        </section>
      ) : (
        <section className="stack">
          {itemsDetailed.map((i) => (
            <article
              key={i.serviceId}
              className="panel card"
              style={{
                display: "grid",
                gridTemplateColumns: "96px minmax(0, 1fr)",
                gap: 14,
                alignItems: "start",
              }}
            >
              {/* LEFT: image for service or add-on */}
              <div
                style={{
                  width: 96,
                  height: 96,
                  borderRadius: 14,
                  overflow: "hidden",
                  border: "1px solid rgba(2,6,23,0.16)",
                  background: "rgba(255,255,255,0.85)",
                  boxShadow: "0 10px 22px rgba(29,78,216,0.10)",
                }}
              >
                {i.service?.image ? (
                  <img
                    src={i.service.image}
                    alt={i.service?.name ?? "Service"}
                    style={{ width: "100%", height: "100%", objectFit: "cover", display: "block" }}
                  />
                ) : (
                  <div className="card-center" style={{ width: "100%", height: "100%", padding: 10 }}>
                    <div className="label">No Image</div>
                  </div>
                )}
              </div>

              {/* RIGHT: content */}
              <div style={{ display: "grid", gap: 10, alignItems: "stretch" }}>
                <div className="row" style={{ justifyContent: "space-between" }}>
                  <div>
                    <h3 className="h3" style={{ margin: 0 }}>
                      {i.service?.name ?? "Service"}
                    </h3>
                    <div className="muted" style={{ fontWeight: 900 }}>
                      {i.service?.category ?? "‚Äî"}
                    </div>
                  </div>

                  <div className="row">
                    <span className="badge">Qty: {i.qty}</span>
                    {i.estLabel ? (
                      <span className="badge" style={{
                        fontWeight: 950,
                        borderRadius: 12,
                        padding: "8px 12px",
                        border: "1px solid rgba(2,6,23,0.14)",
                        background: String(i.estLabel).toLowerCase().includes("quote")
                          ? "rgba(245,158,11,0.16)"
                          : String(i.estLabel).toLowerCase().includes("from")
                          ? "rgba(14,165,233,0.14)"
                          : "rgba(34,197,94,0.14)",
                      }}>
                        {i.estLabel}
                      </span>
                    ) : null}
                    <button className="btn btn-ghost" onClick={() => cart.remove(i.serviceId)}>
                      Remove
                    </button>
                  </div>
                </div>

                <label style={{ width: "100%", display: "grid", gap: 6 }}>
                  <span className="label">Notes for this item</span>
                  <textarea
                    className="field"
                    rows={3}
                    value={i.note}
                    onChange={(e) => cart.setNote(i.serviceId, e.target.value)}
                    placeholder="Add helpful details"
                  />
                </label>
              </div>
            </article>
          ))}

          <div className="row" style={{ justifyContent: "center" }}>
            <button className="btn btn-ghost" onClick={cart.clear}>
              Clear All
            </button>
          </div>
        </section>
      )}

      {cart.items.length > 0 && (
        <section className="panel card card-center">
          <h2 className="h2">Pick a Date</h2>

          <div style={{ width: "100%", maxWidth: 520, display: "grid", gap: 10 }}>
            <input
              className="field"
              type="date"
              value={dateStr}
              min={formatDateInput(today)}
              max={formatDateInput(maxDate)}
              onChange={(e) => {
                setDateStr(e.target.value);
                setSelectedSlotISO("");
              }}
            />

            {!isOpenDay(chosenDate) && (
              <div className="badge" style={{ justifyContent: "center" }}>
                Closed on this day ‚Äî please choose another date.
              </div>
            )}
          </div>

          <h2 className="h2" style={{ marginTop: 18 }}>
            Pick a Time
          </h2>

          <div
            style={{
              width: "100%",
              maxWidth: 720,
              display: "grid",
              gridTemplateColumns: "repeat(auto-fit, minmax(160px, 1fr))",
              gap: 10,
              marginTop: 10,
            }}
          >
            {slots.length === 0 ? (
              <div className="badge" style={{ gridColumn: "1 / -1", justifyContent: "center" }}>
                No slots available for this date.
              </div>
            ) : (
              slots.map((t) => {
                const iso = t.toISOString();
                const selected = selectedSlotISO === iso;
                return (
                  <button
                    key={iso}
                    type="button"
                    className={"btn " + (selected ? "btn-primary" : "btn-ghost")}
                    onClick={() => setSelectedSlotISO(iso)}
                    style={{ justifyContent: "center" }}
                  >
                    {formatTimeLabel(t)}
                  </button>
                );
              })
            )}
          </div>
        </section>
      )}

      {cart.items.length > 0 && (
        <section className="panel card card-center">
          <h2 className="h2">Your Info</h2>

          <div style={{ width: "100%", maxWidth: 720, display: "grid", gap: 10 }}>
            <input
              className="field"
              placeholder="Full Name"
              value={contact.name}
              onChange={(e) => setContact({ ...contact, name: e.target.value })}
            />
            <input
              className="field"
              placeholder="Phone Number"
              value={contact.phone}
              onChange={(e) => setContact({ ...contact, phone: e.target.value })}
            />
            <input
              className="field"
              placeholder="Service Address (optional for now)"
              value={contact.address}
              onChange={(e) => setContact({ ...contact, address: e.target.value })}
            />
            <textarea
              className="field"
              rows={4}
              placeholder="General notes (parking, gate code, preferred arrival window, etc.)"
              value={contact.notes}
              onChange={(e) => setContact({ ...contact, notes: e.target.value })}
            />

            {/* ‚úÖ Compact estimate + red quote banner near photos */}
            <div style={{ display: "grid", gap: 10 }}>
              <QuoteBanner quoteNames={estimate.quoteNames} />
              <EstimateBox compact />
            </div>

            <div className="panel card schedItem" style={{ width: "100%", padding: 14 }}>
              <div className="label">Request Photos (optional)</div>
              <div className="body" style={{ marginTop: 6 }}>
                Add photos to help with quote-required work. Max {MAX_PHOTOS} photos, ~{Math.round(MAX_BYTES_PER_PHOTO / 1024)}KB each.
              </div>

              <div className="row" style={{ marginTop: 10, justifyContent: "center" }}>
                <input type="file" accept="image/*" multiple onChange={(e) => onAddPhotos(e.target.files)} />
              </div>

              {contact.photos.length > 0 && (
                <div
                  style={{
                    marginTop: 12,
                    display: "grid",
                    gridTemplateColumns: "repeat(auto-fit, minmax(120px, 1fr))",
                    gap: 10,
                  }}
                >
                  {contact.photos.map((p, idx) => (
                    <div key={idx} className="panel" style={{ padding: 10, borderRadius: 12 }}>
                      <img
                        src={p.dataUrl}
                        alt={p.name}
                        style={{
                          width: "100%",
                          height: 110,
                          objectFit: "cover",
                          borderRadius: 10,
                          border: "1px solid rgba(15,23,42,0.15)",
                        }}
                      />
                      <div className="muted" style={{ fontSize: 11, fontWeight: 900, marginTop: 6, wordBreak: "break-word" }}>
                        {p.name}
                      </div>
                      <button className="btn btn-ghost" style={{ width: "100%", marginTop: 8 }} onClick={() => removePhoto(idx)}>
                        Remove
                      </button>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>

          <button className="btn btn-primary" onClick={onSubmit} style={{ marginTop: 12 }}>
            Submit Request
          </button>
        </section>
      )}

      <style>{`
        @media (max-width: 620px) {
          article.panel.card {
            grid-template-columns: 1fr !important;
          }
          article.panel.card > div:first-child {
            width: 100% !important;
            height: 190px !important;
          }
        }
      `}</style>
    </div>
  );
}==== src/pages/StayLit.tsx ====
import { Routes, Route, Navigate, useLocation } from "react-router-dom";
import StayLitSplash from "./staylit/StayLitSplash";
import StayLitShop from "./staylit/StayLitShop";
import StayLitCreate from "./staylit/StayLitCreate";
import StayLitAbout from "./staylit/StayLitAbout";
import StayLitPolicies from "./staylit/StayLitPolicies";

export default function StayLit() {
  const location = useLocation();

  // Normalize trailing slash
  const path = location.pathname.replace(/\/+$/, "");
  const isSplash = path === "/staylit";

  // When you're on the splash route only, we center the entire splash content
  // both vertically and horizontally. For other Stay Lit routes, we let pages scroll normally.
  const wrapperStyle: React.CSSProperties = isSplash
    ? {
        minHeight: "calc(100vh - 80px)", // adjust if your navbar height differs
        display: "flex",
        alignItems: "center",
        justifyContent: "center",
        padding: "24px 16px",
      }
    : {
        minHeight: "calc(100vh - 80px)",
        padding: "24px 16px",
      };

  const innerStyle: React.CSSProperties = isSplash
    ? {
        width: "100%",
        maxWidth: 1100,
      }
    : {
        width: "100%",
        maxWidth: 1200,
        margin: "0 auto",
      };

  return (
    <div style={wrapperStyle}>
      <div style={innerStyle}>
        <Routes>
          <Route path="/" element={<StayLitSplash />} />
          <Route path="/shop" element={<StayLitShop />} />
          <Route path="/create" element={<StayLitCreate />} />
          <Route path="/about" element={<StayLitAbout />} />
          <Route path="/policies" element={<StayLitPolicies />} />
          <Route path="*" element={<Navigate to="/staylit" replace />} />
        </Routes>
      </div>
    </div>
  );
}
==== src/pages/ServiceDetail.tsx ====
import { useMemo, useState } from "react";
import { useParams, Link } from "react-router-dom";
import { SERVICES, type Service } from "../data/services";
import { useCart } from "../data/requestCart";
import { addOnsFor } from "../data/addOns";
import { toast } from "../lib/toast";

function formatPrice(s: Service) {
  if (s.priceType === "quote") return "Quote required";

  const money = new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: "USD",
  }).format(s.price ?? 0);

  if (s.priceType === "fixed") return `${money} ${s.unitLabel ? `(${s.unitLabel})` : ""}`;
  return `Starting at ${money}`;
}


function buildAddedMessage(serviceName: string, addOnCount: number) {
  if (addOnCount > 0) return `${serviceName} added (+${addOnCount} add-on${addOnCount === 1 ? "" : "s"})`;
  return `${serviceName} added`;
}

type DetailPack = {
  included: string[];
  prep: string[];
  disclaimer?: string;
};

const DETAILS: Record<string, DetailPack> = {
  "tv-mount": {
    included: [
      "Mount TV to wall studs using your bracket",
      "Leveling + secure fastening",
      "Basic setup and testing",
      "Cleanup of work area",
    ],
    prep: [
      "Have TV + bracket ready",
      "Move furniture if needed",
      "Mention cable concealment in notes",
    ],
  },

  "ceiling-fan": {
    included: [
      "Remove old fixture",
      "Install new fan",
      "Balance + test",
      "Cleanup",
    ],
    prep: [
      "Have fan on-site",
      "Breaker access",
      "Confirm ceiling height",
    ],
  },

  "custom-shelves": {
    included: [
      "Measurements + planning",
      "Design consultation",
      "Material estimate",
      "Install scheduling",
    ],
    prep: [
      "Provide photos",
      "Decide shelf use",
      "Choose finish",
    ],
  },

  "deck-repair": {
    included: [
      "Deck inspection",
      "Board replacement",
      "Fastener tightening",
      "Cleanup",
    ],
    prep: [
      "Clear deck",
      "Provide stain info",
      "Send photos",
    ],
  },

  "junk-removal": {
    included: [
      "Pickup + hauling",
      "Loading",
      "Disposal",
      "Sweep-up",
    ],
    prep: [
      "Group items",
      "Note stairs",
      "Mention heavy items",
    ],
  },

  "project-consult": {
    included: [
      "Project walkthrough",
      "Material guidance",
      "Timeline advice",
      "Priority planning",
    ],
    prep: [
      "Bring inspiration",
      "Have measurements",
      "List goals",
    ],
  },
};

function getDetails(id: string): DetailPack {
  return (
    DETAILS[id] ?? {
      included: ["Professional workmanship", "Cleanup", "Clear communication"],
      prep: ["Provide photos", "Ensure access"],
    }
  );
}

export default function ServiceDetail() {
  const { id } = useParams();
  const cart = useCart();

  const service = useMemo(() => SERVICES.find((s) => s.id === id), [id]);

  if (!service) {
    return (
      <div className="stack page">
        <section className="panel card card-center">
          <h1>Service not found</h1>
          <Link to="/services" className="btn btn-primary">
            Back
          </Link>
        </section>
      </div>
    );
  }

  const svc = service;
  const details = getDetails(svc.id);
  const addOns = addOnsFor(svc.id);

  const [qty, setQty] = useState(1);
  const [note, setNote] = useState("");
  const [selected, setSelected] = useState<string[]>([]);

  function toggle(id: string) {
    setSelected((p) =>
      p.includes(id) ? p.filter((x) => x !== id) : [...p, id]
    );
  }

  function add() {
    cart.add(svc);
    cart.setQty(svc.id, qty);
    cart.setNote(svc.id, note);

    addOns
      .filter((a) => selected.includes(a.id))
      .forEach((a) => {
        cart.add(a);
        cart.setQty(a.id, 1);
        cart.setNote(a.id, `Add-on for ${svc.name}`);
      });

    toast(buildAddedMessage(svc.name, selected.length), "success", "Added", 2600, "View Schedule", "/schedule");
  }

  return (
    <div className="stack page">
      {/* Header */}
      <section
        className="panel card"
        style={{
          display: "grid",
          gridTemplateColumns: "220px 1fr",
          gap: 20,
        }}
      >
        <img
          src={svc.image}
          alt={svc.name}
          style={{
            width: 220,
            height: 220,
            objectFit: "cover",
            borderRadius: 16,
          }}
        />

        <div>
          <h1>{svc.name}</h1>
          <div className="badge">{formatPrice(svc)}</div>
          <p>{svc.shortDesc}</p>

          <div className="row">
            <Link to="/services" className="btn btn-ghost">
              ‚Üê Back
            </Link>

            <Link to="/schedule" className="btn btn-primary">
              Schedule ‚Üí
            </Link>
          </div>
        </div>
      </section>

      {/* Included */}
      <section className="panel card">
        <h3>What's Included</h3>

        <ul>
          {details.included.map((b) => (
            <li key={b}>{b}</li>
          ))}
        </ul>
      </section>

      {/* Add-ons */}
      {addOns.length > 0 && (
        <section className="panel card">
          <h3>Recommended Add-Ons</h3>

          <div
            style={{
              display: "grid",
              gridTemplateColumns: "repeat(auto-fit,minmax(240px,1fr))",
              gap: 12,
              marginTop: 10,
            }}
          >
            {addOns.map((ao) => {
              const on = selected.includes(ao.id);

              return (
                <div
                  key={ao.id}
                  onClick={() => toggle(ao.id)}
                  className="panel"
                  style={{
                    cursor: "pointer",
                    padding: 12,
                    border: on
                      ? "2px solid #2563eb"
                      : "1px solid rgba(0,0,0,0.15)",
                    borderRadius: 12,
                  }}
                >
                  {ao.image && (
                    <img
                      src={ao.image}
                      alt={ao.name}
                      style={{
                        width: 64,
                        height: 64,
                        borderRadius: 10,
                        objectFit: "cover",
                        marginBottom: 6,
                      }}
                    />
                  )}

                  <strong>{ao.name}</strong>

                  <div className="muted">{formatPrice(ao)}</div>

                  <p style={{ fontSize: 13 }}>{ao.shortDesc}</p>

                  <span className="badge">
                    {on ? "Selected ‚úì" : "Tap to select"}
                  </span>
                </div>
              );
            })}
          </div>
        </section>
      )}

      {/* Add */}
      <section className="panel card">
        <h3>Add to Request</h3>

        <div className="row">
          <input
            type="number"
            min={1}
            value={qty}
            onChange={(e) => setQty(Number(e.target.value))}
            className="field"
            style={{ width: 100 }}
          />

          <input
            className="field"
            value={note}
            onChange={(e) => setNote(e.target.value)}
            placeholder="Notes (optional)"
          />

          <button className="btn btn-primary" onClick={add}>
            Add
          </button>
        </div>
      </section>
    </div>
  );
}==== src/pages/Portfolio.tsx ====

export default function Portfolio() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>Portfolio</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            A place to show before/after photos and project highlights. We will plug your real images in next.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 14 }}>
          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950 }}>Featured projects</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850 }}>
              Add project cards here: TV mounts, shelving, deck repairs, cleanouts, and custom builds.
            </div>
          </div>

          <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fit, minmax(240px, 1fr))", gap: 12 }}>
            {Array.from({ length: 6 }).map((_, i) => (
              <div key={i} className="panel" style={{ padding: 12, borderRadius: 14 }}>
                <div style={{ height: 140, borderRadius: 12, background: "rgba(2,6,23,0.06)" }} />
                <div style={{ marginTop: 10, fontWeight: 950 }}>Project Title #{i + 1}</div>
                <div className="muted" style={{ marginTop: 6, fontWeight: 850 }}>
                  Short before/after description goes here.
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/RequestConfirmed.tsx ====
import { useMemo } from "react";
import { Link, useParams } from "react-router-dom";
import { findRequestById } from "../lib/requestsStore";

function prettyDate(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

export default function RequestConfirmed() {
  const { id } = useParams();

  const req = useMemo(() => {
    if (!id) return undefined;
    return findRequestById(id);
  }, [id]);

  if (!id) {
    return (
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>Missing request id</h2>
        <p className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 720 }}>
          We couldn‚Äôt determine which request to display.
        </p>
        <Link className="btn btn-primary" to="/schedule">Back to Schedule</Link>
      </section>
    );
  }

  if (!req) {
    return (
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>We couldn‚Äôt load the request details.</h2>
        <p className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 720 }}>
          This can happen if the request was cleared from this browser/device.
        </p>
        <div className="row" style={{ gap: 10, justifyContent: "center", flexWrap: "wrap" }}>
          <Link className="btn btn-primary" to="/customer">Go to Customer Portal</Link>
          <Link className="btn btn-ghost" to="/services">Browse Services</Link>
        </div>
      </section>
    );
  }

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>Request Submitted ‚úÖ</h2>
        <p className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 760 }}>
          Your request has been saved locally for now. You can use the Access Code + Phone Number in the Customer Portal
          to view this request on this device/browser.
        </p>

        <div
          className="panel"
          style={{
            padding: 14,
            borderRadius: 14,
            background: "rgba(255,255,255,0.90)",
            border: "1px solid rgba(2,6,23,0.14)",
            textAlign: "center",
            width: "100%",
            maxWidth: 520,
          }}
        >
          <div className="label">Customer Access Code</div>
          <div style={{ fontWeight: 950, fontSize: 28, letterSpacing: 3, marginTop: 6, color: "#0f172a" }}>
            {(req as any)?.accessCode ? String((req as any).accessCode) : "‚Äî"}
          </div>
          <div className="muted" style={{ fontWeight: 850, marginTop: 8 }}>
            Save this code (screenshot it). You‚Äôll need it with your phone number in the Customer Portal.
          </div>
        </div>

        <div
          style={{
            width: "100%",
            maxWidth: 720,
            display: "grid",
            gap: 10,
            marginTop: 10,
          }}
        >
          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
              <div>
                <div className="label">Request ID</div>
                <div style={{ fontWeight: 950 }}>{String(req.id)}</div>
              </div>
              <div style={{ textAlign: "right" }}>
                <div className="label">Created</div>
                <div style={{ fontWeight: 950 }}>{prettyDate(req.createdAt)}</div>
              </div>
            </div>
          </div>

          <div className="panel" style={{ padding: 12, borderRadius: 14 }}>
            <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
              <div>
                <div className="label">Customer</div>
                <div style={{ fontWeight: 950 }}>{req.customer?.name || "‚Äî"}</div>
                <div className="muted" style={{ fontWeight: 850, marginTop: 4 }}>{req.customer?.phone || "‚Äî"}</div>
              </div>
              <div style={{ textAlign: "right" }}>
                <div className="label">Appointment</div>
                <div style={{ fontWeight: 950 }}>{prettyDate(req.appointmentStart)}</div>
              </div>
            </div>
          </div>
        </div>

        <div className="row" style={{ gap: 10, justifyContent: "center", flexWrap: "wrap", marginTop: 10 }}>
          <Link className="btn btn-primary" to="/customer">Open Customer Portal</Link>
          <Link className="btn btn-ghost" to="/services">Add More Services</Link>
        </div>
      </section>
    </div>
  );
}
==== src/pages/Builds.tsx ====
import { Link } from "react-router-dom";
import { readBuilds } from "../lib/buildsStore";

export default function Builds() {
  const count = readBuilds().length;

  return (
    <div className="stack page" style={{ gap: 16 }}>
      <section className="panel card card-center" style={{ maxWidth: 980, margin: "0 auto", padding: 18 }}>
        <h1 className="h2" style={{ margin: 0, fontWeight: 950 }}>Custom Builds</h1>
        <p className="lead" style={{ maxWidth: 820 }}>
          Design a custom woodworking build and submit it for review. You‚Äôll see only 3D render previews + an estimate as we generate each view.
        </p>

        <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
          <Link className="btn btn-primary" to="/builds/new" style={{ fontWeight: 950 }}>Start a Build</Link>
          <Link className="btn btn-ghost" to="/builds/portal" style={{ fontWeight: 900 }}>Build Portal</Link>
          <span className="badge" style={{ justifyContent: "center" }}>Saved builds on this device: {count}</span>
        </div>

        <div className="muted" style={{ fontWeight: 850, marginTop: 10, maxWidth: 900, textAlign: "center" }}>
          Tip: Your Build Access Code appears after you submit. Use it in the Build Portal to view the build on this device/browser.
        </div>
      </section>

      <section className="panel card card-center" style={{ maxWidth: 980, margin: "0 auto", padding: 18 }}>
        <h3 className="h3" style={{ margin: 0 }}>What you‚Äôll submit</h3>
        <div className="body" style={{ maxWidth: 860, marginTop: 10 }}>
          <div style={{ display: "grid", gap: 8, fontWeight: 900 }}>
            <div>‚Ä¢ Your dimensions + style choices</div>
            <div>‚Ä¢ Optional inspiration photos</div>
            <div>‚Ä¢ 3D render previews (multiple angles)</div>
            <div>‚Ä¢ A live-updating estimate per render</div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/ServiceArea.tsx ====

export default function ServiceArea() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>Service Area</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            Where we operate - and how travel fees work (if applicable).
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950 }}>Primary area</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850 }}>
              Add your city/region list here. Example: Serving Charlotte + surrounding areas within 25 miles.
            </div>
          </div>

          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950 }}>Extended area</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
              For larger jobs we may travel further. If a travel fee applies, it will be shown or confirmed before booking.
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/BuildPortal.tsx ====
import { useMemo, useState } from "react";
import { Link } from "react-router-dom";
import { findBuildsByNameAndPhone, findBuildsByPhoneAndCode, type BuildSubmission, normalizePhone } from "../lib/buildsStore";

function prettyDate(iso: string) {
  const d = new Date(iso);
  if (Number.isNaN(d.getTime())) return iso;
  return d.toLocaleString();
}

function statusLabel(s: string) {
  const low = String(s || "").toLowerCase();
  if (low === "complete") return "Complete";
  if (low === "in_build") return "In Build";
  if (low === "approved") return "Approved";
  if (low === "quote_sent") return "Quote Sent";
  if (low === "reviewing") return "Reviewing";
  if (low === "submitted") return "Submitted";
  return "Draft";
}

export default function BuildPortal() {
  const [phone, setPhone] = useState("");
  const [code, setCode] = useState("");
  const [searched, setSearched] = useState(false);

  const [showRetrieve, setShowRetrieve] = useState(false);
  const [retrieveName, setRetrieveName] = useState("");
  const [retrievePhone, setRetrievePhone] = useState("");

  const matches: BuildSubmission[] = useMemo(() => {
    const p = normalizePhone(phone);
    if (!p) return [];
    return findBuildsByPhoneAndCode(p, code).sort((a, b) => (b.createdAt || "").localeCompare(a.createdAt || ""));
  }, [phone, code]);

  const retrieveMatches = useMemo(() => {
    const n = String(retrieveName || "").trim();
    const p = String(retrievePhone || "").trim();
    if (!n || p.length < 7) return [];
    return findBuildsByNameAndPhone(n, p).sort((a, b) => (b.createdAt || "").localeCompare(a.createdAt || ""));
  }, [retrieveName, retrievePhone]);

  async function copyText(text: string) {
    const v = String(text || "").trim();
    if (!v) return;
    try {
      await navigator.clipboard.writeText(v);
      alert(`Copied: ${v}`);
    } catch {
      const ta = document.createElement("textarea");
      ta.value = v;
      ta.style.position = "fixed";
      ta.style.left = "-9999px";
      document.body.appendChild(ta);
      ta.focus();
      ta.select();
      try {
        document.execCommand("copy");
        alert(`Copied: ${v}`);
      } finally {
        document.body.removeChild(ta);
      }
    }
  }

  return (
    <div className="stack">
      <section className="panel card card-center" style={{ maxWidth: 900, margin: "0 auto" }}>
        <h2 className="h2" style={{ margin: 0 }}>Build Portal</h2>
        <p className="muted" style={{ fontWeight: 850, maxWidth: 720, textAlign: "center" }}>
          Enter the phone number used on your build and your Build Access Code (shown after submitting) to view builds on this device/browser.
        </p>

        <div style={{ width: "100%", maxWidth: 520, display: "grid", gap: 10 }}>
          <label style={{ display: "grid", gap: 6 }}>
            <span className="label">Phone Number</span>
            <input className="input" value={phone} onChange={(e) => setPhone(e.target.value)} placeholder="(555) 123-4567" inputMode="tel" />
          </label>

          <label style={{ display: "grid", gap: 6 }}>
            <span className="label">Access Code</span>
            <input className="input" value={code} onChange={(e) => setCode(e.target.value)} placeholder="6-digit code" inputMode="numeric" />
          </label>

          <button
            className="btn btn-primary"
            onClick={() => setSearched(true)}
            disabled={normalizePhone(phone).length < 10 || String(code).trim().length < 6}
          >
            Find My Builds
          </button>

          <div style={{ display: "grid", gap: 10, marginTop: 12 }}>
            <button type="button" className="btn btn-ghost" onClick={() => setShowRetrieve((v) => !v)} style={{ width: "fit-content" }}>
              {showRetrieve ? "Hide" : "Forgot Access Code?"}
            </button>

            {showRetrieve && (
              <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
                <div style={{ fontWeight: 950, color: "#0f172a" }}>Retrieve Access Code</div>
                <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                  Enter the same name + phone used on the build. (Works on this device/browser until Firebase is connected.)
                </div>

                <div style={{ display: "grid", gap: 10, marginTop: 12 }}>
                  <label style={{ display: "grid", gap: 6 }}>
                    <span className="label">Full Name</span>
                    <input className="input" value={retrieveName} onChange={(e) => setRetrieveName(e.target.value)} placeholder="First Last" autoComplete="name" />
                  </label>

                  <label style={{ display: "grid", gap: 6 }}>
                    <span className="label">Phone Number</span>
                    <input className="input" value={retrievePhone} onChange={(e) => setRetrievePhone(e.target.value)} placeholder="(555) 555-5555" inputMode="tel" autoComplete="tel" />
                  </label>

                  {retrieveMatches.length === 0 ? (
                    <div className="muted" style={{ fontWeight: 850 }}>No matching builds found yet.</div>
                  ) : (
                    <div style={{ display: "grid", gap: 10 }}>
                      {retrieveMatches.slice(0, 6).map((b) => (
                        <div key={String(b.id)} className="panel" style={{ padding: 12, borderRadius: 14 }}>
                          <div className="row" style={{ justifyContent: "space-between", gap: 10, flexWrap: "wrap" }}>
                            <div style={{ fontWeight: 950, color: "#0f172a" }}>
                              Build: {String(b.id).slice(-8).toUpperCase()}
                            </div>
                            <button
                              type="button"
                              className="badge"
                              onClick={() => copyText(String(b.accessCode || ""))}
                              title="Click to copy"
                              style={{ cursor: "pointer", justifyContent: "center", border: "1px solid rgba(2,6,23,0.14)" }}
                            >
                              Code: {String(b.accessCode || "‚Äî")}
                            </button>
                          </div>
                          <div className="muted" style={{ fontWeight: 850, marginTop: 6 }}>
                            Created: {prettyDate(b.createdAt)}
                          </div>
                        </div>
                      ))}
                      <div className="muted" style={{ fontWeight: 850 }}>
                        Tip: Copy the code above and use it in the main search (Phone + Access Code).
                      </div>
                    </div>
                  )}
                </div>
              </div>
            )}

            <div className="muted" style={{ fontWeight: 850, textAlign: "center" }}>
              Tip: Your Access Code appears after you submit a build‚Äîsave it. This portal works on the same device/browser until Firebase is connected.
            </div>
          </div>
        </div>
      </section>

      {searched && (
        <section className="stack" style={{ maxWidth: 1100, margin: "0 auto", width: "100%" }}>
          {matches.length === 0 ? (
            <div className="panel card card-center">
              <div className="h3" style={{ margin: 0 }}>No builds found</div>
              <div className="muted" style={{ fontWeight: 850, textAlign: "center", maxWidth: 700 }}>
                If you submitted on a different device/browser, it won‚Äôt appear here yet.
              </div>
              <Link className="btn btn-ghost" to="/builds/new">Start a Build</Link>
            </div>
          ) : (
            <div className="stack">
              <div className="row" style={{ justifyContent: "space-between", flexWrap: "wrap", gap: 10 }}>
                <div>
                  <div className="h3" style={{ margin: 0 }}>Your Builds</div>
                  <div className="muted" style={{ fontWeight: 850 }}>
                    Found {matches.length} build{matches.length === 1 ? "" : "s"} for {phone}
                  </div>
                </div>
              </div>

              <div className="stack">
                {matches.map((b) => (
                  <article key={b.id} className="panel card" style={{ display: "grid", gap: 10 }}>
                    <div className="row" style={{ justifyContent: "space-between", alignItems: "center", gap: 10, flexWrap: "wrap" }}>
                      <div style={{ display: "grid", gap: 4 }}>
                        <div style={{ fontWeight: 950, color: "#0f172a" }}>
                          Build #{String(b.id).slice(-8).toUpperCase()}
                        </div>
                        <div className="muted" style={{ fontWeight: 850 }}>
                          Created: {prettyDate(b.createdAt)} ‚Ä¢ Type: {b.project?.type || "‚Äî"}
                        </div>
                      </div>

                      <div className="row" style={{ gap: 10, alignItems: "center" }}>
                        <span className="badge" style={{ fontWeight: 950 }}>Status: {statusLabel(b.status)}</span>
                        <Link className="btn btn-primary" to={`/builds/${b.id}`}>
                          View Renders
                        </Link>
                      </div>
                    </div>

                    <div className="row" style={{ gap: 10, flexWrap: "wrap" }}>
                      <span className="badge">Versions: {b.versions?.length ?? 0}</span>
                      <span className="badge">Dims: {b.project?.dims?.lengthIn ?? "‚Äî"}√ó{b.project?.dims?.widthIn ?? "‚Äî"}√ó{b.project?.dims?.heightIn ?? "‚Äî"} in</span>
                    </div>
                  </article>
                ))}
              </div>
            </div>
          )}
        </section>
      )}
    </div>
  );
}
==== src/pages/FAQ.tsx ====

export default function FAQ() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>FAQ</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            Quick answers to common questions about pricing, scheduling, and what to expect.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          {[
            ["Do you provide quotes?", "Yes - some services are quote-based depending on scope, materials, and access."],
            ["How does scheduling work?", "Add services and notes, choose a time slot, and submit. We will confirm details."],
            ["Do I need to provide materials?", "For some woodworking projects you can, but we can also source materials."],
            ["What areas do you serve?", "See our Service Area page. We can also travel further for larger projects."],
          ].map(([q, a], idx) => (
            <div key={idx} className="panel" style={{ padding: 14, borderRadius: 14 }}>
              <div style={{ fontWeight: 950 }}>{q}</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
                {a}
              </div>
            </div>
          ))}
        </div>
      </section>
    </div>
  );
}
==== src/pages/Reviews.tsx ====

export default function Reviews() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>Reviews</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            Showcase customer feedback and trust signals. We will swap these placeholders with real reviews.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 12 }}>
          {[
            { name: "Customer A", text: "Fast, professional, and the install looks perfect." },
            { name: "Customer B", text: "Great communication and clean work area after the job." },
            { name: "Customer C", text: "Very fair pricing and the shelves turned out amazing." },
          ].map((r, idx) => (
            <div key={idx} className="panel" style={{ padding: 14, borderRadius: 14 }}>
              <div style={{ fontWeight: 950 }}>{r.name}</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
                {r.text}
              </div>
            </div>
          ))}

          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950 }}>Want to leave a review?</div>
            <div className="muted" style={{ marginTop: 8, fontWeight: 850 }}>
              We can add your Google Review / Facebook link here later.
            </div>
          </div>
        </div>
      </section>
    </div>
  );
}
==== src/pages/About.tsx ====

export default function About() {
  return (
    <div className="stack page" style={{ gap: 18 }}>
      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 22,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div className="card-center" style={{ gap: 10, textAlign: "center" }}>
          <div className="badge" style={{ width: "fit-content" }}>Roberts Ventures LLC</div>
          <h1 className="h2" style={{ margin: 0 }}>About</h1>
          <div className="muted" style={{ fontWeight: 850, maxWidth: 920 }}>
            Built on craftsmanship, clear communication, and clean results - from installs and repairs to custom woodworking.
          </div>
        </div>
      </section>

      <section
        className="panel card"
        style={{
          width: "100%",
          maxWidth: 1100,
          margin: "0 auto",
          padding: 18,
          background: "rgba(255,255,255,0.86)",
          border: "1px solid rgba(2,6,23,0.12)",
        }}
      >
        <div style={{ display: "grid", gap: 14 }}>
          <div className="row" style={{ gap: 12, flexWrap: "wrap", justifyContent: "space-between" }}>
            <div className="panel" style={{ padding: 14, borderRadius: 14, flex: "1 1 320px" }}>
              <div style={{ fontWeight: 950 }}>What we do</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
                Roberts Ventures LLC provides home services, outdoor fixes, and custom woodworking.
                We focus on professional planning, careful installs, and clean finishes.
              </div>
            </div>

            <div className="panel" style={{ padding: 14, borderRadius: 14, flex: "1 1 320px" }}>
              <div style={{ fontWeight: 950 }}>How we work</div>
              <div className="muted" style={{ marginTop: 8, fontWeight: 850, lineHeight: 1.6 }}>
                You pick services, add notes/photos, and request a time.
                We confirm details, arrive prepared, and communicate clearly before/during/after.
              </div>
            </div>
          </div>

          <div className="panel" style={{ padding: 14, borderRadius: 14 }}>
            <div style={{ fontWeight: 950 }}>Why customers choose us</div>
            <ul style={{ marginTop: 10, fontWeight: 850, lineHeight: 1.7 }}>
              <li>Upfront pricing on common services (quotes when needed)</li>
              <li>Clean work area + attention to detail</li>
              <li>Respect for your home and schedule</li>
              <li>Photo-friendly quoting to speed things up</li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  );
}
